{
  "hash": "dd4e770b39869bbe7b9dc0739f538b45",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Análisis geoestadístico del ozono y la temperatura en California durante marzo de 2024\"\nlang: es\nauthor: \n  - name: \"Luna Katerin Díaz Casallas\"\n    email: \"ldiazca@unal.edu.co\"\n  - name: \"Camilo Alejandro Raba Gómez\"\n    email: \"craba@unal.edu.co\"\ninstitute: \"Departamento de Estadística - Universidad Nacional de Colombia\"\ndate: today\nformat:\n  html:\n    toc: True\n    toc-title: \"Tabla de contenidos\"\n    toc-depth: 3  # Profundidad de los encabezados a enumerar\n    number-sections: true  # Activa la numeración de secciones\n    html-math-method: katex\n    code-fold: true\n    code-summary: \"Ver código\"\n    link-external-newwindow: true\n    css: styles.css\n    theme:\n      light: flatly\n      dark: darkly\n    include-after-body: footer.html\neditor_options:\n  chunk_output_type: console\nbibliography: referencias.bib\nnocite: '@*'\n---\n\n\n\n# Introducción\n\nLa calidad del aire es un factor clave para la salud pública, el bienestar social y la sostenibilidad ambiental, y California se destaca como uno de los estados más afectados de Estados Unidos por la contaminación atmosférica. La combinación de una alta densidad poblacional, una intensa actividad industrial y vehicular, junto con fenómenos naturales como los incendios forestales, ha hecho que varias de sus ciudades se ubiquen entre las más contaminadas del país. Al mismo tiempo, la temperatura cumple un papel fundamental en la dinámica atmosférica, ya que influye en la dispersión, concentración y formación de contaminantes, además de constituir en sí misma un aspecto crítico para comprender las condiciones ambientales regionales. Frente a este contexto, resulta necesario llevar a cabo un análisis geoespacial que considere tanto la calidad del aire como la temperatura en California, con el fin de identificar patrones espaciales, contrastes regionales y áreas críticas que permitan orientar acciones de mitigación y gestión ambiental.\n\n# Descripción\n\nLos datos objeto de este estudio provienen de la [Agencia de Protección Ambiental (EPA)](https://www.epa.gov/) de los Estados Unidos y corresponden a registros horarios obtenidos de las estaciones de monitoreo durante el mes de marzo de 2024. En partícular, se analizan las variables **Temperatura** y **Ozono (**$O_3$**)**.\n\n## Unidades\n\n-   *Temperatura:* Medido en grados celsius (C°) con una intensidad horaria.\n\n-   *Ozono:* Medido en partes por billón (ppb) con una intensidad horaria.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Librerias necesarias\nlibrary(dplyr)\nlibrary(geoR)\nlibrary(sp)\nlibrary(readxl)\nlibrary(tidyr)\nlibrary(sf)\nlibrary(ggplot2)\nlibrary(knitr)\nlibrary(plotly)\nlibrary(leaflet)\nlibrary(raster)\nlibrary(stars)\n\n#Carga de datos\nCali_Marz <- read.csv(\"AirNow_Marzo_California.csv\", colClasses = c(\"AQSID\"=\"character\"))\n\nOzone <- Cali_Marz %>% filter(Variable==\"OZONE\") \nNO2 <- Cali_Marz %>% filter(Variable==\"NO2\")\nTemp <- read.csv(\"Temperatura.csv\", colClasses = c(\"AQSID\"=\"character\"))\n\nOzone <- Ozone %>% mutate(DateTime = paste(Date, Hour, sep = \" \"))\nNO2 <- NO2 %>% mutate(DateTime = paste(Date, Hour, sep = \" \"))\nTemp <- Temp[,-1]\n\n#Para el mapa de California\nsh_mundos<-st_read(\"admin00.shp\",quiet=TRUE)\nsh_mundos <- sh_mundos %>% filter(CNTRY_NAME==\"United States\")\nsh_mundos <- sh_mundos %>% filter(ADMIN_NAME==\"California\")\n\n#Datos de las estaciones\ndata <- read.csv(\"HourlyAQObs_2024010101.dat\")\ndata <- data %>% filter(CountryCode==\"US\")\ndata <- data %>% filter(StateName==\"CA\")\n\nCRS_UTM_NY = \"+init=epsg:3310\"\n\nOzone_Matrix <- Ozone %>%\n  dplyr::select(DateTime, AQSID, Value) %>%\n  pivot_wider(names_from = AQSID, values_from = Value) \n\nTemp_Matrix <- Temp %>%\n  dplyr::select(DateTime, AQSID, Value) %>%\n  pivot_wider(names_from = AQSID, values_from = Value) \n```\n:::\n\n\n\n# Análisis geoestadístico univariado\n\n## Variable Temperatura\n\nSe tomaron los datos de Temperatura de la madrugada el primero de marzo de 2024:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nEstacionesT <- data %>% filter(AQSID %in% colnames(Temp_Matrix)[-1])\nEstacionesT <- EstacionesT[,c(1:10,13)]\n\nest_sf_T <- st_as_sf(EstacionesT, \n                      coords = c(\"Longitude\", \"Latitude\"), \n                      crs = 4326)\n\nest_sf_utm_T <- st_transform(est_sf_T, crs = 3310)\ndeci_coord_T = SpatialPoints(cbind(EstacionesT$Longitude,\n                                 EstacionesT$Latitude),\n                           proj4string = CRS(\"+proj=longlat\"))\nutm_coord_T = spTransform(deci_coord_T, CRS(\"EPSG:3310\"))\nutm_coord_df_T = as.data.frame(utm_coord_T)\nEstacionesT$x <- utm_coord_df_T$coords.x1\nEstacionesT$y <- utm_coord_df_T$coords.x2\n\ny_T <- Temp_Matrix[1,] #Tomar una fecha\ny_T <- cbind(colnames(y_T),t(y_T[1,]))\ny_T <- y_T[-1,]\ny_T <- as.data.frame(y_T)\ny_T <- na.omit(y_T)\ny_T <- inner_join(y_T, EstacionesT, by=c(\"V1\"=\"AQSID\"))\ndatosT <- y_T[,c(13,14,2)] #Datos1 es la base con coordenadas + variable\ncolnames(datosT)=c(\"Este\",\"Norte\",\"Temperatura\")\ndatosT <- datosT[-which.min(datosT$Temperatura),]\ndatosT$Temperatura <- as.numeric(datosT$Temperatura)\n\n#Para el mapa\n\ncoords_3310 <- st_coordinates(est_sf_utm_T)\nest_sf_utm_T$Este <- coords_3310[, \"X\"]\nest_sf_utm_T$Norte <- coords_3310[, \"Y\"]\n\n# 4. Crear el objeto final de datos (combinando temperatura con las coordenadas UTM)\ndatosT_sf_utm <- merge(est_sf_utm_T, y_T[, c(\"V1\", \"V2\")], by.x = \"AQSID\", by.y = \"V1\")\ndatosT_sf_utm$Temperatura <- as.numeric(datosT_sf_utm$V2)\n\ndatosT_sf_wgs84 <- merge(est_sf_T, y_T[, c(\"V1\", \"V2\")], by.x = \"AQSID\", by.y = \"V1\")\ndatosT_sf_wgs84$Temperatura <- as.numeric(datosT_sf_wgs84$V2)\n\nsh_mundos_wgs84 <- st_transform(sh_mundos, crs = 4326)\n\npal <- colorNumeric(palette = \"viridis\", domain = datosT_sf_wgs84$Temperatura)\n\nleaflet() %>%\n  addProviderTiles(providers$CartoDB.Positron) %>%\n  # Contorno de California\n  addPolygons(data = sh_mundos_wgs84, fill = FALSE, color = \"black\", weight = 2) %>%\n  # Puntos de temperatura\n  addCircleMarkers(data = datosT_sf_wgs84,\n                   fillColor = ~pal(Temperatura),\n                   fillOpacity = 0.8,\n                   color = \"black\",\n                   weight = 1,\n                   radius = 6,\n                   popup = ~paste(\"Temp:\", Temperatura, \"°C\")) %>%\n  addLegend(pal = pal, values = datosT_sf_wgs84$Temperatura, title = \"Temperatura (°C)\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-59bd34b927f04b067067\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-59bd34b927f04b067067\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.Positron\",null,null,{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addPolygons\",\"args\":[[[[{\"lng\":[-117.1223754882812,-117.1333312988281,-117.1827087402344,-117.2129135131836,-117.2123794555664,-117.2005081176758,-117.1740798950195,-117.1472244262695,-117.1156234741211,-117.1166534423828,-117.1413879394531,-117.2021560668945,-117.2288131713867,-117.2405471801758,-117.2420425415039,-117.2549896240234,-117.2684783935547,-117.26611328125,-117.2587661743164,-117.2803421020508,-117.2529220581055,-117.2490615844727,-117.25,-117.2698593139648,-117.3197326660156,-117.3294525146484,-117.3402862548828,-117.4094390869141,-117.480827331543,-117.495002746582,-117.6319427490234,-117.6725006103516,-117.7744369506836,-117.8638916015625,-117.8840179443359,-117.9108276367188,-117.9361114501953,-117.9550018310547,-117.9736175537109,-117.9949951171875,-118.0270843505859,-118.0452728271484,-118.0830688476562,-118.1081848144531,-118.1347427368164,-118.2222213745117,-118.2671279907227,-118.272087097168,-118.2977752685547,-118.3180694580078,-118.400016784668,-118.4174652099609,-118.3986206054688,-118.3861846923828,-118.4211044311523,-118.432502746582,-118.4544525146484,-118.4711227416992,-118.508903503418,-118.5300064086914,-118.554443359375,-118.6549987792969,-118.6977691650391,-118.7525024414062,-118.7811126708984,-118.8364028930664,-118.9361114501953,-118.9614028930664,-118.9811096191406,-119.1291732788086,-119.1743011474609,-119.2196502685547,-119.2558441162109,-119.3124694824219,-119.4161071777344,-119.446662902832,-119.5416717529297,-119.5772171020508,-119.5997314453125,-119.6247100830078,-119.7986068725586,-120.0037460327148,-120.1308288574219,-120.245002746582,-120.3550033569336,-120.4241561889648,-120.4490280151367,-120.4819412231445,-120.4953460693359,-120.5583267211914,-120.5831909179688,-120.605827331543,-120.6259613037109,-120.6283264160156,-120.623893737793,-120.6033248901367,-120.5941696166992,-120.5913772583008,-120.5980606079102,-120.6247100830078,-120.6137466430664,-120.6000671386719,-120.6181945800781,-120.6805572509766,-120.7186813354492,-120.7385330200195,-120.8313903808594,-120.8567962646484,-120.8697280883789,-120.8681945800781,-120.8591613769531,-120.8411102294922,-120.9199981689453,-120.9770812988281,-120.9994506835938,-121.0477752685547,-121.1666564941406,-121.2687530517578,-121.29638671875,-121.3215408325195,-121.3680572509766,-121.4349899291992,-121.4418029785156,-121.4609680175781,-121.4720840454102,-121.6654205322266,-121.7580642700195,-121.7961044311523,-121.8676300048828,-121.8641662597656,-121.8734664916992,-121.8847427368164,-121.8976440429688,-121.9216613769531,-121.9432525634766,-121.8997955322266,-121.8656158447266,-121.8450012207031,-121.8255615234375,-121.8091506958008,-121.7993087768555,-121.7747192382812,-121.7639007568359,-121.7991638183594,-121.8511123657227,-121.8791656494141,-121.9135971069336,-121.9783325195312,-122.0202865600586,-122.0415191650391,-122.0709762573242,-122.1472320556641,-122.1795806884766,-122.379020690918,-122.3883438110352,-122.393684387207,-122.3844528198242,-122.3731918334961,-122.378044128418,-122.4259719848633,-122.4433288574219,-122.4806137084961,-122.4902801513672,-122.4958267211914,-122.4994430541992,-122.4905471801758,-122.4843063354492,-122.4481201171875,-122.379638671875,-122.359992980957,-122.3513870239258,-122.35693359375,-122.3673553466797,-122.3577728271484,-122.0643005371094,-122.0231857299805,-122.0058364868164,-122.0297164916992,-122.0808334350586,-122.1259689331055,-122.1308288574219,-122.1384811401367,-122.1572265625,-122.1747131347656,-122.2427673339844,-122.2999877929688,-122.3934097290039,-122.352783203125,-122.2252731323242,-122.1633224487305,-122.1277313232422,-122.0158386230469,-121.9894409179688,-121.9155578613281,-121.8572235107422,-121.8337554931641,-121.6848526000977,-121.6541976928711,-121.6434936523438,-121.5911102294922,-121.498046875,-121.4272155761719,-121.4705505371094,-121.5531921386719,-121.5850067138672,-121.6622161865234,-121.6852188110352,-121.7229156494141,-121.8186798095703,-121.9052734375,-121.977783203125,-122.0186233520508,-122.0500030517578,-122.109733581543,-122.2641830444336,-122.2920837402344,-122.311393737793,-122.3652801513672,-122.3908386230469,-122.4783248901367,-122.479866027832,-122.4433288574219,-122.4201354980469,-122.456672668457,-122.505485534668,-122.6566619873047,-122.7822875976562,-122.8169631958008,-122.8966674804688,-122.9283294677734,-122.9563903808594,-122.9269409179688,-122.8399963378906,-122.8030471801758,-122.8077697753906,-122.83056640625,-122.9586181640625,-123.1072235107422,-123.1290283203125,-123.1716613769531,-123.2372131347656,-123.2666625976562,-123.3130645751953,-123.3530578613281,-123.4475021362305,-123.5361175537109,-123.620002746582,-123.7015228271484,-123.7072601318359,-123.6745834350586,-123.6669387817383,-123.6861038208008,-123.712646484375,-123.7541809082031,-123.7957000732422,-123.7956924438477,-123.774169921875,-123.7630615234375,-123.7368698120117,-123.7723617553711,-123.8202819824219,-123.8674926757812,-123.9311065673828,-124.0623550415039,-124.0927734375,-124.1525726318359,-124.2022171020508,-124.297233581543,-124.331184387207,-124.3240356445312,-124.3233413696289,-124.3543090820312,-124.3758239746094,-124.3523559570312,-124.3319473266602,-124.2750091552734,-124.2529144287109,-124.2294464111328,-124.1994323730469,-124.14306640625,-124.0988922119141,-124.0993041992188,-124.1125030517578,-124.1222229003906,-124.0909729003906,-124.061393737793,-124.0458374023438,-124.0399932861328,-124.0467987060547,-124.063606262207,-124.1186065673828,-124.1813812255859,-124.2155609130859,-124.1973571777344,-124.1902770996094,-124.1752777099609,-124.1841583251953,-124.1858520507812,-123.9505615234375,-123.883903503418,-123.5336227416992,-123.4836120605469,-123.4169464111328,-123.366943359375,-123.3169631958008,-123.2669525146484,-123.2169494628906,-123.1669464111328,-123.116943359375,-123.0669631958008,-122.8999862670898,-122.8177795410156,-122.7508392333984,-122.6341705322266,-122.600830078125,-122.5175018310547,-122.2172164916992,-122.1505584716797,-122.1172180175781,-122.0005569458008,-121.9669494628906,-121.8836212158203,-121.8002777099609,-121.7169494628906,-121.6677703857422,-121.5341567993164,-121.4841613769531,-121.4341583251953,-121.3008270263672,-121.1838836669922,-121.133903503418,-121.0672302246094,-120.9169464111328,-120.8510971069336,-120.7677764892578,-120.6841583251953,-120.3208236694336,-120.0341567993164,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.001106262207,-119.8197326660156,-119.5155563354492,-119.0130615234375,-118.8799896240234,-118.3752670288086,-118.2108306884766,-117.8919525146484,-117.7452697753906,-117.5747222900391,-117.4211120605469,-117.2677764892578,-117.1069488525391,-116.946662902832,-116.8027801513672,-116.6513977050781,-116.4924926757812,-116.1999969482422,-116.0269470214844,-115.8622131347656,-115.7527923583984,-115.5580368041992,-115.2555694580078,-115.1241607666016,-114.9933319091797,-114.6563873291016,-114.6219329833984,-114.6197128295898,-114.5563812255859,-114.4933319091797,-114.4561233520508,-114.4188766479492,-114.3781890869141,-114.3695068359375,-114.3358306884766,-114.2726440429688,-114.230827331543,-114.2005615234375,-114.1700668334961,-114.1516723632812,-114.1344528198242,-114.1170120239258,-114.2226409912109,-114.3141632080078,-114.3576278686523,-114.3834762573242,-114.4070892333984,-114.4207611083984,-114.4554061889648,-114.4755630493164,-114.5127868652344,-114.5233306884766,-114.510009765625,-114.4941635131836,-114.48388671875,-114.5275039672852,-114.6404876708984,-114.7255630493164,-114.7260971069336,-114.7038879394531,-114.6836090087891,-114.6681900024414,-114.6752777099609,-114.6965179443359,-114.6970748901367,-114.6788787841797,-114.6626281738281,-114.6029205322266,-114.5701370239258,-114.5452728271484,-114.5153503417969,-114.4644470214844,-114.4587478637695,-114.5352096557617,-114.5541687011719,-114.5844497680664,-114.6125030517578,-114.6526412963867,-114.6955490112305,-114.7190933227539,-114.7297973632812,-114.8713455200195,-115.0258941650391,-115.2024993896484,-115.404167175293,-115.6055603027344,-115.9077835083008,-116.2426376342773,-116.5081481933594,-116.7130584716797,-116.9141693115234,-117.0952911376953,-117.1223754882812],\"lat\":[32.53533172607422,32.56582641601562,32.65929412841797,32.68302917480469,32.69705581665039,32.69759368896484,32.6749382019043,32.61860275268555,32.62131118774414,32.64249420166016,32.68061447143555,32.72769546508789,32.71561431884766,32.68464279174805,32.66253280639648,32.65713882446289,32.68842315673828,32.70860290527344,32.77041625976562,32.82921600341797,32.86082458496094,32.87129211425781,32.88971710205078,32.97707366943359,33.10527038574219,33.12443542480469,33.14166259765625,33.24415588378906,33.32749176025391,33.34221649169922,33.44276428222656,33.47054290771484,33.53943634033203,33.59568405151367,33.60055160522461,33.60665893554688,33.62054443359375,33.63276672363281,33.64554595947266,33.66249084472656,33.69401931762695,33.70943450927734,33.73971557617188,33.75693893432617,33.76666259765625,33.78416442871094,33.75777435302734,33.72332000732422,33.71610260009766,33.7208251953125,33.74985504150391,33.78179931640625,33.80804443359375,33.84096527099609,33.92124557495117,33.93915557861328,33.96776580810547,33.98777008056641,34.03110504150391,34.04791259765625,34.05568695068359,34.0494384765625,34.04610443115234,34.03971862792969,34.03318786621094,34.03054809570312,34.05554962158203,34.06221008300781,34.06749725341797,34.11388397216797,34.1361083984375,34.16492080688477,34.22346115112305,34.28351593017578,34.35749816894531,34.37332153320312,34.41415405273438,34.42054748535156,34.42360687255859,34.42471313476562,34.42638397216797,34.4679069519043,34.47873687744141,34.47360229492188,34.46582794189453,34.45610046386719,34.4556884765625,34.50957489013672,34.53047561645508,34.56193542480469,34.56221389770508,34.55860137939453,34.58443832397461,34.62360382080078,34.64110565185547,34.66943740844727,34.69026947021484,34.71082305908203,34.8608283996582,34.89499664306641,35.01860427856445,35.10005950927734,35.13943862915039,35.17110443115234,35.18054580688477,35.16464233398438,35.20999145507812,35.22880935668945,35.25722122192383,35.27999496459961,35.3074951171875,35.35527038574219,35.44887542724609,35.46596145629883,35.47915649414062,35.52499008178711,35.64916229248047,35.70013046264648,35.76610565185547,35.79402542114258,35.82916259765625,35.8942985534668,35.92804718017578,35.97943496704102,35.99777221679688,36.18304443359375,36.22943496704102,36.24110412597656,36.31533813476562,36.3429069519043,36.39388656616211,36.43387603759766,36.46735382080078,36.51805114746094,36.59457397460938,36.64124298095703,36.61985397338867,36.61513137817383,36.6270751953125,36.64846420288086,36.66790771484375,36.75916290283203,36.81249237060547,36.88401794433594,36.95068740844727,36.97248840332031,36.9803352355957,36.96915435791016,36.95485305786133,36.95415878295898,36.96235275268555,36.99582672119141,37.01763153076172,37.19998931884766,37.22026824951172,37.25186538696289,37.28971862792969,37.32915878295898,37.37443542480469,37.48429489135742,37.50436782836914,37.5122184753418,37.52999114990234,37.56610107421875,37.58998870849609,37.75222015380859,37.78992462158203,37.81005859375,37.81381225585938,37.78693771362305,37.73165893554688,37.68762969970703,37.65443420410156,37.61582565307617,37.45929718017578,37.45790863037109,37.47137451171875,37.47943115234375,37.51027297973633,37.6027717590332,37.6322135925293,37.66221618652344,37.69470977783203,37.71471405029297,37.76666259765625,37.82638549804688,37.95915985107422,37.99082946777344,38.06415939331055,38.04743576049805,38.03526306152344,38.06610107421875,38.06554412841797,38.05416107177734,38.04305267333984,38.03666305541992,38.01811599731445,38.04861831665039,38.0789909362793,38.10464859008789,38.04888153076172,38.01290893554688,38.05499267578125,38.11041259765625,38.11568832397461,38.09658813476562,38.06646728515625,38.04746627807617,38.08115386962891,38.06610107421875,38.09721374511719,38.14811325073242,38.10877990722656,38.06137847900391,38.10999298095703,38.12693405151367,38.1361083984375,38.15554809570312,38.14749145507812,38.11957168579102,37.9366569519043,37.90693664550781,37.88318634033203,37.83346557617188,37.83103942871094,37.91054534912109,38.00131607055664,38.02027130126953,38.05443572998047,38.05360412597656,38.05804443359375,38.16249084472656,38.10777282714844,38.08193969726562,38.09498977661133,38.12748718261719,38.28527069091797,38.46277236938477,38.47290802001953,38.49193572998047,38.52276611328125,38.54083251953125,38.57388305664062,38.62443542480469,38.7340202331543,38.79610443115234,38.86082458496094,38.93041229248047,38.97109985351562,39.00458145141602,39.02554702758789,39.1219367980957,39.17804718017578,39.25943756103516,39.35332489013672,39.38582611083984,39.49652099609375,39.51915740966797,39.55499267578125,39.70971298217773,39.79166412353516,39.86915588378906,39.94971466064453,40.09165954589844,40.11631011962891,40.14790725708008,40.17416381835938,40.23804473876953,40.27245712280273,40.31193542480469,40.33624267578125,40.41526794433594,40.44769668579102,40.5322151184082,40.5816650390625,40.6947135925293,40.724365234375,40.74638366699219,40.74554443359375,40.81193542480469,40.99193572998047,41.03853607177734,41.0574951171875,41.15749359130859,41.24985504150391,41.34415435791016,41.39443969726562,41.42777252197266,41.46318435668945,41.51527404785156,41.68305206298828,41.75416564941406,41.81999206542969,41.84804916381836,41.86943817138672,41.94971466064453,41.99415588378906,41.99946594238281,42,42,42,42,42,42,42,42,42,42,42,42,42,42,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,42,42,42,42,42,42,42,42,42,42,42,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99964904785156,42,41.99943542480469,40.43305206298828,39.84943389892578,39.56610107421875,39.44971466064453,39.33332824707031,39.00721740722656,38.88276672363281,38.67276763916016,38.32054901123047,38.22609710693359,37.86527252197266,37.74638366699219,37.51416015625,37.40665435791016,37.28110504150391,37.16721343994141,37.05304718017578,36.93276977539062,36.81221008300781,36.70360565185547,36.58860015869141,36.46749114990234,36.24276733398438,36.10888671875,35.98081970214844,35.89499664306641,35.74221801757812,35.50277709960938,35.39804840087891,35.29332733154297,35.02165985107422,34.99214935302734,34.88193511962891,34.81666564941406,34.75833129882812,34.69860076904297,34.63166046142578,34.55082702636719,34.52193832397461,34.46415710449219,34.41582489013672,34.38999176025391,34.37276458740234,34.35867691040039,34.34276580810547,34.32332611083984,34.28804779052734,34.19624328613281,34.14665985107422,34.12568283081055,34.11429977416992,34.09207153320312,34.03013229370117,34.00124359130859,33.98721313476562,33.96152114868164,33.94415283203125,33.86888122558594,33.78305053710938,33.72193145751953,33.55929946899414,33.42033767700195,33.39916229248047,33.31888580322266,33.28054809570312,33.24638366699219,33.20901870727539,33.15541076660156,33.115478515625,33.08943557739258,33.06137847900391,33.04374313354492,33.02971267700195,33.03360748291016,33.03471755981445,33.02554702758789,32.97165679931641,32.86235046386719,32.73200607299805,32.72499084472656,32.72568511962891,32.73110198974609,32.74179840087891,32.74096298217773,32.71845626831055,32.71771240234375,32.70785140991211,32.69698715209961,32.68444061279297,32.66971588134766,32.65471649169922,32.63194274902344,32.60577011108398,32.58499908447266,32.568603515625,32.55221557617188,32.53665924072266,32.53533172607422]}],[{\"lng\":[-119.8680572509766,-119.6983337402344,-119.5936126708984,-119.5631866455078,-119.5527801513672,-119.5155639648438,-119.5329895019531,-119.5899963378906,-119.7133331298828,-119.7727813720703,-119.788330078125,-119.8369369506836,-119.8709716796875,-119.9177703857422,-119.9142303466797,-119.8680572509766],\"lat\":[34.08415985107422,34.04527282714844,34.05387878417969,34.06583023071289,34.06582641601562,34.04457855224609,34.01513290405273,33.99721527099609,33.97082138061523,33.96720886230469,33.96720886230469,33.97415924072266,33.99151992797852,34.06526947021484,34.0826301574707,34.08415985107422]}],[{\"lng\":[-120,-119.9694442749023,-119.9663925170898,-120.0365295410156,-120.1074981689453,-120.1216583251953,-120.1452789306641,-120.164436340332,-120.172233581543,-120.1922073364258,-120.2260971069336,-120.1847229003906,-120.135009765625,-120.0519409179688,-120.0352783203125,-120],\"lat\":[33.98963165283203,33.99235534667969,33.96249008178711,33.91915893554688,33.90554809570312,33.90804290771484,33.91666412353516,33.92777252197266,33.93471527099609,33.95943450927734,34.006103515625,34.01583099365234,34.02610015869141,34.03610992431641,34.02388000488281,33.98963165283203]}],[{\"lng\":[-118.5166625976562,-118.4452667236328,-118.4033432006836,-118.3497314453125,-118.297233581543,-118.2931213378906,-118.3037414550781,-118.4496459960938,-118.5899276733398,-118.5811233520508,-118.5418014526367,-118.5288925170898,-118.5166625976562],\"lat\":[33.47776794433594,33.44276428222656,33.42804718017578,33.39833068847656,33.34609985351562,33.32867431640625,33.30985260009766,33.32860565185547,33.48381042480469,33.49082946777344,33.48943710327148,33.48624420166016,33.47776794433594]}],[{\"lng\":[-118.5302886962891,-118.5261077880859,-118.5202789306641,-118.504997253418,-118.4822235107422,-118.413330078125,-118.3691635131836,-118.3694534301758,-118.4086074829102,-118.477783203125,-118.4869384765625,-118.4938812255859,-118.5338897705078,-118.570556640625,-118.5948638916016,-118.5938949584961,-118.5544281005859,-118.5302886962891],\"lat\":[32.99332427978516,32.98360443115234,32.97499084472656,32.959716796875,32.93804168701172,32.88555145263672,32.85471343994141,32.83277130126953,32.81707763671875,32.85277557373047,32.85888671875,32.86666107177734,32.92721557617188,32.98416137695312,33.03305053710938,33.04458236694336,33.04305267333984,32.99332427978516]}]]],null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":\"black\",\"weight\":2,\"opacity\":0.5,\"fill\":false,\"fillColor\":\"black\",\"fillOpacity\":0.2,\"smoothFactor\":1,\"noClip\":false},null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addCircleMarkers\",\"args\":[[38.342606,38.690757,39.76168,39.32756,38.20185,39.18919,38.94498,36.7056,36.78538,36.8414,36.6324,36.71088,36.5975,36.819199,39.53387,37.360701,36.3261,36.3663,36.3619,36.5432,36.4581,36.5092,36.4878,36.5975,37.3667,37.0056,35.345607,35.0544,35.356615,35.438035,34.8416,35.3313,35.23918,36.102219,36.3144,34.1439,34.051097,34.066429,34.1992,33.9014,34.010283,34.13263,33.859662,34.3833,36.8669,36.9533,37.713299,39.150478,39.145733,39.43734,37.645718,37.962069,38.0697,36.48187,36.209286,36.694261,39.234402,39.3386,33.830586,33.819305,33.925062,38.74643,39.9395,40.301899,39.8134,33.7472,33.920758,33.583099,33.572019,33.852605,33.999449,33.996387,33.676535,38.613804,38.56844,38.302591,38.683304,38.593328,36.843425,36.485001,34.894054,34.243132,34.068114,34.0309,34.510955,35.774455,34.100132,34.416506,34.059626,34.0714,34.106678,37.8027,37.6825,35.614668,34.42775,34.7256,34.5414,34.402802,34.4897,34.637798,34.445301,36.98332,37.06315,40.5403,37.642165,37.4883,39.13868,36.489399,36.0319,34.21017,34.40428,34.44806,34.27632,34.25239,38.53455,36.280596,36.607215,35.04944,33.793713,34.181977,39.39861,36.841488,32.72519],[-120.764426,-120.072682,-121.84047,-121.66881,-120.680277,-121.99887,-119.97061,-119.7414,-119.77321,-119.8744,-120.3822,-119.77743,-119.5036,-119.7164,-122.190834,-118.330835,-117.9551,-117.8976,-118.0108,-117.9418,-117.8519,-116.8481,-117.871,-118.04,-118.4167,-118.2936,-118.851825,-119.4039,-119.062613,-119.016787,-118.8647,-119,-118.78863,-119.566002,-119.6436,-117.8508,-118.456386,-118.226755,-118.5331,-118.205,-118.068484,-118.127142,-118.200707,-118.5283,-120.01,-120.0341,-119.7061,-123.206528,-123.202995,-123.78766,-118.966515,-119.120278,-118.9477,-121.73333,-121.126371,-121.623271,-121.055603,-120.170303,-117.938509,-117.918759,-117.952586,-121.26498,-120.9443,-121.235001,-120.4707,-115.8201,-116.858419,-117.072197,-116.063823,-116.540965,-117.415831,-117.4925,-117.331027,-121.368007,-121.49311,-121.420838,-121.164457,-121.503728,-121.3621,-121.155602,-117.024756,-117.272275,-117.525796,-117.617403,-117.32555,-117.372109,-117.491982,-117.285602,-117.147347,-116.3906,-117.274063,-121.2208,-121.4406,-120.656912,-119.69091,-120.4278,-119.7906,-119.457497,-120.0458,-120.456703,-119.827797,-121.98822,-122.083092,-121.5764,-120.994212,-120.8358,-121.61884,-118.826897,-119.055,-118.87051,-118.80998,-119.2313,-118.68369,-119.14318,-121.7734,-118.011661,-118.05473,-118.18893,-118.171019,-118.363036,-123.35872,-121.533444,-116.36441],6,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":\"black\",\"weight\":1,\"opacity\":0.5,\"fill\":true,\"fillColor\":[\"#98D83E\",\"#30B57B\",\"#9DD93B\",\"#92D742\",\"#9CD93B\",\"#9CD93B\",\"#3FBC73\",\"#CAE11F\",\"#D0E11C\",\"#CAE11F\",\"#C0DF25\",\"#D9E319\",\"#C6E021\",\"#C8E020\",\"#A3DA37\",\"#B8DE29\",\"#BCDF26\",\"#BCDF26\",\"#B8DE29\",\"#C5E021\",\"#BADE28\",\"#FDE725\",\"#BADE28\",\"#C5E021\",\"#ACDC31\",\"#440154\",\"#CAE11F\",\"#C7E020\",\"#D8E219\",\"#CAE11F\",\"#86D549\",\"#D5E21A\",\"#D0E11C\",\"#C2DF23\",\"#C9E020\",\"#B1DD2E\",\"#B1DD2E\",\"#B4DE2C\",\"#B2DD2D\",\"#B4DE2C\",\"#BBDE27\",\"#ACDC31\",\"#BEDF26\",\"#A5DB36\",\"#C6E021\",\"#C9E020\",\"#5DC863\",\"#8AD547\",\"#8ED645\",\"#8CD646\",\"#3EBC73\",\"#57C666\",\"#5BC864\",\"#ABDC31\",\"#ADDC30\",\"#BEDF26\",\"#66CB5D\",\"#3ABA76\",\"#B9DE29\",\"#C3DF22\",\"#C2DF23\",\"#9CD93C\",\"#69CD5B\",\"#54C568\",\"#53C568\",\"#BADE28\",\"#A6DB35\",\"#B1DD2E\",\"#FDE725\",\"#DBE319\",\"#C0DF25\",\"#BEDF26\",\"#B2DD2D\",\"#A4DB36\",\"#A6DB35\",\"#ACDC31\",\"#99D83D\",\"#A3DA37\",\"#A8DB34\",\"#9DD93B\",\"#BCDF26\",\"#65CB5E\",\"#BBDE27\",\"#C0DF25\",\"#94D741\",\"#E0E318\",\"#BADE28\",\"#8FD744\",\"#B3DD2C\",\"#89D548\",\"#BEDF26\",\"#B7DE2A\",\"#C1DF24\",\"#99D83D\",\"#B2DD2D\",\"#A6DB35\",\"#9AD93D\",\"#A1DA38\",\"#95D840\",\"#BDDF26\",\"#B8DE29\",\"#96D83F\",\"#2AB07F\",\"#65CB5E\",\"#B6DE2A\",\"#AFDD2F\",\"#95D840\",\"#AFDD2F\",\"#C9E020\",\"#9ED93A\",\"#A6DB35\",\"#A1DA38\",\"#9DD93B\",\"#B3DD2C\",\"#9CD93C\",\"#B3DD2C\",\"#C5E021\",\"#A1DA38\",\"#BADE28\",\"#AFDD2F\",\"#66CB5D\",\"#B2DD2D\",\"#76D153\"],\"fillOpacity\":0.8},null,null,[\"Temp: 12.9 °C\",\"Temp: -1.8 °C\",\"Temp: 13.5 °C\",\"Temp: 12.2 °C\",\"Temp: 13.4 °C\",\"Temp: 13.4 °C\",\"Temp: 1 °C\",\"Temp: 18.5 °C\",\"Temp: 19.1 °C\",\"Temp: 18.6 °C\",\"Temp: 17.4 °C\",\"Temp: 20.2 °C\",\"Temp: 18.1 °C\",\"Temp: 18.3 °C\",\"Temp: 14.2 °C\",\"Temp: 16.5 °C\",\"Temp: 17 °C\",\"Temp: 17 °C\",\"Temp: 16.5 °C\",\"Temp: 18 °C\",\"Temp: 16.7 °C\",\"Temp: 24.5 °C\",\"Temp: 16.8 °C\",\"Temp: 18 °C\",\"Temp: 15.2 °C\",\"Temp: -51.3 °C\",\"Temp: 18.6 °C\",\"Temp: 18.2 °C\",\"Temp: 20 °C\",\"Temp: 18.5 °C\",\"Temp: 10.8 °C\",\"Temp: 19.7 °C\",\"Temp: 19.2 °C\",\"Temp: 17.6 °C\",\"Temp: 18.4 °C\",\"Temp: 15.7 °C\",\"Temp: 15.8 °C\",\"Temp: 16.1 °C\",\"Temp: 15.9 °C\",\"Temp: 16.1 °C\",\"Temp: 16.9 °C\",\"Temp: 15.2 °C\",\"Temp: 17.2 °C\",\"Temp: 14.4 °C\",\"Temp: 18.1 °C\",\"Temp: 18.4 °C\",\"Temp: 5.6 °C\",\"Temp: 11.2 °C\",\"Temp: 11.7 °C\",\"Temp: 11.5 °C\",\"Temp: 0.9 °C\",\"Temp: 4.7 °C\",\"Temp: 5.3 °C\",\"Temp: 15.1 °C\",\"Temp: 15.3 °C\",\"Temp: 17.2 °C\",\"Temp: 6.8 °C\",\"Temp: 0.1 °C\",\"Temp: 16.6 °C\",\"Temp: 17.8 °C\",\"Temp: 17.6 °C\",\"Temp: 13.3 °C\",\"Temp: 7.2 °C\",\"Temp: 4.3 °C\",\"Temp: 4.2 °C\",\"Temp: 16.7 °C\",\"Temp: 14.5 °C\",\"Temp: 15.8 °C\",\"Temp: 24.5 °C\",\"Temp: 20.4 °C\",\"Temp: 17.4 °C\",\"Temp: 17.2 °C\",\"Temp: 15.9 °C\",\"Temp: 14.3 °C\",\"Temp: 14.5 °C\",\"Temp: 15.2 °C\",\"Temp: 13 °C\",\"Temp: 14.2 °C\",\"Temp: 14.7 °C\",\"Temp: 13.5 °C\",\"Temp: 17 °C\",\"Temp: 6.7 °C\",\"Temp: 16.9 °C\",\"Temp: 17.4 °C\",\"Temp: 12.4 °C\",\"Temp: 21 °C\",\"Temp: 16.8 °C\",\"Temp: 11.9 °C\",\"Temp: 16 °C\",\"Temp: 11.1 °C\",\"Temp: 17.2 °C\",\"Temp: 16.4 °C\",\"Temp: 17.5 °C\",\"Temp: 13 °C\",\"Temp: 15.9 °C\",\"Temp: 14.5 °C\",\"Temp: 13.1 °C\",\"Temp: 14 °C\",\"Temp: 12.6 °C\",\"Temp: 17.1 °C\",\"Temp: 16.5 °C\",\"Temp: 12.7 °C\",\"Temp: -3.2 °C\",\"Temp: 6.7 °C\",\"Temp: 16.3 °C\",\"Temp: 15.5 °C\",\"Temp: 12.6 °C\",\"Temp: 15.5 °C\",\"Temp: 18.4 °C\",\"Temp: 13.6 °C\",\"Temp: 14.5 °C\",\"Temp: 14 °C\",\"Temp: 13.5 °C\",\"Temp: 16 °C\",\"Temp: 13.3 °C\",\"Temp: 16 °C\",\"Temp: 18 °C\",\"Temp: 13.9 °C\",\"Temp: 16.7 °C\",\"Temp: 15.5 °C\",\"Temp: 6.8 °C\",\"Temp: 15.9 °C\",\"Temp: 8.9 °C\"],null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#440154 , #46075B 1.71503957783641%, #463480 14.9076517150396%, #375B8D 28.1002638522427%, #297B8E 41.2928759894459%, #1E9B8A 54.4854881266491%, #39BA76 67.6781002638522%, #7FD34E 80.8707124010554%, #D8E219 94.0633245382586%, #FDE725 \"],\"labels\":[\"-50\",\"-40\",\"-30\",\"-20\",\"-10\",\"0\",\"10\",\"20\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":0.5,\"position\":\"topright\",\"type\":\"numeric\",\"title\":\"Temperatura (°C)\",\"extra\":{\"p_1\":0.01715039577836408,\"p_n\":0.9406332453825857},\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[32.53533172607422,42],\"lng\":[-124.3758239746094,-114.1170120239258]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n```{.r .cell-code}\ntemp <- as.geodata(datosT) \nsummary(temp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNumber of data points: 122 \n\nCoordinates summary\n         Este     Norte\nmin -325700.9 -580919.1\nmax  387269.8  281577.0\n\nDistance summary\n         min          max \n    609.2419 1000171.2033 \n\nData summary\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-3.20000 13.15000 15.80000 14.42869 17.20000 24.50000 \n```\n\n\n:::\n:::\n\n\n\n::: {.panel-tabset}\n\n### Gráficos de dispersión\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(1,2))\n\nplot(Temperatura~Este, data = datosT, ylab = \"Temperatura\", xlab=\"Este\")\nplot(Temperatura~Norte, data = datosT, ylab = \"Temperatura\", xlab=\"Norte\")\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n### GeoR\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(temp, qt.col = c(\"purple\",\n                    \"pink\",\n                    \"green\",\n                    \"yellow\"),\n     scatter3d=T)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\nEn el gráfico se observa un agrupamiento en las coordenadas Norte con respecto a los datos, que puede llegar a corregirse con algún polinomio. Se probará con diferentes modelos a ver si se puede llegar a disminuir el efecto espacial.\n\n### Ajuste del modelo\n\nEl modelo que mejor atrapa el efecto de la media es:\n\n$$\nTemperatura = \\beta_0 + \\beta_1 \\times Norte + \\beta_2 \\times Norte^2\n$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfitT <- lm(Temperatura~Norte+I(Norte^2), data = datosT) \nsummary(fitT)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Temperatura ~ Norte + I(Norte^2), data = datosT)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-18.3668  -1.1159   0.9092   2.1923   9.2782 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.326e+01  5.352e-01  24.766  < 2e-16 ***\nNorte       -2.229e-05  3.230e-06  -6.901 2.68e-10 ***\nI(Norte^2)  -3.754e-11  8.551e-12  -4.390 2.47e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.049 on 119 degrees of freedom\nMultiple R-squared:  0.3199,\tAdjusted R-squared:  0.3084 \nF-statistic: 27.98 on 2 and 119 DF,  p-value: 1.094e-10\n```\n\n\n:::\n:::\n\n\n\nObservamos el comportamiento de sus residuales podemos notar que el modelo ayudo a reducir el efecto espacial.\n\n::: {.panel-tabset}\n\n#### Gráficos de dispersión\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndatosT$Residuos <- fitT$residuals\npar(mfrow=c(1,2))\nplot(Residuos~Este, data = datosT, xlab=\"Este\", ylab=\"Residuos\")\nplot(Residuos~Norte, data = datosT, xlab=\"Norte\", ylab=\"Residuos\")\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n#### GeoR\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(temp, qt.col = c(\"purple\",\n                    \"pink\",\n                    \"green\",\n                    \"yellow\"),\n     scatter3d=T, trend=~Norte+I(Norte^2))\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\n### Estimación empírica del semivariograma\n\np¿Presentamos la estimación del semivariograma obtenida mediante la función variog para la variable temperatura. Se comparan los resultados al calcularlo directamente sobre los datos originales (sin remover la tendencia) y al utilizar los residuales de un modelo de regresión, con el objetivo de analizar cómo influye la presencia de tendencia en la estructura espacial.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvg_T <- variog(temp, estimator.type = \"modulus\", pairs.min=50) #Sin tendencia espacial\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nvariog: computing omnidirectional variogram\n```\n\n\n:::\n\n```{.r .cell-code}\nvg1_T <- variog(temp, trend = ~Norte+I(Norte^2),\n                estimator.type = \"modulus\", pairs.min=50)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nvariog: computing omnidirectional variogram\n```\n\n\n:::\n:::\n\n\n\n::: {.panel-tabset}\n\n#### Con tendencia\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(vg_T,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Sin remover tendencia\",\n     col.main = 4, cex.main =1.3)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n#### Removiendo tendencia\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(vg1_T,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Removiendo tendencia\",\n     col.main = 4, cex.main =1.3)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\nCuando no se remueve la tendencia, la semivarianza alcanza valores más altos y presenta una forma aparentemente más regular, aunque dicha regularidad está influenciada por la tendencia global de los datos. En cambio, al eliminar la tendencia, los valores de semivarianza disminuyen y el patrón pierde suavidad, pero el variograma refleja con mayor fidelidad la verdadera dependencia espacial.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(vg1_T$u, vg1_T$n, type=\"b\",\n     xlab=\"distance\", ylab=\"n pairs\",\n     main=\"Número de pares por bin\")\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\nEn este caso, el último punto corresponde a menos de 25 pares de observaciones, por lo que su interpretación resulta menos confiable. \n\n### Estimación del Modelo Teórico de Semivariograma\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndist_matrix_T <- as.matrix(dist(temp$coords))\n\n#1. Funciones de correlación, covarianza y semivarianza: ----\n\n#1.1 Modelo exponencial ----\n\nrho_exp <- function(h, phi){\n  exp(-(h/phi)) #Correlacion espacial\n}\n\ncov_exp <- function(sigma, h, phi){\n  sigma*rho_exp(h, phi) #Covarianza espacial\n}\n\nsv_exp <- function(nugget, sigma, h, phi){\n  nugget + sigma - cov_exp(sigma, h, phi) #Semivarianza espacial\n} \n\n#1.2 Modelo Gaussianio ----\n\nrho_gauss <- function(h, phi){\n  exp(-(h/phi)^2)\n}\n\ncov_gauss <- function(sigma, h, phi){\n  sigma*rho_gauss(h, phi) #Covarianza espacial\n}\n\nsv_gauss <- function(nugget, sigma, h, phi){\n  nugget + sigma - cov_gauss(sigma, h, phi) #Semivarianza espacial\n}\n#1.3 Modelo Gneting ----\n\ncov_gneiting <- function(h){\n  s <- 0.301187465825\n  ifelse(0<= s*h &  s*h <= 1,\n  (1 + 8*s*h + 25*(s*h)^2 + 32*(s*h)^3) * (1-s*h)^8,\n  0)\n}\n\nsv_gneiting <- function(nugget, sigma, h){\n  nugget + sigma - cov_gneiting(h) #Semivarianza espacial\n}\n\n#1.4 Modelo Spherical ----\n\nrho_spherical <- function(h, phi){\n  ifelse(h<phi,\n         1 - 1.5*(h/phi) + 0.5*(h/phi)^3,\n         0)\n}\n\ncov_spherical <- function(sigma, h, phi){\n  sigma*rho_spherical(h, phi) #Covarianza espacial\n}\n\nsv_spherical <- function(nugget, sigma, h, phi){\n  nugget + sigma - cov_spherical(sigma, h, phi) #Semivarianza espacial\n}\n\n#1.5 Modelo Matern ----\n\nrho_matern <- function(h, phi, kappa){\n  (1/(2*gamma(kappa))) * (h/phi)^kappa * besselK((h/phi), kappa)\n}\n\ncov_matern <- function(sigma, h, phi, kappa){\n  sigma*rho_matern(h, phi, kappa) #Covarianza espacial\n}\n\nsv_matern <- function(nugget, sigma, h, phi, kappa){\n  nugget + sigma - cov_matern(sigma, h, phi, kappa) #Semivarianza espacial\n}\n\n#2. Función para estimar por WLS----\n\nMSE_ponderados <- function(par, h, gamma,kappa=NA,w, model, n, pesos){\n  nugget <- par[1]\n  sigma <- par[2]\n  phi <- par[3]\n  \n  gamma_hat <- switch(model,\n                      \"exponencial\" = sv_exp(nugget, sigma, h, phi),\n                      \"gaussian\"    = sv_gauss(nugget, sigma, h, phi),\n                      \"gneiting\"    = sv_gneiting(nugget, sigma, h, phi),\n                      \"spherical\"   = sv_spherical(nugget, sigma, h, phi),\n                      \"matern\"      = sv_matern(nugget, sigma, h, phi, kappa)\n  )\n  \n  w <- switch(pesos,\n              \"Cressie\" = 1/(2*(2*gamma_hat)^2/n),\n              \"n\" = 1/n,\n              \"h/n\" = 1/(h/n),\n              \"I\" = 1)\n  \n  sum(w*(gamma - gamma_hat)^2)\n}\n\nest_sev_WLS <- function(par, kappa = NA, model, h, gamma, n){\n  sigma_0 <- par[1]\n  phi_0 <- par[2]\n  nugget_0 <- par[3]\n  kappa_0 <- kappa\n  \n  # Selección de función\n  sv <- switch(model,\n               \"exponencial\" = sv_exp,\n               \"gaussian\"    = sv_gauss,\n               \"spherical\"   = sv_spherical,\n               \"gneiting\"    = sv_gneiting,\n               \"matern\"      = sv_matern\n  )\n  \n  args_sv <- names(formals(sv))\n  \n  args_list <- list(\n    nugget = nugget_0,\n    sigma  = sigma_0,\n    h      = h,\n    phi    = phi_0,\n    kappa  = kappa_0\n  )\n  \n  args_list <- args_list[names(args_list) %in% args_sv]\n  \n  sv_ini <- do.call(sv, args_list)\n  \n  formula_sv <- switch(model,\n                       \"gneiting\" = gamma ~ sv(nugget, sigma, h),\n                       \"matern\" = gamma ~ sv(nugget, sigma, h, phi, kappa),\n                       gamma ~ sv(nugget, sigma, h, phi)\n  )\n  \n  start_list <- switch(model,\n                       \"gneting\" = list(nugget = nugget_0, sigma = sigma_0),\n                       \"matern\" = list(nugget = nugget_0, sigma = sigma_0, phi = phi_0, kappa = kappa_0),\n                       list(nugget = nugget_0, sigma = sigma_0, phi = phi_0)\n  )\n    \n    #1. Ponderación de Bessel\n    \n    WW <- (2*(2*sv_ini)^2/n)\n    \n    Bessel <- nls(formula = formula_sv,\n                  start = start_list,\n                  weights = 1/WW,\n                  control = nls.control(maxiter = 500, warnOnly = TRUE))\n    \n    ini_Bessel<-coef(Bessel)\n    \n    #1.1 Optim Bessel\n    \n    optim_bessel <- optim(\n      par = coef(Bessel),\n      fn = MSE_ponderados,\n      h = h,\n      gamma = gamma,\n      pesos = \"Cressie\",\n      model = model,\n      n = n,\n      method = \"L-BFGS-B\",\n      lower = c(0, 0, 0)\n    )\n    \n    par_optim_Bess <- optim_bessel$par[c(\"nugget\", \"sigma\", \"phi\")]\n    \n    #2. Ponderación 1/n\n    \n    W1 <- n\n    \n    n_pond <- nls(formula = formula_sv,\n                  start = start_list,\n                  weights = 1/W1,\n                  control = nls.control(maxiter = 500, warnOnly = TRUE))\n    \n    ini_n<-coef(n_pond)\n    \n    #2.1 Optimización 1/n\n    \n    optim_n <- optim(\n      par = coef(n_pond),\n      fn = MSE_ponderados,\n      h = h,\n      gamma = gamma,\n      pesos = \"n\",\n      n = n,\n      model = model,\n      method = \"L-BFGS-B\",\n      lower = c(0, 0, 0)\n    )    \n    \n    par_optim_n <- optim_n$par[c(\"nugget\", \"sigma\", \"phi\")]\n    \n    \n    #3. Ponderación h/n\n    \n    W2 <- h/n\n    \n    h_n_pond <- nls(formula = formula_sv,\n                    start = start_list,\n                    weights = 1/W2,\n                    control = nls.control(maxiter = 500, warnOnly = TRUE))\n    \n    ini_h_n<-coef(h_n_pond)\n    \n    optim_h_n <- optim(\n      par = coef(h_n_pond),\n      fn = MSE_ponderados,\n      h = h,\n      gamma = gamma,\n      pesos = \"h/n\",\n      model = model,\n      n = n,\n      method = \"L-BFGS-B\",\n      lower = c(0, 0, 0)\n    )    \n    \n    par_optim_h_n <- optim_h_n$par[c(\"nugget\", \"sigma\", \"phi\")]\n    \n\nres <- list(Bessel = list(Iniciales = ini_Bessel,\n                           Optimizados = par_optim_Bess),\n            `1/n` = list(Iniciales = ini_n,\n                          Optimizados = par_optim_n),\n            `h/n` = list(Iniciales = ini_h_n,\n                          Optimizados = par_optim_h_n))    \nreturn(res)\n}\n\nMSE_sv <- function(gamma_hat, par, kappa, model, h){\n  sigma_0 <- par[[2]]\n  phi_0 <- par[[3]]\n  nugget_0 <- par[[1]]\n  kappa_0 <- kappa\n  \n  sv <- switch(model,\n               \"exponencial\" = sv_exp,\n               \"gaussian\"    = sv_gauss,\n               \"spherical\"   = sv_spherical,\n               \"gneiting\"    = sv_gneiting,\n               \"matern\"      = sv_matern\n  )\n  \n  args_sv <- names(formals(sv))\n  \n  args_list <- list(\n    nugget = nugget_0,\n    sigma  = sigma_0,\n    h      = h,\n    phi    = phi_0,\n    kappa  = kappa_0\n  )\n  \n  args_list <- args_list[names(args_list) %in% args_sv]\n  \n  sv_est <- do.call(sv, args_list)\n  \n  return(mean((sv_est-gamma_hat)^2))\n}\n\n#3. Función para etimar por máxima verosimilitud\n\nloglik <- function(par, kappa=NA, z, dist_matrix, model){\n  sigma_0 <- par[1]\n  phi_0 <- par[2]\n  nugget_0 <- par[3]\n  kappa_0 <- kappa\n  \n  cov <- switch(model,\n               \"exponencial\" = cov_exp,\n               \"gaussian\"    = cov_gauss,\n               \"spherical\"   = cov_spherical,\n               \"gneiting\"    = cov_gneiting,\n               \"matern\"      = cov_matern\n  )\n  \n  args_cov <- names(formals(cov))\n  \n  args_list <- list(\n    sigma  = sigma_0,\n    nugget = nugget_0,\n    h      = dist_matrix,\n    phi    = phi_0,\n    kappa  = kappa_0\n  )\n  \n  args_list <- args_list[names(args_list) %in% args_cov]\n  \n  Sigma <- do.call(cov, args_list) \n  diag(Sigma) = diag(Sigma) + nugget_0\n  \n  # Descomposición de Cholesky (más estable que solve o det)\n  inv_Sigma <- solve(Sigma)\n  det <- log(det(Sigma))\n  \n  # Log-verosimilitud del modelo Gaussiano\n  z <- z \n  n <- length(z)\n  ll <- -0.5 * (n * log(2 * pi) + det + crossprod(z, inv_Sigma %*% z))  # Log-verosimilitud (negativa porque optim minimiza)\n  return(-ll)\n}\n```\n:::\n\n\n\nLos modelos obtenidos ajustanto por EyeFit, son:\n\n```text\n\ncov.model sigmasq      phi tausq kappa kappa2 practicalRange\n1 exponential   10.74 109166.3  2.07    NA     NA       327033.0\n2    gaussian   10.00  80000.0  2.07    NA     NA       138465.5\n3   spherical   10.00 157832.8  2.07    NA     NA       157832.8\n\n```\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvariog_T <- data.frame(h = vg1_T$u, gamma_hat = vg1_T$v,\n                       n = vg1_T$n)\n\nrange_sv_T <- seq(1,max(variog_T$h), by=1000)\n\n# Modelo exponencial ----\n\nsigma_0_eT <- 10.74\nphi_0_eT <- 109166.3\nnugget_0_eT <- 2.07\n\npar_eT <- c(sigma_0_eT, phi_0_eT, nugget_0_eT)\n\nres_e_T <- est_sev_WLS(par=par_eT, kappa = NA,\n                       model=\"exponencial\",\n                       h=variog_T$h,\n                       gamma = variog_T$gamma_hat,\n                       n = variog_T$n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in nls(formula = formula_sv, start = start_list, weights = 1/W2, :\ngradiente singular\n```\n\n\n:::\n\n```{.r .cell-code}\nMLE_eT <- optim(fn = loglik,\n             par = par_eT,\n             kappa=NA,\n             z = datosT$Residuos, \n             dist_matrix=dist_matrix_T,\n             model = \"exponencial\",\n             method = \"L-BFGS-B\",\n             lower = c(0, 0, 0))\n\nestsv_exp_Bess_T <- do.call(sv_exp, c(as.list(res_e_T$Bessel$Optimizados), list(h = range_sv_T)))\nestsv_exp_n_T <- do.call(sv_exp, c(as.list(res_e_T$`1/n`$Optimizados), list(h = range_sv_T)))\nestsv_exp_h_n_T <- do.call(sv_exp, c(as.list(res_e_T$`h/n`$Optimizados), list(h = range_sv_T)))\nestsv_exp_MLE_T <- do.call(sv_exp, c(list(nugget = MLE_eT$par[3], phi = MLE_eT$par[2] , sigma = MLE_eT$par[1],h = range_sv_T)))\n\n# Modelo Gaussiano ----\n\nsigma_0_gT <- 10.00    \nphi_0_gT <- 80000.0\nnugget_0_gT <- 2.07\n\npar_gT <- c(sigma_0_gT, phi_0_gT, nugget_0_gT)\n\nres_g_T <- est_sev_WLS(par=par_gT, kappa = NA,\n                       model=\"gaussian\",\n                       h=variog_T$h,\n                       gamma = variog_T$gamma_hat,\n                       n = variog_T$n)\n\nestsv_g_Bess_T <- do.call(sv_gauss, c(as.list(res_g_T$Bessel$Optimizados), list(h = range_sv_T)))\nestsv_g_n_T <- do.call(sv_gauss, c(as.list(res_g_T$`1/n`$Optimizados), list(h = range_sv_T)))\nestsv_g_h_n_T <- do.call(sv_gauss, c(as.list(res_g_T$`h/n`$Optimizados), list(h = range_sv_T)))\n\n# Modelo esférico\n\nsigma_0_esT <- 10.00   \nphi_0_esT <- 157832.8\nnugget_0_esT <- 2.07\n\npar_esT <- c(sigma_0_esT, phi_0_esT, nugget_0_esT)\n\nres_es_T <- est_sev_WLS(par=par_esT, kappa = NA,\n                       model=\"spherical\",\n                       h=variog_T$h,\n                       gamma = variog_T$gamma_hat,\n                       n = variog_T$n)\n\nMLE_esT <- optim(fn = loglik,\n             par = par_esT,\n             kappa=NA,\n             z = datosT$Residuos, \n             dist_matrix=dist_matrix_T,\n             model = \"spherical\",\n             method = \"L-BFGS-B\",\n             lower = c(0, 0, 0))\n\n\nestsv_es_Bess_T <- do.call(sv_spherical, c(as.list(res_es_T$Bessel$Optimizados), list(h = range_sv_T)))\nestsv_es_n_T <- do.call(sv_spherical, c(as.list(res_es_T$`1/n`$Optimizados), list(h = range_sv_T)))\nestsv_es_h_n_T <- do.call(sv_spherical, c(as.list(res_es_T$`h/n`$Optimizados), list(h = range_sv_T)))\nestsv_es_MLE_T <- do.call(sv_spherical, c(list(nugget = MLE_esT$par[3], phi = MLE_esT$par[2] , sigma = MLE_esT$par[1],h = range_sv_T)))\n```\n:::\n\n\n\n::: {.panel-tabset}\n\n#### Exponencial\n\n::: {.panel-tabset}\n\n##### Óptim\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(vg1_T,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Estimación teórica del modelo de semivariograma \\n (optim)\",\n     col.main = \"#36648B\", cex.main =1.3)\nlines(range_sv_T, estsv_exp_Bess_T, col=\"#FF4040\", lwd=1.5)\nlines(range_sv_T, estsv_exp_n_T, col=\"#4169E1\", lwd=1.5)\nlines(range_sv_T, estsv_exp_h_n_T, col=\"#008B00\", lwd=1.5)\nlines(range_sv_T, estsv_exp_MLE_T, col=\"#FFA500\", lwd=1.5)\nlegend(\"topleft\",\n       c(\"Cressie\", \"1/n\", \"n/h\", \"MLE\"),#, \"REML\"),\n       lwd = 1,\n       lty = 3,\n       col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       box.col = 9,\n       text.col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       cex=1,\n       seg.len = .5)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\nresumen_exp_T <- cbind(\n  c(\"Cressie\", \"$$1/n$$\", \"$$n/h$$\", \"MLE\"),\n  rbind(\n    t(res_e_T$Bessel$Optimizados),\n    t(res_e_T$`1/n`$Optimizados),\n    t(res_e_T$`h/n`$Optimizados),\n    MLE_eT$par[c(3,1,2)]\n  ),\n  MSE = c(\n    MSE_sv(variog_T$gamma_hat, res_e_T$Bessel$Optimizados, NA, model = \"exponencial\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, res_e_T$`1/n`$Optimizados, NA, model = \"exponencial\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, res_e_T$`h/n`$Optimizados, NA, model = \"exponencial\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, list(nugget = MLE_eT$par[3], phi = MLE_eT$par[2] , sigma = MLE_eT$par[1]), NA, model = \"exponencial\", variog_T$h)\n  )\n)\n\nresumen_exp_T <- as.data.frame(resumen_exp_T)\nresumen_exp_T[ , -1] <- lapply(resumen_exp_T[ , -1], function(x) round(as.numeric(x), 3))\n\nkable(resumen_exp_T, digits = 3,\n      col.names = c(\"Método\", \"Nugget\", \"Sigma\", \"Phi\", \"MSE\"),\n      escape = F, row.names = F)\n```\n\n::: {.cell-output-display}\n\n\n|Método  | Nugget|  Sigma|       Phi|          MSE|\n|:-------|------:|------:|---------:|------------:|\n|Cressie |      0| 12.944|  98216.23| 3.591000e+00|\n|$$1/n$$ |      0| 11.178|  74809.84| 3.867000e+00|\n|$$n/h$$ |      0| 12.797|  98765.53| 3.465000e+00|\n|MLE     |      0| 31.706| 109166.30| 1.191489e+10|\n\n\n:::\n:::\n\n\n\n##### GeoR\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nini1_exp_T <- c(sigma_0_eT, phi_0_eT)\nfitvar1_exp_T <- variofit(vg1_T,\n                    cov.model = \"exponential\",\n                    ini1_exp_T,\n                    fix.nugget = F,\n                    nugget = nugget_0_eT,\n                    wei = \"equal\")\n\nfitvar2_exp_T <- variofit(vg1_T,\n                    cov.model = \"exponential\",\n                    ini1_exp_T,\n                    fix.nugget = F,\n                    nugget = nugget_0_eT,\n                    wei = \"npairs\")\n\nfitvar3_exp_T <- variofit(vg1_T,\n                    cov.model = \"exponential\",\n                    ini1_exp_T,\n                    fix.nugget =F,\n                    nugget = nugget_0_eT,\n                    wei = \"cressie\")\n\nfitvar4_exp_T <- likfit(temp,\n                  coords = temp$coords,\n                  data = temp$data,\n                  trend = ~ poly(Norte, 2, raw = FALSE),\n                  ini.cov.pars = ini1_exp_T,\n                  fix.nugget = F,\n                  nugget = nugget_0_eT,\n                  cov.model = \"exponential\",\n                  lik.method = \"ML\")\n\n\nplot(vg1_T,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Estimación teórica del modelo de semivariograma \\n (GeoR, gstat)\",\n     col.main = \"#36648B\", cex.main =1.3)\nlines(fitvar1_exp_T, col=\"#FF4040\", lwd=1.5)\nlines(fitvar2_exp_T, col=\"#4169E1\", lwd=1.5)\nlines(fitvar3_exp_T, col=\"#008B00\", lwd=1.5)\nlines(fitvar4_exp_T, col=\"#FFA500\", lwd=1.5)\nlegend(\"topleft\",\n       c(\"MCO\", \"1/n\", \"Cressie\", \"MLE\"),#, \"REML\"),\n       lwd = 1,\n       lty = 3,\n       col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       box.col = 9,\n       text.col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       cex=1,\n       seg.len = .5)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar1Texp <- c(fitvar1_exp_T$nugget, fitvar1_exp_T$cov.pars[1], fitvar1_exp_T$cov.pars[2])\npar2Texp <- c(fitvar2_exp_T$nugget, fitvar2_exp_T$cov.pars[1], fitvar2_exp_T$cov.pars[2])\npar3Texp <- c(fitvar3_exp_T$nugget, fitvar3_exp_T$cov.pars[1], fitvar3_exp_T$cov.pars[2])\npar4Texp <- c(fitvar4_exp_T$nugget, fitvar4_exp_T$cov.pars[1], fitvar4_exp_T$cov.pars[2])\n\nresumen_exp_T2 <- cbind(\n  c(\"MCO\", \"$$1/n$$\", \"$$Cressie$$\",\"MLE\"),\n  rbind(\n    par1Texp,\n    par2Texp,\n    par3Texp,\n    par4Texp\n  ),\n  MSE = c(\n    MSE_sv(variog_T$gamma_hat, par1Texp, NA, model = \"exponencial\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par2Texp, NA, model = \"exponencial\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par3Texp, NA, model = \"exponencial\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par4Texp, NA, model = \"exponencial\", variog_T$h)\n  )\n)\n\nresumen_exp_T2 <- as.data.frame(resumen_exp_T2)\nresumen_exp_T2[ , -1] <- lapply(resumen_exp_T2[ , -1], function(x) round(as.numeric(x), 3))\nkable(resumen_exp_T2, digits = 3,\n      col.names = c(\"Método\", \"Nugget\", \"Sigma\", \"Phi\", \"MSE\"),\n      escape = F, row.names = F)\n```\n\n::: {.cell-output-display}\n\n\n|Método      | Nugget|  Sigma|       Phi|     MSE|\n|:-----------|------:|------:|---------:|-------:|\n|MCO         |      0| 12.141|  82253.55|   3.184|\n|$$1/n$$     |      0| 12.423|  83939.23|   3.243|\n|$$Cressie$$ |      0| 13.298| 109166.30|   4.009|\n|MLE         |      0| 23.536|  75307.76| 117.550|\n\n\n:::\n:::\n\n\n\n:::\n\n#### Gaussiano\n\n::: {.panel-tabset}\n\n##### Óptim\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(vg1_T,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Estimación teórica del modelo de semivariograma \\n (optim)\",\n     col.main = \"#36648B\", cex.main =1.3)\nlines(range_sv_T, estsv_g_Bess_T, col=\"#FF4040\", lwd=1.5)\nlines(range_sv_T, estsv_g_n_T, col=\"#4169E1\", lwd=1.5)\nlines(range_sv_T, estsv_g_h_n_T, col=\"#008B00\", lwd=1.5)\nlegend(\"topleft\",\n       c(\"Cressie\", \"1/n\", \"n/h\"),#, \"REML\"),\n       lwd = 1,\n       lty = 3,\n       col = c(\"#FF4040\", \"#4169E1\", \"#008B00\"),\n       box.col = 9,\n       text.col = c(\"#FF4040\", \"#4169E1\", \"#008B00\"),\n       cex=1,\n       seg.len = .5)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n```{.r .cell-code}\nresumen_g_T <- cbind(\n  c(\"Cressie\", \"$$1/n$$\", \"$$n/h$$\"),\n  rbind(\n    t(res_g_T$Bessel$Optimizados),\n    t(res_g_T$`1/n`$Optimizados),\n    t(res_g_T$`h/n`$Optimizados)\n  ),\n  MSE = c(\n    MSE_sv(variog_T$gamma_hat, res_g_T$Bessel$Optimizados, NA, model = \"gaussian\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, res_g_T$`1/n`$Optimizados, NA, model = \"gaussian\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, res_g_T$`h/n`$Optimizados, NA, model = \"gaussian\", variog_T$h)\n  )\n)\n\nresumen_g_T <- as.data.frame(resumen_g_T)\nresumen_g_T[ , -1] <- lapply(resumen_g_T[ , -1], function(x) round(as.numeric(x), 3))\n\nkable(resumen_g_T, digits = 3,\n      col.names = c(\"Método\", \"Nugget\", \"Sigma\", \"Phi\", \"MSE\"),\n      escape = F)\n```\n\n::: {.cell-output-display}\n\n\n|Método  | Nugget|  Sigma|      Phi|   MSE|\n|:-------|------:|------:|--------:|-----:|\n|Cressie |      0| 12.053| 74520.03| 2.809|\n|$$1/n$$ |      0| 11.126| 69274.92| 3.233|\n|$$n/h$$ |      0| 11.620| 72540.07| 2.825|\n\n\n:::\n:::\n\n\n\n##### GeoR\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nini1_g_T <- c(sigma_0_gT, phi_0_gT)\nfitvar1_g_T <- variofit(vg1_T,\n                    cov.model = \"gaussian\",\n                    ini1_g_T,\n                    fix.nugget = F,\n                    nugget = nugget_0_gT,\n                    wei = \"equal\")\n\nfitvar2_g_T <- variofit(vg1_T,\n                    cov.model = \"gaussian\",\n                    ini1_g_T,\n                    fix.nugget = F,\n                    nugget = nugget_0_gT,\n                    wei = \"npairs\")\n\nfitvar3_g_T <- variofit(vg1_T,\n                    cov.model = \"gaussian\",\n                    ini1_g_T,\n                    fix.nugget = F,\n                    nugget = nugget_0_gT,\n                    wei = \"cressie\")\n\nfitvar4_g_T <- likfit(temp,\n                  coords = temp$coords,\n                  data = temp$data,\n                  trend = ~ poly(Norte, 2, raw = FALSE),\n                  ini.cov.pars = ini1_g_T,\n                  fix.nugget = F,\n                  nugget = nugget_0_gT,\n                  cov.model = \"gaussian\",\n                  lik.method = \"ML\")\n\n\nplot(vg1_T,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Estimación teórica del modelo de semivariograma \\n (GeoR, gstat)\",\n     col.main = \"#36648B\", cex.main =1.3)\nlines(fitvar1_g_T, col=\"#FF4040\", lwd=1.5)\nlines(fitvar2_g_T, col=\"#4169E1\", lwd=1.5)\nlines(fitvar3_g_T, col=\"#008B00\", lwd=1.5)\nlines(fitvar4_g_T, col=\"#FFA500\", lwd=1.5)\nlegend(\"topleft\",\n       c(\"MCO\", \"1/n\", \"Cressie\", \"MLE\"),#, \"REML\"),\n       lwd = 1,\n       lty = 3,\n       col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       box.col = 9,\n       text.col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       cex=1,\n       seg.len = .5)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar1Tg <- c(fitvar1_g_T$nugget, fitvar1_g_T$cov.pars[1], fitvar1_g_T$cov.pars[2])\npar2Tg <- c(fitvar2_g_T$nugget, fitvar2_g_T$cov.pars[1], fitvar2_g_T$cov.pars[2])\npar3Tg <- c(fitvar3_g_T$nugget, fitvar3_g_T$cov.pars[1], fitvar3_g_T$cov.pars[2])\npar4Tg <- c(fitvar4_g_T$nugget, fitvar4_g_T$cov.pars[1], fitvar4_g_T$cov.pars[2])\n\nresumen_g_T2 <- cbind(\n  c(\"MCO\", \"$$1/n$$\", \"$$Cressie$$\",\"MLE\"),\n  rbind(\n    par1Tg,\n    par2Tg,\n    par3Tg,\n    par4Tg\n  ),\n  MSE = c(\n    MSE_sv(variog_T$gamma_hat, par1Tg, NA, model = \"gaussian\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par2Tg, NA, model = \"gaussian\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par3Tg, NA, model = \"gaussian\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par4Tg, NA, model = \"gaussian\", variog_T$h)\n  )\n)\n\nresumen_g_T2 <- as.data.frame(resumen_g_T2)\nresumen_g_T2[ , -1] <- lapply(resumen_g_T2[ , -1], function(x) round(as.numeric(x), 3))\n\nkable(resumen_g_T2, digits = 3,\n      col.names = c(\"Método\", \"Nugget\", \"Sigma\", \"Phi\", \"MSE\"),\n      escape = F, row.names = F)\n```\n\n::: {.cell-output-display}\n\n\n|Método      | Nugget|  Sigma|      Phi|     MSE|\n|:-----------|------:|------:|--------:|-------:|\n|MCO         |  0.000| 11.862| 74341.86|   2.776|\n|$$1/n$$     |  0.000| 11.883| 74575.03|   2.777|\n|$$Cressie$$ |  0.349| 11.781| 80000.00|   2.835|\n|MLE         |  3.589| 21.264| 80000.00| 155.000|\n\n\n:::\n:::\n\n\n\n:::\n\n#### Esférico\n\n::: {.panel-tabset}\n\n##### Óptim\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(vg1_T,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Estimación teórica del modelo de semivariograma \\n (optim)\",\n     col.main = \"#36648B\", cex.main =1.3)\nlines(range_sv_T, estsv_es_Bess_T, col=\"#FF4040\", lwd=1.5)\nlines(range_sv_T, estsv_es_n_T, col=\"#4169E1\", lwd=1.5)\nlines(range_sv_T, estsv_es_h_n_T, col=\"#008B00\", lwd=1.5)\nlines(range_sv_T, estsv_es_MLE_T, col=\"#FFA500\", lwd=1.5)\nlegend(\"topleft\",\n       c(\"Cressie\", \"1/n\", \"n/h\", \"MLE\"),#, \"REML\"),\n       lwd = 1,\n       lty = 3,\n       col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       box.col = 9,\n       text.col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       cex=1,\n       seg.len = .5)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n\n```{.r .cell-code}\nresumen_es_T <- cbind(\n  c(\"Cressie\", \"$$1/n$$\", \"$$n/h$$\",\"MLE\"),\n  rbind(\n    t(res_es_T$Bessel$Optimizados),\n    t(res_es_T$`1/n`$Optimizados),\n    t(res_es_T$`h/n`$Optimizados),\n    MLE_esT$par[c(3,1,2)]\n  ),\n  MSE = c(\n    MSE_sv(variog_T$gamma_hat, res_es_T$Bessel$Optimizados, NA, model = \"spherical\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, res_es_T$`1/n`$Optimizados, NA, model = \"spherical\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, res_es_T$`h/n`$Optimizados, NA, model = \"spherical\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, list(nugget = MLE_esT$par[3], phi = MLE_esT$par[2] , sigma = MLE_esT$par[1]), NA, model = \"spherical\", variog_T$h)\n  )\n)\n\nresumen_es_T <- as.data.frame(resumen_es_T)\nresumen_es_T[ , -1] <- lapply(resumen_es_T[ , -1], function(x) round(as.numeric(x), 3))\n\nkable(resumen_es_T, digits = 3,\n      col.names = c(\"Método\", \"Nugget\", \"Sigma\", \"Phi\", \"MSE\"),\n      escape = F)\n```\n\n::: {.cell-output-display}\n\n\n|Método  | Nugget|  Sigma|      Phi|          MSE|\n|:-------|------:|------:|--------:|------------:|\n|Cressie |      0| 12.165| 191573.0| 3.044000e+00|\n|$$1/n$$ |      0| 11.128| 165974.6| 3.417000e+00|\n|$$n/h$$ |      0| 11.692| 175441.3| 2.976000e+00|\n|MLE     |      0| 27.958| 157832.8| 2.490774e+10|\n\n\n:::\n:::\n\n\n\n##### GeoR\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nini1_es_T <- c(sigma_0_esT, phi_0_esT)\nfitvar1_es_T <- variofit(vg1_T,\n                    cov.model = \"spherical\",\n                    ini1_es_T,\n                    fix.nugget = F,\n                    nugget = nugget_0_esT,\n                    wei = \"equal\")\n\nfitvar2_es_T <- variofit(vg1_T,\n                    cov.model = \"spherical\",\n                    ini1_es_T,\n                    fix.nugget = F,\n                    nugget = nugget_0_esT,\n                    wei = \"npairs\")\n\nfitvar3_es_T <- variofit(vg1_T,\n                    cov.model = \"spherical\",\n                    ini1_es_T,\n                    fix.nugget = F,\n                    nugget = nugget_0_esT,\n                    wei = \"cressie\")\n\nfitvar4_es_T <- likfit(temp,\n                  coords = temp$coords,\n                  data = temp$data,\n                  trend = ~ poly(Norte, 2, raw = FALSE),\n                  ini.cov.pars = ini1_es_T,\n                  fix.nugget = F,\n                  nugget = nugget_0_esT,\n                  cov.model = \"spherical\",\n                  lik.method = \"ML\")\n\n\nplot(vg1_T,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Estimación teórica del modelo de semivariograma \\n (GeoR, gstat)\",\n     col.main = \"#36648B\", cex.main =1.3)\nlines(fitvar1_es_T, col=\"#FF4040\", lwd=1.5)\nlines(fitvar2_es_T, col=\"#4169E1\", lwd=1.5)\nlines(fitvar3_es_T, col=\"#008B00\", lwd=1.5)\nlines(fitvar4_es_T, col=\"#FFA500\", lwd=1.5)\nlegend(\"topleft\",\n       c(\"MCO\", \"1/n\", \"Cressie\", \"MLE\"),#, \"REML\"),\n       lwd = 1,\n       lty = 3,\n       col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       box.col = 9,\n       text.col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       cex=1,\n       seg.len = .5)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar1Tes <- c(fitvar1_es_T$nugget, fitvar1_es_T$cov.pars[1], fitvar1_es_T$cov.pars[2])\npar2Tes <- c(fitvar2_es_T$nugget, fitvar2_es_T$cov.pars[1], fitvar2_es_T$cov.pars[2])\npar3Tes <- c(fitvar3_es_T$nugget, fitvar3_es_T$cov.pars[1], fitvar3_es_T$cov.pars[2])\npar4Tes <- c(fitvar4_es_T$nugget, fitvar4_es_T$cov.pars[1], fitvar4_es_T$cov.pars[2])\n\nresumen_es_T2 <- cbind(\n  c(\"MCO\", \"$$1/n$$\", \"$$Cressie$$\",\"MLE\"),\n  rbind(\n    par1Tes,\n    par2Tes,\n    par3Tes,\n    par4Tes\n  ),\n  MSE = c(\n    MSE_sv(variog_T$gamma_hat, par1Tes, NA, model = \"spherical\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par2Tes, NA, model = \"spherical\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par3Tes, NA, model = \"spherical\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par4Tes, NA, model = \"spherical\", variog_T$h)\n  )\n)\n\nresumen_es_T2 <- as.data.frame(resumen_es_T2)\nresumen_es_T2[ , -1] <- lapply(resumen_es_T2[ , -1], function(x) round(as.numeric(x), 3))\n\nkable(resumen_es_T2, digits = 3,\n      col.names = c(\"Método\", \"Nugget\", \"Sigma\", \"Phi\", \"MSE\"),\n      escape = F, row.names = F)\n```\n\n::: {.cell-output-display}\n\n\n|Método      | Nugget|  Sigma|      Phi|     MSE|\n|:-----------|------:|------:|--------:|-------:|\n|MCO         |      0| 11.878| 171733.0|   2.938|\n|$$1/n$$     |      0| 11.898| 166427.4|   2.944|\n|$$Cressie$$ |      0| 11.860| 157832.8|   2.977|\n|MLE         |      0| 25.641| 144147.3| 179.276|\n\n\n:::\n:::\n\n\n\n:::\n\n:::\n\nEl modelo con menor MSE es el modelo Gausiano. Sin embargo, dada la inestabilidad numérica que se observa al realizar la predicción se opta por usar el modelo esférico obtenido por mínimos cuadrados ponderados usando la ponderación $1/n$, que es el segundo mejor en términos del MSE.\n\n### Kriging\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbest_model_T <- gstat::vgm(psill = res_es_T$`1/n`$Optimizados[2],\n                           model = \"Sph\",\n                           range = res_es_T$`1/n`$Optimizados[3],\n                           nugget = res_es_T$`1/n`$Optimizados[1]\n)\n\nsh_mundos_utm <- st_transform(sh_mundos, crs = CRS(\"EPSG:3310\"))\n\nnew <- sp::spsample(as(sh_mundos_utm, \"Spatial\"), n = 10000, type = \"regular\")\n\nproj4string(new) <- CRS(\"EPSG:3310\")\ncoordinates(new) ~ Este + Norte\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ncoordinates(new) ~ Este + Norte\n```\n\n\n:::\n\n```{.r .cell-code}\ncolnames(new@coords) <- c(\"Este\", \"Norte\")\n\ncoordinates(datosT) <- ~Este + Norte\nproj4string(datosT) <- CRS(\"EPSG:3310\")\n\ng_obj<-gstat::gstat(id=\"Temperatura\",\n             formula = Temperatura ~ Norte + I(Norte^2),\n             model = best_model_T,\n             data = datosT)\nsh_mundos_sp_utm <- as(sh_mundos_utm, \"Spatial\")\n\npredic <- predict(g_obj, newdata = new)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[using universal kriging]\n```\n\n\n:::\n\n```{.r .cell-code}\ngridded(predic) <- TRUE\n\npredic_raster_utm <- raster(predic, layer = \"Temperatura.pred\")\n\n# 2. Asegurarse de que el CRS del ráster se asigne correctamente (EPSG:3310)\ncrs(predic_raster_utm) <- \"+init=epsg:3310\"\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in CPL_crs_from_input(x): GDAL Message 1: +init=epsg:XXXX syntax is\ndeprecated. It might return a CRS with a non-EPSG compliant axis order.\n```\n\n\n:::\n\n```{.r .cell-code}\nsh_mundos_utm_simple <- st_union(sh_mundos_utm)\nsh_mundos_sp_utm_simple <- as(sh_mundos_utm_simple, \"Spatial\")\n\npredic_raster_wgs84 <- raster::projectRaster(\n    raster::mask(\n        predic_raster_utm, \n        sh_mundos_sp_utm_simple\n    ),\n    crs = \"+init=epsg:4326\", \n    method = \"bilinear\"\n)\n\nbins <- c(-5,0, 5, 8, 10, 12, 15, 20, 25)\n\npred_range <- c(minValue(predic_raster_wgs84), maxValue(predic_raster_wgs84))\npal_pred <- colorBin(\n  palette = \"viridis\", # La paleta de colores\n  domain = pred_range,\n  bins = bins,\n  na.color = \"transparent\"\n)\n\nmapa_kriging_leaflet <- leaflet() %>%\n  addProviderTiles(providers$CartoDB.Positron) %>%\n  \n  # Añadir la capa ráster de Predicción Kriging\n  addRasterImage(\n    predic_raster_wgs84, # Usamos el objeto raster reproyectado\n    colors = pal_pred, \n    opacity = 0.7,\n    group = \"Predicción Kriging\"\n  ) %>%\n  \n  # Añadir el contorno de California\n  addPolygons(\n    data = sh_mundos_wgs84,\n    color = \"black\",\n    weight = 2,\n    fill = FALSE,\n    group = \"Contorno\"\n  ) %>%\n    addCircleMarkers(data = datosT_sf_wgs84,\n                   fillColor = ~pal(Temperatura),\n                   fillOpacity = 0.8,\n                   color = \"black\",\n                   weight = 1,\n                   radius = 6,\n                   popup = ~paste(\"Temp:\", Temperatura, \"°C\")) %>% \n  \n  addLegend(\n    pal = pal_pred, \n    values = pred_range,\n    title = \"Predicción T (°C)\",\n    position = \"topright\"\n  ) %>%\n  \n  addLegend(pal = pal,\n            values = datosT_sf_wgs84$Temperatura,\n            title = \"Temperatura Observada\",\n    position = \"topleft\"\n  ) %>% \n  \n  # Añadir controles de capas\n  addLayersControl(\n    overlayGroups = c(\"Predicción Kriging\", \"Contorno\", \"Temperatura Observada\"),\n    options = layersControlOptions(collapsed = FALSE)\n  )\n\n\nvar_raster_utm <- raster(predic, layer = \"Temperatura.var\")\n\n# 2. Asegurarse de que el CRS del ráster se asigne correctamente (EPSG:3310)\ncrs(var_raster_utm) <- \"+init=epsg:3310\"\n\nvar_raster_wgs84 <- raster::projectRaster(\n    raster::mask(\n        var_raster_utm, \n        sh_mundos_sp_utm_simple\n    ),\n    crs = \"+init=epsg:4326\", \n    method = \"bilinear\"\n)\n\nbinsv <- seq(0,30, by=5)\n\nvar_range <- c(minValue(var_raster_wgs84), maxValue(var_raster_wgs84))\npal_var <- colorBin(\n  palette = \"Spectral\", # La paleta de colores\n  domain = var_range,\n  bins = binsv,\n  na.color = \"transparent\"\n)\n\nmapa_var_leaflet <- leaflet() %>%\n  addProviderTiles(providers$CartoDB.Positron) %>%\n  \n  # Añadir la capa ráster de Predicción Kriging\n  addRasterImage(\n    var_raster_wgs84, # Usamos el objeto raster reproyectado\n    colors = pal_var, \n    opacity = 0.7,\n    group = \"Predicción Kriging\"\n  ) %>%\n  \n  # Añadir el contorno de California\n  addPolygons(\n    data = sh_mundos_wgs84,\n    color = \"black\",\n    weight = 2,\n    fill = FALSE,\n    group = \"Contorno\"\n  ) %>% \n  \n  addLegend(\n    pal = pal_var, \n    values = var_range,\n    title = \"Varianza\",\n    position = \"topright\"\n  ) %>%\n  # Añadir controles de capas\n  addLayersControl(\n    overlayGroups = c(\"Varianza de pred\", \"Contorno\"),\n    options = layersControlOptions(collapsed = FALSE)\n  )\n```\n:::\n\n\n\n::: {.panel-tabset}\n#### Predicción\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmapa_kriging_leaflet\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-9f2ab8f6f96ebcfbf0f2\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-9f2ab8f6f96ebcfbf0f2\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.Positron\",null,null,{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addRasterImage\",\"args\":[\"data:image/png;base64,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\",[[42.40486193660753,-124.8128902362941],[32.07286193660753,-113.1326902362941]],null,\"Predicción Kriging\",{\"tileSize\":256,\"zIndex\":1,\"minZoom\":0,\"opacity\":0.7}]},{\"method\":\"addPolygons\",\"args\":[[[[{\"lng\":[-117.1223754882812,-117.1333312988281,-117.1827087402344,-117.2129135131836,-117.2123794555664,-117.2005081176758,-117.1740798950195,-117.1472244262695,-117.1156234741211,-117.1166534423828,-117.1413879394531,-117.2021560668945,-117.2288131713867,-117.2405471801758,-117.2420425415039,-117.2549896240234,-117.2684783935547,-117.26611328125,-117.2587661743164,-117.2803421020508,-117.2529220581055,-117.2490615844727,-117.25,-117.2698593139648,-117.3197326660156,-117.3294525146484,-117.3402862548828,-117.4094390869141,-117.480827331543,-117.495002746582,-117.6319427490234,-117.6725006103516,-117.7744369506836,-117.8638916015625,-117.8840179443359,-117.9108276367188,-117.9361114501953,-117.9550018310547,-117.9736175537109,-117.9949951171875,-118.0270843505859,-118.0452728271484,-118.0830688476562,-118.1081848144531,-118.1347427368164,-118.2222213745117,-118.2671279907227,-118.272087097168,-118.2977752685547,-118.3180694580078,-118.400016784668,-118.4174652099609,-118.3986206054688,-118.3861846923828,-118.4211044311523,-118.432502746582,-118.4544525146484,-118.4711227416992,-118.508903503418,-118.5300064086914,-118.554443359375,-118.6549987792969,-118.6977691650391,-118.7525024414062,-118.7811126708984,-118.8364028930664,-118.9361114501953,-118.9614028930664,-118.9811096191406,-119.1291732788086,-119.1743011474609,-119.2196502685547,-119.2558441162109,-119.3124694824219,-119.4161071777344,-119.446662902832,-119.5416717529297,-119.5772171020508,-119.5997314453125,-119.6247100830078,-119.7986068725586,-120.0037460327148,-120.1308288574219,-120.245002746582,-120.3550033569336,-120.4241561889648,-120.4490280151367,-120.4819412231445,-120.4953460693359,-120.5583267211914,-120.5831909179688,-120.605827331543,-120.6259613037109,-120.6283264160156,-120.623893737793,-120.6033248901367,-120.5941696166992,-120.5913772583008,-120.5980606079102,-120.6247100830078,-120.6137466430664,-120.6000671386719,-120.6181945800781,-120.6805572509766,-120.7186813354492,-120.7385330200195,-120.8313903808594,-120.8567962646484,-120.8697280883789,-120.8681945800781,-120.8591613769531,-120.8411102294922,-120.9199981689453,-120.9770812988281,-120.9994506835938,-121.0477752685547,-121.1666564941406,-121.2687530517578,-121.29638671875,-121.3215408325195,-121.3680572509766,-121.4349899291992,-121.4418029785156,-121.4609680175781,-121.4720840454102,-121.6654205322266,-121.7580642700195,-121.7961044311523,-121.8676300048828,-121.8641662597656,-121.8734664916992,-121.8847427368164,-121.8976440429688,-121.9216613769531,-121.9432525634766,-121.8997955322266,-121.8656158447266,-121.8450012207031,-121.8255615234375,-121.8091506958008,-121.7993087768555,-121.7747192382812,-121.7639007568359,-121.7991638183594,-121.8511123657227,-121.8791656494141,-121.9135971069336,-121.9783325195312,-122.0202865600586,-122.0415191650391,-122.0709762573242,-122.1472320556641,-122.1795806884766,-122.379020690918,-122.3883438110352,-122.393684387207,-122.3844528198242,-122.3731918334961,-122.378044128418,-122.4259719848633,-122.4433288574219,-122.4806137084961,-122.4902801513672,-122.4958267211914,-122.4994430541992,-122.4905471801758,-122.4843063354492,-122.4481201171875,-122.379638671875,-122.359992980957,-122.3513870239258,-122.35693359375,-122.3673553466797,-122.3577728271484,-122.0643005371094,-122.0231857299805,-122.0058364868164,-122.0297164916992,-122.0808334350586,-122.1259689331055,-122.1308288574219,-122.1384811401367,-122.1572265625,-122.1747131347656,-122.2427673339844,-122.2999877929688,-122.3934097290039,-122.352783203125,-122.2252731323242,-122.1633224487305,-122.1277313232422,-122.0158386230469,-121.9894409179688,-121.9155578613281,-121.8572235107422,-121.8337554931641,-121.6848526000977,-121.6541976928711,-121.6434936523438,-121.5911102294922,-121.498046875,-121.4272155761719,-121.4705505371094,-121.5531921386719,-121.5850067138672,-121.6622161865234,-121.6852188110352,-121.7229156494141,-121.8186798095703,-121.9052734375,-121.977783203125,-122.0186233520508,-122.0500030517578,-122.109733581543,-122.2641830444336,-122.2920837402344,-122.311393737793,-122.3652801513672,-122.3908386230469,-122.4783248901367,-122.479866027832,-122.4433288574219,-122.4201354980469,-122.456672668457,-122.505485534668,-122.6566619873047,-122.7822875976562,-122.8169631958008,-122.8966674804688,-122.9283294677734,-122.9563903808594,-122.9269409179688,-122.8399963378906,-122.8030471801758,-122.8077697753906,-122.83056640625,-122.9586181640625,-123.1072235107422,-123.1290283203125,-123.1716613769531,-123.2372131347656,-123.2666625976562,-123.3130645751953,-123.3530578613281,-123.4475021362305,-123.5361175537109,-123.620002746582,-123.7015228271484,-123.7072601318359,-123.6745834350586,-123.6669387817383,-123.6861038208008,-123.712646484375,-123.7541809082031,-123.7957000732422,-123.7956924438477,-123.774169921875,-123.7630615234375,-123.7368698120117,-123.7723617553711,-123.8202819824219,-123.8674926757812,-123.9311065673828,-124.0623550415039,-124.0927734375,-124.1525726318359,-124.2022171020508,-124.297233581543,-124.331184387207,-124.3240356445312,-124.3233413696289,-124.3543090820312,-124.3758239746094,-124.3523559570312,-124.3319473266602,-124.2750091552734,-124.2529144287109,-124.2294464111328,-124.1994323730469,-124.14306640625,-124.0988922119141,-124.0993041992188,-124.1125030517578,-124.1222229003906,-124.0909729003906,-124.061393737793,-124.0458374023438,-124.0399932861328,-124.0467987060547,-124.063606262207,-124.1186065673828,-124.1813812255859,-124.2155609130859,-124.1973571777344,-124.1902770996094,-124.1752777099609,-124.1841583251953,-124.1858520507812,-123.9505615234375,-123.883903503418,-123.5336227416992,-123.4836120605469,-123.4169464111328,-123.366943359375,-123.3169631958008,-123.2669525146484,-123.2169494628906,-123.1669464111328,-123.116943359375,-123.0669631958008,-122.8999862670898,-122.8177795410156,-122.7508392333984,-122.6341705322266,-122.600830078125,-122.5175018310547,-122.2172164916992,-122.1505584716797,-122.1172180175781,-122.0005569458008,-121.9669494628906,-121.8836212158203,-121.8002777099609,-121.7169494628906,-121.6677703857422,-121.5341567993164,-121.4841613769531,-121.4341583251953,-121.3008270263672,-121.1838836669922,-121.133903503418,-121.0672302246094,-120.9169464111328,-120.8510971069336,-120.7677764892578,-120.6841583251953,-120.3208236694336,-120.0341567993164,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.001106262207,-119.8197326660156,-119.5155563354492,-119.0130615234375,-118.8799896240234,-118.3752670288086,-118.2108306884766,-117.8919525146484,-117.7452697753906,-117.5747222900391,-117.4211120605469,-117.2677764892578,-117.1069488525391,-116.946662902832,-116.8027801513672,-116.6513977050781,-116.4924926757812,-116.1999969482422,-116.0269470214844,-115.8622131347656,-115.7527923583984,-115.5580368041992,-115.2555694580078,-115.1241607666016,-114.9933319091797,-114.6563873291016,-114.6219329833984,-114.6197128295898,-114.5563812255859,-114.4933319091797,-114.4561233520508,-114.4188766479492,-114.3781890869141,-114.3695068359375,-114.3358306884766,-114.2726440429688,-114.230827331543,-114.2005615234375,-114.1700668334961,-114.1516723632812,-114.1344528198242,-114.1170120239258,-114.2226409912109,-114.3141632080078,-114.3576278686523,-114.3834762573242,-114.4070892333984,-114.4207611083984,-114.4554061889648,-114.4755630493164,-114.5127868652344,-114.5233306884766,-114.510009765625,-114.4941635131836,-114.48388671875,-114.5275039672852,-114.6404876708984,-114.7255630493164,-114.7260971069336,-114.7038879394531,-114.6836090087891,-114.6681900024414,-114.6752777099609,-114.6965179443359,-114.6970748901367,-114.6788787841797,-114.6626281738281,-114.6029205322266,-114.5701370239258,-114.5452728271484,-114.5153503417969,-114.4644470214844,-114.4587478637695,-114.5352096557617,-114.5541687011719,-114.5844497680664,-114.6125030517578,-114.6526412963867,-114.6955490112305,-114.7190933227539,-114.7297973632812,-114.8713455200195,-115.0258941650391,-115.2024993896484,-115.404167175293,-115.6055603027344,-115.9077835083008,-116.2426376342773,-116.5081481933594,-116.7130584716797,-116.9141693115234,-117.0952911376953,-117.1223754882812],\"lat\":[32.53533172607422,32.56582641601562,32.65929412841797,32.68302917480469,32.69705581665039,32.69759368896484,32.6749382019043,32.61860275268555,32.62131118774414,32.64249420166016,32.68061447143555,32.72769546508789,32.71561431884766,32.68464279174805,32.66253280639648,32.65713882446289,32.68842315673828,32.70860290527344,32.77041625976562,32.82921600341797,32.86082458496094,32.87129211425781,32.88971710205078,32.97707366943359,33.10527038574219,33.12443542480469,33.14166259765625,33.24415588378906,33.32749176025391,33.34221649169922,33.44276428222656,33.47054290771484,33.53943634033203,33.59568405151367,33.60055160522461,33.60665893554688,33.62054443359375,33.63276672363281,33.64554595947266,33.66249084472656,33.69401931762695,33.70943450927734,33.73971557617188,33.75693893432617,33.76666259765625,33.78416442871094,33.75777435302734,33.72332000732422,33.71610260009766,33.7208251953125,33.74985504150391,33.78179931640625,33.80804443359375,33.84096527099609,33.92124557495117,33.93915557861328,33.96776580810547,33.98777008056641,34.03110504150391,34.04791259765625,34.05568695068359,34.0494384765625,34.04610443115234,34.03971862792969,34.03318786621094,34.03054809570312,34.05554962158203,34.06221008300781,34.06749725341797,34.11388397216797,34.1361083984375,34.16492080688477,34.22346115112305,34.28351593017578,34.35749816894531,34.37332153320312,34.41415405273438,34.42054748535156,34.42360687255859,34.42471313476562,34.42638397216797,34.4679069519043,34.47873687744141,34.47360229492188,34.46582794189453,34.45610046386719,34.4556884765625,34.50957489013672,34.53047561645508,34.56193542480469,34.56221389770508,34.55860137939453,34.58443832397461,34.62360382080078,34.64110565185547,34.66943740844727,34.69026947021484,34.71082305908203,34.8608283996582,34.89499664306641,35.01860427856445,35.10005950927734,35.13943862915039,35.17110443115234,35.18054580688477,35.16464233398438,35.20999145507812,35.22880935668945,35.25722122192383,35.27999496459961,35.3074951171875,35.35527038574219,35.44887542724609,35.46596145629883,35.47915649414062,35.52499008178711,35.64916229248047,35.70013046264648,35.76610565185547,35.79402542114258,35.82916259765625,35.8942985534668,35.92804718017578,35.97943496704102,35.99777221679688,36.18304443359375,36.22943496704102,36.24110412597656,36.31533813476562,36.3429069519043,36.39388656616211,36.43387603759766,36.46735382080078,36.51805114746094,36.59457397460938,36.64124298095703,36.61985397338867,36.61513137817383,36.6270751953125,36.64846420288086,36.66790771484375,36.75916290283203,36.81249237060547,36.88401794433594,36.95068740844727,36.97248840332031,36.9803352355957,36.96915435791016,36.95485305786133,36.95415878295898,36.96235275268555,36.99582672119141,37.01763153076172,37.19998931884766,37.22026824951172,37.25186538696289,37.28971862792969,37.32915878295898,37.37443542480469,37.48429489135742,37.50436782836914,37.5122184753418,37.52999114990234,37.56610107421875,37.58998870849609,37.75222015380859,37.78992462158203,37.81005859375,37.81381225585938,37.78693771362305,37.73165893554688,37.68762969970703,37.65443420410156,37.61582565307617,37.45929718017578,37.45790863037109,37.47137451171875,37.47943115234375,37.51027297973633,37.6027717590332,37.6322135925293,37.66221618652344,37.69470977783203,37.71471405029297,37.76666259765625,37.82638549804688,37.95915985107422,37.99082946777344,38.06415939331055,38.04743576049805,38.03526306152344,38.06610107421875,38.06554412841797,38.05416107177734,38.04305267333984,38.03666305541992,38.01811599731445,38.04861831665039,38.0789909362793,38.10464859008789,38.04888153076172,38.01290893554688,38.05499267578125,38.11041259765625,38.11568832397461,38.09658813476562,38.06646728515625,38.04746627807617,38.08115386962891,38.06610107421875,38.09721374511719,38.14811325073242,38.10877990722656,38.06137847900391,38.10999298095703,38.12693405151367,38.1361083984375,38.15554809570312,38.14749145507812,38.11957168579102,37.9366569519043,37.90693664550781,37.88318634033203,37.83346557617188,37.83103942871094,37.91054534912109,38.00131607055664,38.02027130126953,38.05443572998047,38.05360412597656,38.05804443359375,38.16249084472656,38.10777282714844,38.08193969726562,38.09498977661133,38.12748718261719,38.28527069091797,38.46277236938477,38.47290802001953,38.49193572998047,38.52276611328125,38.54083251953125,38.57388305664062,38.62443542480469,38.7340202331543,38.79610443115234,38.86082458496094,38.93041229248047,38.97109985351562,39.00458145141602,39.02554702758789,39.1219367980957,39.17804718017578,39.25943756103516,39.35332489013672,39.38582611083984,39.49652099609375,39.51915740966797,39.55499267578125,39.70971298217773,39.79166412353516,39.86915588378906,39.94971466064453,40.09165954589844,40.11631011962891,40.14790725708008,40.17416381835938,40.23804473876953,40.27245712280273,40.31193542480469,40.33624267578125,40.41526794433594,40.44769668579102,40.5322151184082,40.5816650390625,40.6947135925293,40.724365234375,40.74638366699219,40.74554443359375,40.81193542480469,40.99193572998047,41.03853607177734,41.0574951171875,41.15749359130859,41.24985504150391,41.34415435791016,41.39443969726562,41.42777252197266,41.46318435668945,41.51527404785156,41.68305206298828,41.75416564941406,41.81999206542969,41.84804916381836,41.86943817138672,41.94971466064453,41.99415588378906,41.99946594238281,42,42,42,42,42,42,42,42,42,42,42,42,42,42,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,42,42,42,42,42,42,42,42,42,42,42,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99964904785156,42,41.99943542480469,40.43305206298828,39.84943389892578,39.56610107421875,39.44971466064453,39.33332824707031,39.00721740722656,38.88276672363281,38.67276763916016,38.32054901123047,38.22609710693359,37.86527252197266,37.74638366699219,37.51416015625,37.40665435791016,37.28110504150391,37.16721343994141,37.05304718017578,36.93276977539062,36.81221008300781,36.70360565185547,36.58860015869141,36.46749114990234,36.24276733398438,36.10888671875,35.98081970214844,35.89499664306641,35.74221801757812,35.50277709960938,35.39804840087891,35.29332733154297,35.02165985107422,34.99214935302734,34.88193511962891,34.81666564941406,34.75833129882812,34.69860076904297,34.63166046142578,34.55082702636719,34.52193832397461,34.46415710449219,34.41582489013672,34.38999176025391,34.37276458740234,34.35867691040039,34.34276580810547,34.32332611083984,34.28804779052734,34.19624328613281,34.14665985107422,34.12568283081055,34.11429977416992,34.09207153320312,34.03013229370117,34.00124359130859,33.98721313476562,33.96152114868164,33.94415283203125,33.86888122558594,33.78305053710938,33.72193145751953,33.55929946899414,33.42033767700195,33.39916229248047,33.31888580322266,33.28054809570312,33.24638366699219,33.20901870727539,33.15541076660156,33.115478515625,33.08943557739258,33.06137847900391,33.04374313354492,33.02971267700195,33.03360748291016,33.03471755981445,33.02554702758789,32.97165679931641,32.86235046386719,32.73200607299805,32.72499084472656,32.72568511962891,32.73110198974609,32.74179840087891,32.74096298217773,32.71845626831055,32.71771240234375,32.70785140991211,32.69698715209961,32.68444061279297,32.66971588134766,32.65471649169922,32.63194274902344,32.60577011108398,32.58499908447266,32.568603515625,32.55221557617188,32.53665924072266,32.53533172607422]}],[{\"lng\":[-119.8680572509766,-119.6983337402344,-119.5936126708984,-119.5631866455078,-119.5527801513672,-119.5155639648438,-119.5329895019531,-119.5899963378906,-119.7133331298828,-119.7727813720703,-119.788330078125,-119.8369369506836,-119.8709716796875,-119.9177703857422,-119.9142303466797,-119.8680572509766],\"lat\":[34.08415985107422,34.04527282714844,34.05387878417969,34.06583023071289,34.06582641601562,34.04457855224609,34.01513290405273,33.99721527099609,33.97082138061523,33.96720886230469,33.96720886230469,33.97415924072266,33.99151992797852,34.06526947021484,34.0826301574707,34.08415985107422]}],[{\"lng\":[-120,-119.9694442749023,-119.9663925170898,-120.0365295410156,-120.1074981689453,-120.1216583251953,-120.1452789306641,-120.164436340332,-120.172233581543,-120.1922073364258,-120.2260971069336,-120.1847229003906,-120.135009765625,-120.0519409179688,-120.0352783203125,-120],\"lat\":[33.98963165283203,33.99235534667969,33.96249008178711,33.91915893554688,33.90554809570312,33.90804290771484,33.91666412353516,33.92777252197266,33.93471527099609,33.95943450927734,34.006103515625,34.01583099365234,34.02610015869141,34.03610992431641,34.02388000488281,33.98963165283203]}],[{\"lng\":[-118.5166625976562,-118.4452667236328,-118.4033432006836,-118.3497314453125,-118.297233581543,-118.2931213378906,-118.3037414550781,-118.4496459960938,-118.5899276733398,-118.5811233520508,-118.5418014526367,-118.5288925170898,-118.5166625976562],\"lat\":[33.47776794433594,33.44276428222656,33.42804718017578,33.39833068847656,33.34609985351562,33.32867431640625,33.30985260009766,33.32860565185547,33.48381042480469,33.49082946777344,33.48943710327148,33.48624420166016,33.47776794433594]}],[{\"lng\":[-118.5302886962891,-118.5261077880859,-118.5202789306641,-118.504997253418,-118.4822235107422,-118.413330078125,-118.3691635131836,-118.3694534301758,-118.4086074829102,-118.477783203125,-118.4869384765625,-118.4938812255859,-118.5338897705078,-118.570556640625,-118.5948638916016,-118.5938949584961,-118.5544281005859,-118.5302886962891],\"lat\":[32.99332427978516,32.98360443115234,32.97499084472656,32.959716796875,32.93804168701172,32.88555145263672,32.85471343994141,32.83277130126953,32.81707763671875,32.85277557373047,32.85888671875,32.86666107177734,32.92721557617188,32.98416137695312,33.03305053710938,33.04458236694336,33.04305267333984,32.99332427978516]}]]],null,\"Contorno\",{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":\"black\",\"weight\":2,\"opacity\":0.5,\"fill\":false,\"fillColor\":\"black\",\"fillOpacity\":0.2,\"smoothFactor\":1,\"noClip\":false},null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addCircleMarkers\",\"args\":[[38.342606,38.690757,39.76168,39.32756,38.20185,39.18919,38.94498,36.7056,36.78538,36.8414,36.6324,36.71088,36.5975,36.819199,39.53387,37.360701,36.3261,36.3663,36.3619,36.5432,36.4581,36.5092,36.4878,36.5975,37.3667,37.0056,35.345607,35.0544,35.356615,35.438035,34.8416,35.3313,35.23918,36.102219,36.3144,34.1439,34.051097,34.066429,34.1992,33.9014,34.010283,34.13263,33.859662,34.3833,36.8669,36.9533,37.713299,39.150478,39.145733,39.43734,37.645718,37.962069,38.0697,36.48187,36.209286,36.694261,39.234402,39.3386,33.830586,33.819305,33.925062,38.74643,39.9395,40.301899,39.8134,33.7472,33.920758,33.583099,33.572019,33.852605,33.999449,33.996387,33.676535,38.613804,38.56844,38.302591,38.683304,38.593328,36.843425,36.485001,34.894054,34.243132,34.068114,34.0309,34.510955,35.774455,34.100132,34.416506,34.059626,34.0714,34.106678,37.8027,37.6825,35.614668,34.42775,34.7256,34.5414,34.402802,34.4897,34.637798,34.445301,36.98332,37.06315,40.5403,37.642165,37.4883,39.13868,36.489399,36.0319,34.21017,34.40428,34.44806,34.27632,34.25239,38.53455,36.280596,36.607215,35.04944,33.793713,34.181977,39.39861,36.841488,32.72519],[-120.764426,-120.072682,-121.84047,-121.66881,-120.680277,-121.99887,-119.97061,-119.7414,-119.77321,-119.8744,-120.3822,-119.77743,-119.5036,-119.7164,-122.190834,-118.330835,-117.9551,-117.8976,-118.0108,-117.9418,-117.8519,-116.8481,-117.871,-118.04,-118.4167,-118.2936,-118.851825,-119.4039,-119.062613,-119.016787,-118.8647,-119,-118.78863,-119.566002,-119.6436,-117.8508,-118.456386,-118.226755,-118.5331,-118.205,-118.068484,-118.127142,-118.200707,-118.5283,-120.01,-120.0341,-119.7061,-123.206528,-123.202995,-123.78766,-118.966515,-119.120278,-118.9477,-121.73333,-121.126371,-121.623271,-121.055603,-120.170303,-117.938509,-117.918759,-117.952586,-121.26498,-120.9443,-121.235001,-120.4707,-115.8201,-116.858419,-117.072197,-116.063823,-116.540965,-117.415831,-117.4925,-117.331027,-121.368007,-121.49311,-121.420838,-121.164457,-121.503728,-121.3621,-121.155602,-117.024756,-117.272275,-117.525796,-117.617403,-117.32555,-117.372109,-117.491982,-117.285602,-117.147347,-116.3906,-117.274063,-121.2208,-121.4406,-120.656912,-119.69091,-120.4278,-119.7906,-119.457497,-120.0458,-120.456703,-119.827797,-121.98822,-122.083092,-121.5764,-120.994212,-120.8358,-121.61884,-118.826897,-119.055,-118.87051,-118.80998,-119.2313,-118.68369,-119.14318,-121.7734,-118.011661,-118.05473,-118.18893,-118.171019,-118.363036,-123.35872,-121.533444,-116.36441],6,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":\"black\",\"weight\":1,\"opacity\":0.5,\"fill\":true,\"fillColor\":[\"#98D83E\",\"#30B57B\",\"#9DD93B\",\"#92D742\",\"#9CD93B\",\"#9CD93B\",\"#3FBC73\",\"#CAE11F\",\"#D0E11C\",\"#CAE11F\",\"#C0DF25\",\"#D9E319\",\"#C6E021\",\"#C8E020\",\"#A3DA37\",\"#B8DE29\",\"#BCDF26\",\"#BCDF26\",\"#B8DE29\",\"#C5E021\",\"#BADE28\",\"#FDE725\",\"#BADE28\",\"#C5E021\",\"#ACDC31\",\"#440154\",\"#CAE11F\",\"#C7E020\",\"#D8E219\",\"#CAE11F\",\"#86D549\",\"#D5E21A\",\"#D0E11C\",\"#C2DF23\",\"#C9E020\",\"#B1DD2E\",\"#B1DD2E\",\"#B4DE2C\",\"#B2DD2D\",\"#B4DE2C\",\"#BBDE27\",\"#ACDC31\",\"#BEDF26\",\"#A5DB36\",\"#C6E021\",\"#C9E020\",\"#5DC863\",\"#8AD547\",\"#8ED645\",\"#8CD646\",\"#3EBC73\",\"#57C666\",\"#5BC864\",\"#ABDC31\",\"#ADDC30\",\"#BEDF26\",\"#66CB5D\",\"#3ABA76\",\"#B9DE29\",\"#C3DF22\",\"#C2DF23\",\"#9CD93C\",\"#69CD5B\",\"#54C568\",\"#53C568\",\"#BADE28\",\"#A6DB35\",\"#B1DD2E\",\"#FDE725\",\"#DBE319\",\"#C0DF25\",\"#BEDF26\",\"#B2DD2D\",\"#A4DB36\",\"#A6DB35\",\"#ACDC31\",\"#99D83D\",\"#A3DA37\",\"#A8DB34\",\"#9DD93B\",\"#BCDF26\",\"#65CB5E\",\"#BBDE27\",\"#C0DF25\",\"#94D741\",\"#E0E318\",\"#BADE28\",\"#8FD744\",\"#B3DD2C\",\"#89D548\",\"#BEDF26\",\"#B7DE2A\",\"#C1DF24\",\"#99D83D\",\"#B2DD2D\",\"#A6DB35\",\"#9AD93D\",\"#A1DA38\",\"#95D840\",\"#BDDF26\",\"#B8DE29\",\"#96D83F\",\"#2AB07F\",\"#65CB5E\",\"#B6DE2A\",\"#AFDD2F\",\"#95D840\",\"#AFDD2F\",\"#C9E020\",\"#9ED93A\",\"#A6DB35\",\"#A1DA38\",\"#9DD93B\",\"#B3DD2C\",\"#9CD93C\",\"#B3DD2C\",\"#C5E021\",\"#A1DA38\",\"#BADE28\",\"#AFDD2F\",\"#66CB5D\",\"#B2DD2D\",\"#76D153\"],\"fillOpacity\":0.8},null,null,[\"Temp: 12.9 °C\",\"Temp: -1.8 °C\",\"Temp: 13.5 °C\",\"Temp: 12.2 °C\",\"Temp: 13.4 °C\",\"Temp: 13.4 °C\",\"Temp: 1 °C\",\"Temp: 18.5 °C\",\"Temp: 19.1 °C\",\"Temp: 18.6 °C\",\"Temp: 17.4 °C\",\"Temp: 20.2 °C\",\"Temp: 18.1 °C\",\"Temp: 18.3 °C\",\"Temp: 14.2 °C\",\"Temp: 16.5 °C\",\"Temp: 17 °C\",\"Temp: 17 °C\",\"Temp: 16.5 °C\",\"Temp: 18 °C\",\"Temp: 16.7 °C\",\"Temp: 24.5 °C\",\"Temp: 16.8 °C\",\"Temp: 18 °C\",\"Temp: 15.2 °C\",\"Temp: -51.3 °C\",\"Temp: 18.6 °C\",\"Temp: 18.2 °C\",\"Temp: 20 °C\",\"Temp: 18.5 °C\",\"Temp: 10.8 °C\",\"Temp: 19.7 °C\",\"Temp: 19.2 °C\",\"Temp: 17.6 °C\",\"Temp: 18.4 °C\",\"Temp: 15.7 °C\",\"Temp: 15.8 °C\",\"Temp: 16.1 °C\",\"Temp: 15.9 °C\",\"Temp: 16.1 °C\",\"Temp: 16.9 °C\",\"Temp: 15.2 °C\",\"Temp: 17.2 °C\",\"Temp: 14.4 °C\",\"Temp: 18.1 °C\",\"Temp: 18.4 °C\",\"Temp: 5.6 °C\",\"Temp: 11.2 °C\",\"Temp: 11.7 °C\",\"Temp: 11.5 °C\",\"Temp: 0.9 °C\",\"Temp: 4.7 °C\",\"Temp: 5.3 °C\",\"Temp: 15.1 °C\",\"Temp: 15.3 °C\",\"Temp: 17.2 °C\",\"Temp: 6.8 °C\",\"Temp: 0.1 °C\",\"Temp: 16.6 °C\",\"Temp: 17.8 °C\",\"Temp: 17.6 °C\",\"Temp: 13.3 °C\",\"Temp: 7.2 °C\",\"Temp: 4.3 °C\",\"Temp: 4.2 °C\",\"Temp: 16.7 °C\",\"Temp: 14.5 °C\",\"Temp: 15.8 °C\",\"Temp: 24.5 °C\",\"Temp: 20.4 °C\",\"Temp: 17.4 °C\",\"Temp: 17.2 °C\",\"Temp: 15.9 °C\",\"Temp: 14.3 °C\",\"Temp: 14.5 °C\",\"Temp: 15.2 °C\",\"Temp: 13 °C\",\"Temp: 14.2 °C\",\"Temp: 14.7 °C\",\"Temp: 13.5 °C\",\"Temp: 17 °C\",\"Temp: 6.7 °C\",\"Temp: 16.9 °C\",\"Temp: 17.4 °C\",\"Temp: 12.4 °C\",\"Temp: 21 °C\",\"Temp: 16.8 °C\",\"Temp: 11.9 °C\",\"Temp: 16 °C\",\"Temp: 11.1 °C\",\"Temp: 17.2 °C\",\"Temp: 16.4 °C\",\"Temp: 17.5 °C\",\"Temp: 13 °C\",\"Temp: 15.9 °C\",\"Temp: 14.5 °C\",\"Temp: 13.1 °C\",\"Temp: 14 °C\",\"Temp: 12.6 °C\",\"Temp: 17.1 °C\",\"Temp: 16.5 °C\",\"Temp: 12.7 °C\",\"Temp: -3.2 °C\",\"Temp: 6.7 °C\",\"Temp: 16.3 °C\",\"Temp: 15.5 °C\",\"Temp: 12.6 °C\",\"Temp: 15.5 °C\",\"Temp: 18.4 °C\",\"Temp: 13.6 °C\",\"Temp: 14.5 °C\",\"Temp: 14 °C\",\"Temp: 13.5 °C\",\"Temp: 16 °C\",\"Temp: 13.3 °C\",\"Temp: 16 °C\",\"Temp: 18 °C\",\"Temp: 13.9 °C\",\"Temp: 16.7 °C\",\"Temp: 15.5 °C\",\"Temp: 6.8 °C\",\"Temp: 15.9 °C\",\"Temp: 8.9 °C\"],null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#440154\",\"#46327E\",\"#365C8D\",\"#277F8E\",\"#1FA187\",\"#4AC16D\",\"#9FDA3A\",\"#FDE725\"],\"labels\":[\"-5 &ndash; 0\",\"0 &ndash; 5\",\"5 &ndash; 8\",\"8 &ndash; 10\",\"10 &ndash; 12\",\"12 &ndash; 15\",\"15 &ndash; 20\",\"20 &ndash; 25\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":0.5,\"position\":\"topright\",\"type\":\"bin\",\"title\":\"Predicción T (°C)\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#440154 , #46075B 1.71503957783641%, #463480 14.9076517150396%, #375B8D 28.1002638522427%, #297B8E 41.2928759894459%, #1E9B8A 54.4854881266491%, #39BA76 67.6781002638522%, #7FD34E 80.8707124010554%, #D8E219 94.0633245382586%, #FDE725 \"],\"labels\":[\"-50\",\"-40\",\"-30\",\"-20\",\"-10\",\"0\",\"10\",\"20\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":0.5,\"position\":\"topleft\",\"type\":\"numeric\",\"title\":\"Temperatura Observada\",\"extra\":{\"p_1\":0.01715039577836408,\"p_n\":0.9406332453825857},\"layerId\":null,\"className\":\"info legend\",\"group\":null}]},{\"method\":\"addLayersControl\",\"args\":[[],[\"Predicción Kriging\",\"Contorno\",\"Temperatura Observada\"],{\"collapsed\":false,\"autoZIndex\":true,\"position\":\"topright\"}]}],\"limits\":{\"lat\":[32.07286193660753,42.40486193660753],\"lng\":[-124.8128902362941,-113.1326902362941]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n#### Varianza\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmapa_var_leaflet\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-925b584b3ccf8ace5fda\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-925b584b3ccf8ace5fda\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.Positron\",null,null,{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addRasterImage\",\"args\":[\"data:image/png;base64,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\",[[42.40486193660753,-124.8128902362941],[32.07286193660753,-113.1326902362941]],null,\"Predicción Kriging\",{\"tileSize\":256,\"zIndex\":1,\"minZoom\":0,\"opacity\":0.7}]},{\"method\":\"addPolygons\",\"args\":[[[[{\"lng\":[-117.1223754882812,-117.1333312988281,-117.1827087402344,-117.2129135131836,-117.2123794555664,-117.2005081176758,-117.1740798950195,-117.1472244262695,-117.1156234741211,-117.1166534423828,-117.1413879394531,-117.2021560668945,-117.2288131713867,-117.2405471801758,-117.2420425415039,-117.2549896240234,-117.2684783935547,-117.26611328125,-117.2587661743164,-117.2803421020508,-117.2529220581055,-117.2490615844727,-117.25,-117.2698593139648,-117.3197326660156,-117.3294525146484,-117.3402862548828,-117.4094390869141,-117.480827331543,-117.495002746582,-117.6319427490234,-117.6725006103516,-117.7744369506836,-117.8638916015625,-117.8840179443359,-117.9108276367188,-117.9361114501953,-117.9550018310547,-117.9736175537109,-117.9949951171875,-118.0270843505859,-118.0452728271484,-118.0830688476562,-118.1081848144531,-118.1347427368164,-118.2222213745117,-118.2671279907227,-118.272087097168,-118.2977752685547,-118.3180694580078,-118.400016784668,-118.4174652099609,-118.3986206054688,-118.3861846923828,-118.4211044311523,-118.432502746582,-118.4544525146484,-118.4711227416992,-118.508903503418,-118.5300064086914,-118.554443359375,-118.6549987792969,-118.6977691650391,-118.7525024414062,-118.7811126708984,-118.8364028930664,-118.9361114501953,-118.9614028930664,-118.9811096191406,-119.1291732788086,-119.1743011474609,-119.2196502685547,-119.2558441162109,-119.3124694824219,-119.4161071777344,-119.446662902832,-119.5416717529297,-119.5772171020508,-119.5997314453125,-119.6247100830078,-119.7986068725586,-120.0037460327148,-120.1308288574219,-120.245002746582,-120.3550033569336,-120.4241561889648,-120.4490280151367,-120.4819412231445,-120.4953460693359,-120.5583267211914,-120.5831909179688,-120.605827331543,-120.6259613037109,-120.6283264160156,-120.623893737793,-120.6033248901367,-120.5941696166992,-120.5913772583008,-120.5980606079102,-120.6247100830078,-120.6137466430664,-120.6000671386719,-120.6181945800781,-120.6805572509766,-120.7186813354492,-120.7385330200195,-120.8313903808594,-120.8567962646484,-120.8697280883789,-120.8681945800781,-120.8591613769531,-120.8411102294922,-120.9199981689453,-120.9770812988281,-120.9994506835938,-121.0477752685547,-121.1666564941406,-121.2687530517578,-121.29638671875,-121.3215408325195,-121.3680572509766,-121.4349899291992,-121.4418029785156,-121.4609680175781,-121.4720840454102,-121.6654205322266,-121.7580642700195,-121.7961044311523,-121.8676300048828,-121.8641662597656,-121.8734664916992,-121.8847427368164,-121.8976440429688,-121.9216613769531,-121.9432525634766,-121.8997955322266,-121.8656158447266,-121.8450012207031,-121.8255615234375,-121.8091506958008,-121.7993087768555,-121.7747192382812,-121.7639007568359,-121.7991638183594,-121.8511123657227,-121.8791656494141,-121.9135971069336,-121.9783325195312,-122.0202865600586,-122.0415191650391,-122.0709762573242,-122.1472320556641,-122.1795806884766,-122.379020690918,-122.3883438110352,-122.393684387207,-122.3844528198242,-122.3731918334961,-122.378044128418,-122.4259719848633,-122.4433288574219,-122.4806137084961,-122.4902801513672,-122.4958267211914,-122.4994430541992,-122.4905471801758,-122.4843063354492,-122.4481201171875,-122.379638671875,-122.359992980957,-122.3513870239258,-122.35693359375,-122.3673553466797,-122.3577728271484,-122.0643005371094,-122.0231857299805,-122.0058364868164,-122.0297164916992,-122.0808334350586,-122.1259689331055,-122.1308288574219,-122.1384811401367,-122.1572265625,-122.1747131347656,-122.2427673339844,-122.2999877929688,-122.3934097290039,-122.352783203125,-122.2252731323242,-122.1633224487305,-122.1277313232422,-122.0158386230469,-121.9894409179688,-121.9155578613281,-121.8572235107422,-121.8337554931641,-121.6848526000977,-121.6541976928711,-121.6434936523438,-121.5911102294922,-121.498046875,-121.4272155761719,-121.4705505371094,-121.5531921386719,-121.5850067138672,-121.6622161865234,-121.6852188110352,-121.7229156494141,-121.8186798095703,-121.9052734375,-121.977783203125,-122.0186233520508,-122.0500030517578,-122.109733581543,-122.2641830444336,-122.2920837402344,-122.311393737793,-122.3652801513672,-122.3908386230469,-122.4783248901367,-122.479866027832,-122.4433288574219,-122.4201354980469,-122.456672668457,-122.505485534668,-122.6566619873047,-122.7822875976562,-122.8169631958008,-122.8966674804688,-122.9283294677734,-122.9563903808594,-122.9269409179688,-122.8399963378906,-122.8030471801758,-122.8077697753906,-122.83056640625,-122.9586181640625,-123.1072235107422,-123.1290283203125,-123.1716613769531,-123.2372131347656,-123.2666625976562,-123.3130645751953,-123.3530578613281,-123.4475021362305,-123.5361175537109,-123.620002746582,-123.7015228271484,-123.7072601318359,-123.6745834350586,-123.6669387817383,-123.6861038208008,-123.712646484375,-123.7541809082031,-123.7957000732422,-123.7956924438477,-123.774169921875,-123.7630615234375,-123.7368698120117,-123.7723617553711,-123.8202819824219,-123.8674926757812,-123.9311065673828,-124.0623550415039,-124.0927734375,-124.1525726318359,-124.2022171020508,-124.297233581543,-124.331184387207,-124.3240356445312,-124.3233413696289,-124.3543090820312,-124.3758239746094,-124.3523559570312,-124.3319473266602,-124.2750091552734,-124.2529144287109,-124.2294464111328,-124.1994323730469,-124.14306640625,-124.0988922119141,-124.0993041992188,-124.1125030517578,-124.1222229003906,-124.0909729003906,-124.061393737793,-124.0458374023438,-124.0399932861328,-124.0467987060547,-124.063606262207,-124.1186065673828,-124.1813812255859,-124.2155609130859,-124.1973571777344,-124.1902770996094,-124.1752777099609,-124.1841583251953,-124.1858520507812,-123.9505615234375,-123.883903503418,-123.5336227416992,-123.4836120605469,-123.4169464111328,-123.366943359375,-123.3169631958008,-123.2669525146484,-123.2169494628906,-123.1669464111328,-123.116943359375,-123.0669631958008,-122.8999862670898,-122.8177795410156,-122.7508392333984,-122.6341705322266,-122.600830078125,-122.5175018310547,-122.2172164916992,-122.1505584716797,-122.1172180175781,-122.0005569458008,-121.9669494628906,-121.8836212158203,-121.8002777099609,-121.7169494628906,-121.6677703857422,-121.5341567993164,-121.4841613769531,-121.4341583251953,-121.3008270263672,-121.1838836669922,-121.133903503418,-121.0672302246094,-120.9169464111328,-120.8510971069336,-120.7677764892578,-120.6841583251953,-120.3208236694336,-120.0341567993164,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.001106262207,-119.8197326660156,-119.5155563354492,-119.0130615234375,-118.8799896240234,-118.3752670288086,-118.2108306884766,-117.8919525146484,-117.7452697753906,-117.5747222900391,-117.4211120605469,-117.2677764892578,-117.1069488525391,-116.946662902832,-116.8027801513672,-116.6513977050781,-116.4924926757812,-116.1999969482422,-116.0269470214844,-115.8622131347656,-115.7527923583984,-115.5580368041992,-115.2555694580078,-115.1241607666016,-114.9933319091797,-114.6563873291016,-114.6219329833984,-114.6197128295898,-114.5563812255859,-114.4933319091797,-114.4561233520508,-114.4188766479492,-114.3781890869141,-114.3695068359375,-114.3358306884766,-114.2726440429688,-114.230827331543,-114.2005615234375,-114.1700668334961,-114.1516723632812,-114.1344528198242,-114.1170120239258,-114.2226409912109,-114.3141632080078,-114.3576278686523,-114.3834762573242,-114.4070892333984,-114.4207611083984,-114.4554061889648,-114.4755630493164,-114.5127868652344,-114.5233306884766,-114.510009765625,-114.4941635131836,-114.48388671875,-114.5275039672852,-114.6404876708984,-114.7255630493164,-114.7260971069336,-114.7038879394531,-114.6836090087891,-114.6681900024414,-114.6752777099609,-114.6965179443359,-114.6970748901367,-114.6788787841797,-114.6626281738281,-114.6029205322266,-114.5701370239258,-114.5452728271484,-114.5153503417969,-114.4644470214844,-114.4587478637695,-114.5352096557617,-114.5541687011719,-114.5844497680664,-114.6125030517578,-114.6526412963867,-114.6955490112305,-114.7190933227539,-114.7297973632812,-114.8713455200195,-115.0258941650391,-115.2024993896484,-115.404167175293,-115.6055603027344,-115.9077835083008,-116.2426376342773,-116.5081481933594,-116.7130584716797,-116.9141693115234,-117.0952911376953,-117.1223754882812],\"lat\":[32.53533172607422,32.56582641601562,32.65929412841797,32.68302917480469,32.69705581665039,32.69759368896484,32.6749382019043,32.61860275268555,32.62131118774414,32.64249420166016,32.68061447143555,32.72769546508789,32.71561431884766,32.68464279174805,32.66253280639648,32.65713882446289,32.68842315673828,32.70860290527344,32.77041625976562,32.82921600341797,32.86082458496094,32.87129211425781,32.88971710205078,32.97707366943359,33.10527038574219,33.12443542480469,33.14166259765625,33.24415588378906,33.32749176025391,33.34221649169922,33.44276428222656,33.47054290771484,33.53943634033203,33.59568405151367,33.60055160522461,33.60665893554688,33.62054443359375,33.63276672363281,33.64554595947266,33.66249084472656,33.69401931762695,33.70943450927734,33.73971557617188,33.75693893432617,33.76666259765625,33.78416442871094,33.75777435302734,33.72332000732422,33.71610260009766,33.7208251953125,33.74985504150391,33.78179931640625,33.80804443359375,33.84096527099609,33.92124557495117,33.93915557861328,33.96776580810547,33.98777008056641,34.03110504150391,34.04791259765625,34.05568695068359,34.0494384765625,34.04610443115234,34.03971862792969,34.03318786621094,34.03054809570312,34.05554962158203,34.06221008300781,34.06749725341797,34.11388397216797,34.1361083984375,34.16492080688477,34.22346115112305,34.28351593017578,34.35749816894531,34.37332153320312,34.41415405273438,34.42054748535156,34.42360687255859,34.42471313476562,34.42638397216797,34.4679069519043,34.47873687744141,34.47360229492188,34.46582794189453,34.45610046386719,34.4556884765625,34.50957489013672,34.53047561645508,34.56193542480469,34.56221389770508,34.55860137939453,34.58443832397461,34.62360382080078,34.64110565185547,34.66943740844727,34.69026947021484,34.71082305908203,34.8608283996582,34.89499664306641,35.01860427856445,35.10005950927734,35.13943862915039,35.17110443115234,35.18054580688477,35.16464233398438,35.20999145507812,35.22880935668945,35.25722122192383,35.27999496459961,35.3074951171875,35.35527038574219,35.44887542724609,35.46596145629883,35.47915649414062,35.52499008178711,35.64916229248047,35.70013046264648,35.76610565185547,35.79402542114258,35.82916259765625,35.8942985534668,35.92804718017578,35.97943496704102,35.99777221679688,36.18304443359375,36.22943496704102,36.24110412597656,36.31533813476562,36.3429069519043,36.39388656616211,36.43387603759766,36.46735382080078,36.51805114746094,36.59457397460938,36.64124298095703,36.61985397338867,36.61513137817383,36.6270751953125,36.64846420288086,36.66790771484375,36.75916290283203,36.81249237060547,36.88401794433594,36.95068740844727,36.97248840332031,36.9803352355957,36.96915435791016,36.95485305786133,36.95415878295898,36.96235275268555,36.99582672119141,37.01763153076172,37.19998931884766,37.22026824951172,37.25186538696289,37.28971862792969,37.32915878295898,37.37443542480469,37.48429489135742,37.50436782836914,37.5122184753418,37.52999114990234,37.56610107421875,37.58998870849609,37.75222015380859,37.78992462158203,37.81005859375,37.81381225585938,37.78693771362305,37.73165893554688,37.68762969970703,37.65443420410156,37.61582565307617,37.45929718017578,37.45790863037109,37.47137451171875,37.47943115234375,37.51027297973633,37.6027717590332,37.6322135925293,37.66221618652344,37.69470977783203,37.71471405029297,37.76666259765625,37.82638549804688,37.95915985107422,37.99082946777344,38.06415939331055,38.04743576049805,38.03526306152344,38.06610107421875,38.06554412841797,38.05416107177734,38.04305267333984,38.03666305541992,38.01811599731445,38.04861831665039,38.0789909362793,38.10464859008789,38.04888153076172,38.01290893554688,38.05499267578125,38.11041259765625,38.11568832397461,38.09658813476562,38.06646728515625,38.04746627807617,38.08115386962891,38.06610107421875,38.09721374511719,38.14811325073242,38.10877990722656,38.06137847900391,38.10999298095703,38.12693405151367,38.1361083984375,38.15554809570312,38.14749145507812,38.11957168579102,37.9366569519043,37.90693664550781,37.88318634033203,37.83346557617188,37.83103942871094,37.91054534912109,38.00131607055664,38.02027130126953,38.05443572998047,38.05360412597656,38.05804443359375,38.16249084472656,38.10777282714844,38.08193969726562,38.09498977661133,38.12748718261719,38.28527069091797,38.46277236938477,38.47290802001953,38.49193572998047,38.52276611328125,38.54083251953125,38.57388305664062,38.62443542480469,38.7340202331543,38.79610443115234,38.86082458496094,38.93041229248047,38.97109985351562,39.00458145141602,39.02554702758789,39.1219367980957,39.17804718017578,39.25943756103516,39.35332489013672,39.38582611083984,39.49652099609375,39.51915740966797,39.55499267578125,39.70971298217773,39.79166412353516,39.86915588378906,39.94971466064453,40.09165954589844,40.11631011962891,40.14790725708008,40.17416381835938,40.23804473876953,40.27245712280273,40.31193542480469,40.33624267578125,40.41526794433594,40.44769668579102,40.5322151184082,40.5816650390625,40.6947135925293,40.724365234375,40.74638366699219,40.74554443359375,40.81193542480469,40.99193572998047,41.03853607177734,41.0574951171875,41.15749359130859,41.24985504150391,41.34415435791016,41.39443969726562,41.42777252197266,41.46318435668945,41.51527404785156,41.68305206298828,41.75416564941406,41.81999206542969,41.84804916381836,41.86943817138672,41.94971466064453,41.99415588378906,41.99946594238281,42,42,42,42,42,42,42,42,42,42,42,42,42,42,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,42,42,42,42,42,42,42,42,42,42,42,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99964904785156,42,41.99943542480469,40.43305206298828,39.84943389892578,39.56610107421875,39.44971466064453,39.33332824707031,39.00721740722656,38.88276672363281,38.67276763916016,38.32054901123047,38.22609710693359,37.86527252197266,37.74638366699219,37.51416015625,37.40665435791016,37.28110504150391,37.16721343994141,37.05304718017578,36.93276977539062,36.81221008300781,36.70360565185547,36.58860015869141,36.46749114990234,36.24276733398438,36.10888671875,35.98081970214844,35.89499664306641,35.74221801757812,35.50277709960938,35.39804840087891,35.29332733154297,35.02165985107422,34.99214935302734,34.88193511962891,34.81666564941406,34.75833129882812,34.69860076904297,34.63166046142578,34.55082702636719,34.52193832397461,34.46415710449219,34.41582489013672,34.38999176025391,34.37276458740234,34.35867691040039,34.34276580810547,34.32332611083984,34.28804779052734,34.19624328613281,34.14665985107422,34.12568283081055,34.11429977416992,34.09207153320312,34.03013229370117,34.00124359130859,33.98721313476562,33.96152114868164,33.94415283203125,33.86888122558594,33.78305053710938,33.72193145751953,33.55929946899414,33.42033767700195,33.39916229248047,33.31888580322266,33.28054809570312,33.24638366699219,33.20901870727539,33.15541076660156,33.115478515625,33.08943557739258,33.06137847900391,33.04374313354492,33.02971267700195,33.03360748291016,33.03471755981445,33.02554702758789,32.97165679931641,32.86235046386719,32.73200607299805,32.72499084472656,32.72568511962891,32.73110198974609,32.74179840087891,32.74096298217773,32.71845626831055,32.71771240234375,32.70785140991211,32.69698715209961,32.68444061279297,32.66971588134766,32.65471649169922,32.63194274902344,32.60577011108398,32.58499908447266,32.568603515625,32.55221557617188,32.53665924072266,32.53533172607422]}],[{\"lng\":[-119.8680572509766,-119.6983337402344,-119.5936126708984,-119.5631866455078,-119.5527801513672,-119.5155639648438,-119.5329895019531,-119.5899963378906,-119.7133331298828,-119.7727813720703,-119.788330078125,-119.8369369506836,-119.8709716796875,-119.9177703857422,-119.9142303466797,-119.8680572509766],\"lat\":[34.08415985107422,34.04527282714844,34.05387878417969,34.06583023071289,34.06582641601562,34.04457855224609,34.01513290405273,33.99721527099609,33.97082138061523,33.96720886230469,33.96720886230469,33.97415924072266,33.99151992797852,34.06526947021484,34.0826301574707,34.08415985107422]}],[{\"lng\":[-120,-119.9694442749023,-119.9663925170898,-120.0365295410156,-120.1074981689453,-120.1216583251953,-120.1452789306641,-120.164436340332,-120.172233581543,-120.1922073364258,-120.2260971069336,-120.1847229003906,-120.135009765625,-120.0519409179688,-120.0352783203125,-120],\"lat\":[33.98963165283203,33.99235534667969,33.96249008178711,33.91915893554688,33.90554809570312,33.90804290771484,33.91666412353516,33.92777252197266,33.93471527099609,33.95943450927734,34.006103515625,34.01583099365234,34.02610015869141,34.03610992431641,34.02388000488281,33.98963165283203]}],[{\"lng\":[-118.5166625976562,-118.4452667236328,-118.4033432006836,-118.3497314453125,-118.297233581543,-118.2931213378906,-118.3037414550781,-118.4496459960938,-118.5899276733398,-118.5811233520508,-118.5418014526367,-118.5288925170898,-118.5166625976562],\"lat\":[33.47776794433594,33.44276428222656,33.42804718017578,33.39833068847656,33.34609985351562,33.32867431640625,33.30985260009766,33.32860565185547,33.48381042480469,33.49082946777344,33.48943710327148,33.48624420166016,33.47776794433594]}],[{\"lng\":[-118.5302886962891,-118.5261077880859,-118.5202789306641,-118.504997253418,-118.4822235107422,-118.413330078125,-118.3691635131836,-118.3694534301758,-118.4086074829102,-118.477783203125,-118.4869384765625,-118.4938812255859,-118.5338897705078,-118.570556640625,-118.5948638916016,-118.5938949584961,-118.5544281005859,-118.5302886962891],\"lat\":[32.99332427978516,32.98360443115234,32.97499084472656,32.959716796875,32.93804168701172,32.88555145263672,32.85471343994141,32.83277130126953,32.81707763671875,32.85277557373047,32.85888671875,32.86666107177734,32.92721557617188,32.98416137695312,33.03305053710938,33.04458236694336,33.04305267333984,32.99332427978516]}]]],null,\"Contorno\",{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":\"black\",\"weight\":2,\"opacity\":0.5,\"fill\":false,\"fillColor\":\"black\",\"fillOpacity\":0.2,\"smoothFactor\":1,\"noClip\":false},null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#D53E4F\",\"#FC8D59\",\"#FEE08B\",\"#E6F598\",\"#99D594\",\"#3288BD\"],\"labels\":[\"0 &ndash; 5\",\"5 &ndash; 10\",\"10 &ndash; 15\",\"15 &ndash; 20\",\"20 &ndash; 25\",\"25 &ndash; 30\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":0.5,\"position\":\"topright\",\"type\":\"bin\",\"title\":\"Varianza\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]},{\"method\":\"addLayersControl\",\"args\":[[],[\"Varianza de pred\",\"Contorno\"],{\"collapsed\":false,\"autoZIndex\":true,\"position\":\"topright\"}]}],\"limits\":{\"lat\":[32.07286193660753,42.40486193660753],\"lng\":[-124.8128902362941,-113.1326902362941]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n:::\n",
    "supporting": [
      "Geo_uni_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"site_libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/leaflet-1.3.1/leaflet.js\"></script>\n<link href=\"site_libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/proj4-2.6.2/proj4.min.js\"></script>\n<script src=\"site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\n<link href=\"site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/leaflet-binding-2.2.3/leaflet.js\"></script>\n<script src=\"site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js\"></script>\n<script src=\"site_libs/leaflet-providers-plugin-2.2.3/leaflet-providers-plugin.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}