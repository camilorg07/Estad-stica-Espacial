<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Luna Katerin Díaz Casallas">
<meta name="author" content="Camilo Alejandro Raba Gómez">

<title>Análisis geoestadístico del ozono y la temperatura en California durante marzo de 2024 – Estadística Espacial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-4f069c3b98e1a8e0aff111ff1630a9ed.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-4c8368da9f7a42b86f0f80dd84a36b62.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">

<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>

<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">

<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>

<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>

<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">

<script src="site_libs/leaflet-binding-2.2.3/leaflet.js"></script>

<script src="site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>

<script src="site_libs/leaflet-providers-plugin-2.2.3/leaflet-providers-plugin.js"></script>


  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Geo_uni.html">Análisis Geoestadístico</a></li><li class="breadcrumb-item"><a href="./Geo_uni.html">Análisis Univariado</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Estadística Espacial</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Alternar modo oscuro"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acerca de</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Análisis Geoestadístico</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Geo_uni.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Análisis Univariado</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción"><span class="header-section-number">1</span> Introducción</a></li>
  <li><a href="#descripción" id="toc-descripción" class="nav-link" data-scroll-target="#descripción"><span class="header-section-number">2</span> Descripción</a>
  <ul class="collapse">
  <li><a href="#unidades" id="toc-unidades" class="nav-link" data-scroll-target="#unidades"><span class="header-section-number">2.1</span> Unidades</a></li>
  </ul></li>
  <li><a href="#análisis-geoestadístico-univariado" id="toc-análisis-geoestadístico-univariado" class="nav-link" data-scroll-target="#análisis-geoestadístico-univariado"><span class="header-section-number">3</span> Análisis geoestadístico univariado</a>
  <ul class="collapse">
  <li><a href="#variable-temperatura" id="toc-variable-temperatura" class="nav-link" data-scroll-target="#variable-temperatura"><span class="header-section-number">3.1</span> Variable Temperatura</a>
  <ul class="collapse">
  <li><a href="#ajuste-del-modelo" id="toc-ajuste-del-modelo" class="nav-link" data-scroll-target="#ajuste-del-modelo"><span class="header-section-number">3.1.1</span> Ajuste del modelo</a></li>
  <li><a href="#estimación-empírica-del-semivariograma" id="toc-estimación-empírica-del-semivariograma" class="nav-link" data-scroll-target="#estimación-empírica-del-semivariograma"><span class="header-section-number">3.1.2</span> Estimación empírica del semivariograma</a></li>
  <li><a href="#estimación-del-modelo-teórico-de-semivariograma" id="toc-estimación-del-modelo-teórico-de-semivariograma" class="nav-link" data-scroll-target="#estimación-del-modelo-teórico-de-semivariograma"><span class="header-section-number">3.1.3</span> Estimación del Modelo Teórico de Semivariograma</a></li>
  <li><a href="#kriging" id="toc-kriging" class="nav-link" data-scroll-target="#kriging"><span class="header-section-number">3.1.4</span> Kriging</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Geo_uni.html">Análisis Geoestadístico</a></li><li class="breadcrumb-item"><a href="./Geo_uni.html">Análisis Univariado</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Análisis geoestadístico del ozono y la temperatura en California durante marzo de 2024</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Autores/as</div>
  <div class="quarto-title-meta-heading">Afiliación</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Luna Katerin Díaz Casallas <a href="mailto:ldiazca@unal.edu.co" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Departamento de Estadística - Universidad Nacional de Colombia
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Camilo Alejandro Raba Gómez <a href="mailto:craba@unal.edu.co" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">21 de octubre de 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introducción" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introducción</h1>
<p>La calidad del aire es un factor clave para la salud pública, el bienestar social y la sostenibilidad ambiental, y California se destaca como uno de los estados más afectados de Estados Unidos por la contaminación atmosférica. La combinación de una alta densidad poblacional, una intensa actividad industrial y vehicular, junto con fenómenos naturales como los incendios forestales, ha hecho que varias de sus ciudades se ubiquen entre las más contaminadas del país. Al mismo tiempo, la temperatura cumple un papel fundamental en la dinámica atmosférica, ya que influye en la dispersión, concentración y formación de contaminantes, además de constituir en sí misma un aspecto crítico para comprender las condiciones ambientales regionales. Frente a este contexto, resulta necesario llevar a cabo un análisis geoespacial que considere tanto la calidad del aire como la temperatura en California, con el fin de identificar patrones espaciales, contrastes regionales y áreas críticas que permitan orientar acciones de mitigación y gestión ambiental.</p>
</section>
<section id="descripción" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Descripción</h1>
<p>Los datos objeto de este estudio provienen de la <a href="https://www.epa.gov/">Agencia de Protección Ambiental (EPA)</a> de los Estados Unidos y corresponden a registros horarios obtenidos de las estaciones de monitoreo durante el mes de marzo de 2024. En partícular, se analizan las variables <strong>Temperatura</strong> y <strong>Ozono (</strong><span class="math inline">O_3</span><strong>)</strong>.</p>
<section id="unidades" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="unidades"><span class="header-section-number">2.1</span> Unidades</h2>
<ul>
<li><p><em>Temperatura:</em> Medido en grados celsius (C°) con una intensidad horaria.</p></li>
<li><p><em>Ozono:</em> Medido en partes por billón (ppb) con una intensidad horaria.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Librerias necesarias</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geoR)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stars)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Carga de datos</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>Cali_Marz <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"AirNow_Marzo_California.csv"</span>, <span class="at">colClasses =</span> <span class="fu">c</span>(<span class="st">"AQSID"</span><span class="ot">=</span><span class="st">"character"</span>))</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>Ozone <span class="ot">&lt;-</span> Cali_Marz <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Variable<span class="sc">==</span><span class="st">"OZONE"</span>) </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>NO2 <span class="ot">&lt;-</span> Cali_Marz <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Variable<span class="sc">==</span><span class="st">"NO2"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>Temp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Temperatura.csv"</span>, <span class="at">colClasses =</span> <span class="fu">c</span>(<span class="st">"AQSID"</span><span class="ot">=</span><span class="st">"character"</span>))</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>Ozone <span class="ot">&lt;-</span> Ozone <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">DateTime =</span> <span class="fu">paste</span>(Date, Hour, <span class="at">sep =</span> <span class="st">" "</span>))</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>NO2 <span class="ot">&lt;-</span> NO2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">DateTime =</span> <span class="fu">paste</span>(Date, Hour, <span class="at">sep =</span> <span class="st">" "</span>))</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>Temp <span class="ot">&lt;-</span> Temp[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Para el mapa de California</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>sh_mundos<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="st">"admin00.shp"</span>,<span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>sh_mundos <span class="ot">&lt;-</span> sh_mundos <span class="sc">%&gt;%</span> <span class="fu">filter</span>(CNTRY_NAME<span class="sc">==</span><span class="st">"United States"</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>sh_mundos <span class="ot">&lt;-</span> sh_mundos <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ADMIN_NAME<span class="sc">==</span><span class="st">"California"</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Datos de las estaciones</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"HourlyAQObs_2024010101.dat"</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(CountryCode<span class="sc">==</span><span class="st">"US"</span>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(StateName<span class="sc">==</span><span class="st">"CA"</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>CRS_UTM_NY <span class="ot">=</span> <span class="st">"+init=epsg:3310"</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>Ozone_Matrix <span class="ot">&lt;-</span> Ozone <span class="sc">%&gt;%</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(DateTime, AQSID, Value) <span class="sc">%&gt;%</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> AQSID, <span class="at">values_from =</span> Value) </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>Temp_Matrix <span class="ot">&lt;-</span> Temp <span class="sc">%&gt;%</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(DateTime, AQSID, Value) <span class="sc">%&gt;%</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> AQSID, <span class="at">values_from =</span> Value) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="análisis-geoestadístico-univariado" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Análisis geoestadístico univariado</h1>
<section id="variable-temperatura" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="variable-temperatura"><span class="header-section-number">3.1</span> Variable Temperatura</h2>
<p>Se tomaron los datos de Temperatura de la madrugada el primero de marzo de 2024:</p>
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>EstacionesT <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(AQSID <span class="sc">%in%</span> <span class="fu">colnames</span>(Temp_Matrix)[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>EstacionesT <span class="ot">&lt;-</span> EstacionesT[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">13</span>)]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>est_sf_T <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(EstacionesT, </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"Longitude"</span>, <span class="st">"Latitude"</span>), </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>est_sf_utm_T <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(est_sf_T, <span class="at">crs =</span> <span class="dv">3310</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>deci_coord_T <span class="ot">=</span> <span class="fu">SpatialPoints</span>(<span class="fu">cbind</span>(EstacionesT<span class="sc">$</span>Longitude,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                                 EstacionesT<span class="sc">$</span>Latitude),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">proj4string =</span> <span class="fu">CRS</span>(<span class="st">"+proj=longlat"</span>))</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>utm_coord_T <span class="ot">=</span> <span class="fu">spTransform</span>(deci_coord_T, <span class="fu">CRS</span>(<span class="st">"EPSG:3310"</span>))</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>utm_coord_df_T <span class="ot">=</span> <span class="fu">as.data.frame</span>(utm_coord_T)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>EstacionesT<span class="sc">$</span>x <span class="ot">&lt;-</span> utm_coord_df_T<span class="sc">$</span>coords.x1</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>EstacionesT<span class="sc">$</span>y <span class="ot">&lt;-</span> utm_coord_df_T<span class="sc">$</span>coords.x2</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>y_T <span class="ot">&lt;-</span> Temp_Matrix[<span class="dv">1</span>,] <span class="co">#Tomar una fecha</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>y_T <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">colnames</span>(y_T),<span class="fu">t</span>(y_T[<span class="dv">1</span>,]))</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>y_T <span class="ot">&lt;-</span> y_T[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>y_T <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y_T)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>y_T <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(y_T)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>y_T <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(y_T, EstacionesT, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"V1"</span><span class="ot">=</span><span class="st">"AQSID"</span>))</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>datosT <span class="ot">&lt;-</span> y_T[,<span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">2</span>)] <span class="co">#Datos1 es la base con coordenadas + variable</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(datosT)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Este"</span>,<span class="st">"Norte"</span>,<span class="st">"Temperatura"</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>datosT <span class="ot">&lt;-</span> datosT[<span class="sc">-</span><span class="fu">which.min</span>(datosT<span class="sc">$</span>Temperatura),]</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>datosT<span class="sc">$</span>Temperatura <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(datosT<span class="sc">$</span>Temperatura)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co">#Para el mapa</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>coords_3310 <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(est_sf_utm_T)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>est_sf_utm_T<span class="sc">$</span>Este <span class="ot">&lt;-</span> coords_3310[, <span class="st">"X"</span>]</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>est_sf_utm_T<span class="sc">$</span>Norte <span class="ot">&lt;-</span> coords_3310[, <span class="st">"Y"</span>]</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Crear el objeto final de datos (combinando temperatura con las coordenadas UTM)</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>datosT_sf_utm <span class="ot">&lt;-</span> <span class="fu">merge</span>(est_sf_utm_T, y_T[, <span class="fu">c</span>(<span class="st">"V1"</span>, <span class="st">"V2"</span>)], <span class="at">by.x =</span> <span class="st">"AQSID"</span>, <span class="at">by.y =</span> <span class="st">"V1"</span>)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>datosT_sf_utm<span class="sc">$</span>Temperatura <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(datosT_sf_utm<span class="sc">$</span>V2)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>datosT_sf_wgs84 <span class="ot">&lt;-</span> <span class="fu">merge</span>(est_sf_T, y_T[, <span class="fu">c</span>(<span class="st">"V1"</span>, <span class="st">"V2"</span>)], <span class="at">by.x =</span> <span class="st">"AQSID"</span>, <span class="at">by.y =</span> <span class="st">"V1"</span>)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>datosT_sf_wgs84<span class="sc">$</span>Temperatura <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(datosT_sf_wgs84<span class="sc">$</span>V2)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>sh_mundos_wgs84 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(sh_mundos, <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">colorNumeric</span>(<span class="at">palette =</span> <span class="st">"viridis"</span>, <span class="at">domain =</span> datosT_sf_wgs84<span class="sc">$</span>Temperatura)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>CartoDB.Positron) <span class="sc">%&gt;%</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Contorno de California</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>(<span class="at">data =</span> sh_mundos_wgs84, <span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">weight =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Puntos de temperatura</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">data =</span> datosT_sf_wgs84,</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fillColor =</span> <span class="sc">~</span><span class="fu">pal</span>(Temperatura),</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fillOpacity =</span> <span class="fl">0.8</span>,</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>                   <span class="at">weight =</span> <span class="dv">1</span>,</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>                   <span class="at">radius =</span> <span class="dv">6</span>,</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>                   <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"Temp:"</span>, Temperatura, <span class="st">"°C"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(<span class="at">pal =</span> pal, <span class="at">values =</span> datosT_sf_wgs84<span class="sc">$</span>Temperatura, <span class="at">title =</span> <span class="st">"Temperatura (°C)"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-59bd34b927f04b067067" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-59bd34b927f04b067067">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addPolygons","args":[[[[{"lng":[-117.1223754882812,-117.1333312988281,-117.1827087402344,-117.2129135131836,-117.2123794555664,-117.2005081176758,-117.1740798950195,-117.1472244262695,-117.1156234741211,-117.1166534423828,-117.1413879394531,-117.2021560668945,-117.2288131713867,-117.2405471801758,-117.2420425415039,-117.2549896240234,-117.2684783935547,-117.26611328125,-117.2587661743164,-117.2803421020508,-117.2529220581055,-117.2490615844727,-117.25,-117.2698593139648,-117.3197326660156,-117.3294525146484,-117.3402862548828,-117.4094390869141,-117.480827331543,-117.495002746582,-117.6319427490234,-117.6725006103516,-117.7744369506836,-117.8638916015625,-117.8840179443359,-117.9108276367188,-117.9361114501953,-117.9550018310547,-117.9736175537109,-117.9949951171875,-118.0270843505859,-118.0452728271484,-118.0830688476562,-118.1081848144531,-118.1347427368164,-118.2222213745117,-118.2671279907227,-118.272087097168,-118.2977752685547,-118.3180694580078,-118.400016784668,-118.4174652099609,-118.3986206054688,-118.3861846923828,-118.4211044311523,-118.432502746582,-118.4544525146484,-118.4711227416992,-118.508903503418,-118.5300064086914,-118.554443359375,-118.6549987792969,-118.6977691650391,-118.7525024414062,-118.7811126708984,-118.8364028930664,-118.9361114501953,-118.9614028930664,-118.9811096191406,-119.1291732788086,-119.1743011474609,-119.2196502685547,-119.2558441162109,-119.3124694824219,-119.4161071777344,-119.446662902832,-119.5416717529297,-119.5772171020508,-119.5997314453125,-119.6247100830078,-119.7986068725586,-120.0037460327148,-120.1308288574219,-120.245002746582,-120.3550033569336,-120.4241561889648,-120.4490280151367,-120.4819412231445,-120.4953460693359,-120.5583267211914,-120.5831909179688,-120.605827331543,-120.6259613037109,-120.6283264160156,-120.623893737793,-120.6033248901367,-120.5941696166992,-120.5913772583008,-120.5980606079102,-120.6247100830078,-120.6137466430664,-120.6000671386719,-120.6181945800781,-120.6805572509766,-120.7186813354492,-120.7385330200195,-120.8313903808594,-120.8567962646484,-120.8697280883789,-120.8681945800781,-120.8591613769531,-120.8411102294922,-120.9199981689453,-120.9770812988281,-120.9994506835938,-121.0477752685547,-121.1666564941406,-121.2687530517578,-121.29638671875,-121.3215408325195,-121.3680572509766,-121.4349899291992,-121.4418029785156,-121.4609680175781,-121.4720840454102,-121.6654205322266,-121.7580642700195,-121.7961044311523,-121.8676300048828,-121.8641662597656,-121.8734664916992,-121.8847427368164,-121.8976440429688,-121.9216613769531,-121.9432525634766,-121.8997955322266,-121.8656158447266,-121.8450012207031,-121.8255615234375,-121.8091506958008,-121.7993087768555,-121.7747192382812,-121.7639007568359,-121.7991638183594,-121.8511123657227,-121.8791656494141,-121.9135971069336,-121.9783325195312,-122.0202865600586,-122.0415191650391,-122.0709762573242,-122.1472320556641,-122.1795806884766,-122.379020690918,-122.3883438110352,-122.393684387207,-122.3844528198242,-122.3731918334961,-122.378044128418,-122.4259719848633,-122.4433288574219,-122.4806137084961,-122.4902801513672,-122.4958267211914,-122.4994430541992,-122.4905471801758,-122.4843063354492,-122.4481201171875,-122.379638671875,-122.359992980957,-122.3513870239258,-122.35693359375,-122.3673553466797,-122.3577728271484,-122.0643005371094,-122.0231857299805,-122.0058364868164,-122.0297164916992,-122.0808334350586,-122.1259689331055,-122.1308288574219,-122.1384811401367,-122.1572265625,-122.1747131347656,-122.2427673339844,-122.2999877929688,-122.3934097290039,-122.352783203125,-122.2252731323242,-122.1633224487305,-122.1277313232422,-122.0158386230469,-121.9894409179688,-121.9155578613281,-121.8572235107422,-121.8337554931641,-121.6848526000977,-121.6541976928711,-121.6434936523438,-121.5911102294922,-121.498046875,-121.4272155761719,-121.4705505371094,-121.5531921386719,-121.5850067138672,-121.6622161865234,-121.6852188110352,-121.7229156494141,-121.8186798095703,-121.9052734375,-121.977783203125,-122.0186233520508,-122.0500030517578,-122.109733581543,-122.2641830444336,-122.2920837402344,-122.311393737793,-122.3652801513672,-122.3908386230469,-122.4783248901367,-122.479866027832,-122.4433288574219,-122.4201354980469,-122.456672668457,-122.505485534668,-122.6566619873047,-122.7822875976562,-122.8169631958008,-122.8966674804688,-122.9283294677734,-122.9563903808594,-122.9269409179688,-122.8399963378906,-122.8030471801758,-122.8077697753906,-122.83056640625,-122.9586181640625,-123.1072235107422,-123.1290283203125,-123.1716613769531,-123.2372131347656,-123.2666625976562,-123.3130645751953,-123.3530578613281,-123.4475021362305,-123.5361175537109,-123.620002746582,-123.7015228271484,-123.7072601318359,-123.6745834350586,-123.6669387817383,-123.6861038208008,-123.712646484375,-123.7541809082031,-123.7957000732422,-123.7956924438477,-123.774169921875,-123.7630615234375,-123.7368698120117,-123.7723617553711,-123.8202819824219,-123.8674926757812,-123.9311065673828,-124.0623550415039,-124.0927734375,-124.1525726318359,-124.2022171020508,-124.297233581543,-124.331184387207,-124.3240356445312,-124.3233413696289,-124.3543090820312,-124.3758239746094,-124.3523559570312,-124.3319473266602,-124.2750091552734,-124.2529144287109,-124.2294464111328,-124.1994323730469,-124.14306640625,-124.0988922119141,-124.0993041992188,-124.1125030517578,-124.1222229003906,-124.0909729003906,-124.061393737793,-124.0458374023438,-124.0399932861328,-124.0467987060547,-124.063606262207,-124.1186065673828,-124.1813812255859,-124.2155609130859,-124.1973571777344,-124.1902770996094,-124.1752777099609,-124.1841583251953,-124.1858520507812,-123.9505615234375,-123.883903503418,-123.5336227416992,-123.4836120605469,-123.4169464111328,-123.366943359375,-123.3169631958008,-123.2669525146484,-123.2169494628906,-123.1669464111328,-123.116943359375,-123.0669631958008,-122.8999862670898,-122.8177795410156,-122.7508392333984,-122.6341705322266,-122.600830078125,-122.5175018310547,-122.2172164916992,-122.1505584716797,-122.1172180175781,-122.0005569458008,-121.9669494628906,-121.8836212158203,-121.8002777099609,-121.7169494628906,-121.6677703857422,-121.5341567993164,-121.4841613769531,-121.4341583251953,-121.3008270263672,-121.1838836669922,-121.133903503418,-121.0672302246094,-120.9169464111328,-120.8510971069336,-120.7677764892578,-120.6841583251953,-120.3208236694336,-120.0341567993164,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.001106262207,-119.8197326660156,-119.5155563354492,-119.0130615234375,-118.8799896240234,-118.3752670288086,-118.2108306884766,-117.8919525146484,-117.7452697753906,-117.5747222900391,-117.4211120605469,-117.2677764892578,-117.1069488525391,-116.946662902832,-116.8027801513672,-116.6513977050781,-116.4924926757812,-116.1999969482422,-116.0269470214844,-115.8622131347656,-115.7527923583984,-115.5580368041992,-115.2555694580078,-115.1241607666016,-114.9933319091797,-114.6563873291016,-114.6219329833984,-114.6197128295898,-114.5563812255859,-114.4933319091797,-114.4561233520508,-114.4188766479492,-114.3781890869141,-114.3695068359375,-114.3358306884766,-114.2726440429688,-114.230827331543,-114.2005615234375,-114.1700668334961,-114.1516723632812,-114.1344528198242,-114.1170120239258,-114.2226409912109,-114.3141632080078,-114.3576278686523,-114.3834762573242,-114.4070892333984,-114.4207611083984,-114.4554061889648,-114.4755630493164,-114.5127868652344,-114.5233306884766,-114.510009765625,-114.4941635131836,-114.48388671875,-114.5275039672852,-114.6404876708984,-114.7255630493164,-114.7260971069336,-114.7038879394531,-114.6836090087891,-114.6681900024414,-114.6752777099609,-114.6965179443359,-114.6970748901367,-114.6788787841797,-114.6626281738281,-114.6029205322266,-114.5701370239258,-114.5452728271484,-114.5153503417969,-114.4644470214844,-114.4587478637695,-114.5352096557617,-114.5541687011719,-114.5844497680664,-114.6125030517578,-114.6526412963867,-114.6955490112305,-114.7190933227539,-114.7297973632812,-114.8713455200195,-115.0258941650391,-115.2024993896484,-115.404167175293,-115.6055603027344,-115.9077835083008,-116.2426376342773,-116.5081481933594,-116.7130584716797,-116.9141693115234,-117.0952911376953,-117.1223754882812],"lat":[32.53533172607422,32.56582641601562,32.65929412841797,32.68302917480469,32.69705581665039,32.69759368896484,32.6749382019043,32.61860275268555,32.62131118774414,32.64249420166016,32.68061447143555,32.72769546508789,32.71561431884766,32.68464279174805,32.66253280639648,32.65713882446289,32.68842315673828,32.70860290527344,32.77041625976562,32.82921600341797,32.86082458496094,32.87129211425781,32.88971710205078,32.97707366943359,33.10527038574219,33.12443542480469,33.14166259765625,33.24415588378906,33.32749176025391,33.34221649169922,33.44276428222656,33.47054290771484,33.53943634033203,33.59568405151367,33.60055160522461,33.60665893554688,33.62054443359375,33.63276672363281,33.64554595947266,33.66249084472656,33.69401931762695,33.70943450927734,33.73971557617188,33.75693893432617,33.76666259765625,33.78416442871094,33.75777435302734,33.72332000732422,33.71610260009766,33.7208251953125,33.74985504150391,33.78179931640625,33.80804443359375,33.84096527099609,33.92124557495117,33.93915557861328,33.96776580810547,33.98777008056641,34.03110504150391,34.04791259765625,34.05568695068359,34.0494384765625,34.04610443115234,34.03971862792969,34.03318786621094,34.03054809570312,34.05554962158203,34.06221008300781,34.06749725341797,34.11388397216797,34.1361083984375,34.16492080688477,34.22346115112305,34.28351593017578,34.35749816894531,34.37332153320312,34.41415405273438,34.42054748535156,34.42360687255859,34.42471313476562,34.42638397216797,34.4679069519043,34.47873687744141,34.47360229492188,34.46582794189453,34.45610046386719,34.4556884765625,34.50957489013672,34.53047561645508,34.56193542480469,34.56221389770508,34.55860137939453,34.58443832397461,34.62360382080078,34.64110565185547,34.66943740844727,34.69026947021484,34.71082305908203,34.8608283996582,34.89499664306641,35.01860427856445,35.10005950927734,35.13943862915039,35.17110443115234,35.18054580688477,35.16464233398438,35.20999145507812,35.22880935668945,35.25722122192383,35.27999496459961,35.3074951171875,35.35527038574219,35.44887542724609,35.46596145629883,35.47915649414062,35.52499008178711,35.64916229248047,35.70013046264648,35.76610565185547,35.79402542114258,35.82916259765625,35.8942985534668,35.92804718017578,35.97943496704102,35.99777221679688,36.18304443359375,36.22943496704102,36.24110412597656,36.31533813476562,36.3429069519043,36.39388656616211,36.43387603759766,36.46735382080078,36.51805114746094,36.59457397460938,36.64124298095703,36.61985397338867,36.61513137817383,36.6270751953125,36.64846420288086,36.66790771484375,36.75916290283203,36.81249237060547,36.88401794433594,36.95068740844727,36.97248840332031,36.9803352355957,36.96915435791016,36.95485305786133,36.95415878295898,36.96235275268555,36.99582672119141,37.01763153076172,37.19998931884766,37.22026824951172,37.25186538696289,37.28971862792969,37.32915878295898,37.37443542480469,37.48429489135742,37.50436782836914,37.5122184753418,37.52999114990234,37.56610107421875,37.58998870849609,37.75222015380859,37.78992462158203,37.81005859375,37.81381225585938,37.78693771362305,37.73165893554688,37.68762969970703,37.65443420410156,37.61582565307617,37.45929718017578,37.45790863037109,37.47137451171875,37.47943115234375,37.51027297973633,37.6027717590332,37.6322135925293,37.66221618652344,37.69470977783203,37.71471405029297,37.76666259765625,37.82638549804688,37.95915985107422,37.99082946777344,38.06415939331055,38.04743576049805,38.03526306152344,38.06610107421875,38.06554412841797,38.05416107177734,38.04305267333984,38.03666305541992,38.01811599731445,38.04861831665039,38.0789909362793,38.10464859008789,38.04888153076172,38.01290893554688,38.05499267578125,38.11041259765625,38.11568832397461,38.09658813476562,38.06646728515625,38.04746627807617,38.08115386962891,38.06610107421875,38.09721374511719,38.14811325073242,38.10877990722656,38.06137847900391,38.10999298095703,38.12693405151367,38.1361083984375,38.15554809570312,38.14749145507812,38.11957168579102,37.9366569519043,37.90693664550781,37.88318634033203,37.83346557617188,37.83103942871094,37.91054534912109,38.00131607055664,38.02027130126953,38.05443572998047,38.05360412597656,38.05804443359375,38.16249084472656,38.10777282714844,38.08193969726562,38.09498977661133,38.12748718261719,38.28527069091797,38.46277236938477,38.47290802001953,38.49193572998047,38.52276611328125,38.54083251953125,38.57388305664062,38.62443542480469,38.7340202331543,38.79610443115234,38.86082458496094,38.93041229248047,38.97109985351562,39.00458145141602,39.02554702758789,39.1219367980957,39.17804718017578,39.25943756103516,39.35332489013672,39.38582611083984,39.49652099609375,39.51915740966797,39.55499267578125,39.70971298217773,39.79166412353516,39.86915588378906,39.94971466064453,40.09165954589844,40.11631011962891,40.14790725708008,40.17416381835938,40.23804473876953,40.27245712280273,40.31193542480469,40.33624267578125,40.41526794433594,40.44769668579102,40.5322151184082,40.5816650390625,40.6947135925293,40.724365234375,40.74638366699219,40.74554443359375,40.81193542480469,40.99193572998047,41.03853607177734,41.0574951171875,41.15749359130859,41.24985504150391,41.34415435791016,41.39443969726562,41.42777252197266,41.46318435668945,41.51527404785156,41.68305206298828,41.75416564941406,41.81999206542969,41.84804916381836,41.86943817138672,41.94971466064453,41.99415588378906,41.99946594238281,42,42,42,42,42,42,42,42,42,42,42,42,42,42,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,42,42,42,42,42,42,42,42,42,42,42,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99964904785156,42,41.99943542480469,40.43305206298828,39.84943389892578,39.56610107421875,39.44971466064453,39.33332824707031,39.00721740722656,38.88276672363281,38.67276763916016,38.32054901123047,38.22609710693359,37.86527252197266,37.74638366699219,37.51416015625,37.40665435791016,37.28110504150391,37.16721343994141,37.05304718017578,36.93276977539062,36.81221008300781,36.70360565185547,36.58860015869141,36.46749114990234,36.24276733398438,36.10888671875,35.98081970214844,35.89499664306641,35.74221801757812,35.50277709960938,35.39804840087891,35.29332733154297,35.02165985107422,34.99214935302734,34.88193511962891,34.81666564941406,34.75833129882812,34.69860076904297,34.63166046142578,34.55082702636719,34.52193832397461,34.46415710449219,34.41582489013672,34.38999176025391,34.37276458740234,34.35867691040039,34.34276580810547,34.32332611083984,34.28804779052734,34.19624328613281,34.14665985107422,34.12568283081055,34.11429977416992,34.09207153320312,34.03013229370117,34.00124359130859,33.98721313476562,33.96152114868164,33.94415283203125,33.86888122558594,33.78305053710938,33.72193145751953,33.55929946899414,33.42033767700195,33.39916229248047,33.31888580322266,33.28054809570312,33.24638366699219,33.20901870727539,33.15541076660156,33.115478515625,33.08943557739258,33.06137847900391,33.04374313354492,33.02971267700195,33.03360748291016,33.03471755981445,33.02554702758789,32.97165679931641,32.86235046386719,32.73200607299805,32.72499084472656,32.72568511962891,32.73110198974609,32.74179840087891,32.74096298217773,32.71845626831055,32.71771240234375,32.70785140991211,32.69698715209961,32.68444061279297,32.66971588134766,32.65471649169922,32.63194274902344,32.60577011108398,32.58499908447266,32.568603515625,32.55221557617188,32.53665924072266,32.53533172607422]}],[{"lng":[-119.8680572509766,-119.6983337402344,-119.5936126708984,-119.5631866455078,-119.5527801513672,-119.5155639648438,-119.5329895019531,-119.5899963378906,-119.7133331298828,-119.7727813720703,-119.788330078125,-119.8369369506836,-119.8709716796875,-119.9177703857422,-119.9142303466797,-119.8680572509766],"lat":[34.08415985107422,34.04527282714844,34.05387878417969,34.06583023071289,34.06582641601562,34.04457855224609,34.01513290405273,33.99721527099609,33.97082138061523,33.96720886230469,33.96720886230469,33.97415924072266,33.99151992797852,34.06526947021484,34.0826301574707,34.08415985107422]}],[{"lng":[-120,-119.9694442749023,-119.9663925170898,-120.0365295410156,-120.1074981689453,-120.1216583251953,-120.1452789306641,-120.164436340332,-120.172233581543,-120.1922073364258,-120.2260971069336,-120.1847229003906,-120.135009765625,-120.0519409179688,-120.0352783203125,-120],"lat":[33.98963165283203,33.99235534667969,33.96249008178711,33.91915893554688,33.90554809570312,33.90804290771484,33.91666412353516,33.92777252197266,33.93471527099609,33.95943450927734,34.006103515625,34.01583099365234,34.02610015869141,34.03610992431641,34.02388000488281,33.98963165283203]}],[{"lng":[-118.5166625976562,-118.4452667236328,-118.4033432006836,-118.3497314453125,-118.297233581543,-118.2931213378906,-118.3037414550781,-118.4496459960938,-118.5899276733398,-118.5811233520508,-118.5418014526367,-118.5288925170898,-118.5166625976562],"lat":[33.47776794433594,33.44276428222656,33.42804718017578,33.39833068847656,33.34609985351562,33.32867431640625,33.30985260009766,33.32860565185547,33.48381042480469,33.49082946777344,33.48943710327148,33.48624420166016,33.47776794433594]}],[{"lng":[-118.5302886962891,-118.5261077880859,-118.5202789306641,-118.504997253418,-118.4822235107422,-118.413330078125,-118.3691635131836,-118.3694534301758,-118.4086074829102,-118.477783203125,-118.4869384765625,-118.4938812255859,-118.5338897705078,-118.570556640625,-118.5948638916016,-118.5938949584961,-118.5544281005859,-118.5302886962891],"lat":[32.99332427978516,32.98360443115234,32.97499084472656,32.959716796875,32.93804168701172,32.88555145263672,32.85471343994141,32.83277130126953,32.81707763671875,32.85277557373047,32.85888671875,32.86666107177734,32.92721557617188,32.98416137695312,33.03305053710938,33.04458236694336,33.04305267333984,32.99332427978516]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"black","weight":2,"opacity":0.5,"fill":false,"fillColor":"black","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[[38.342606,38.690757,39.76168,39.32756,38.20185,39.18919,38.94498,36.7056,36.78538,36.8414,36.6324,36.71088,36.5975,36.819199,39.53387,37.360701,36.3261,36.3663,36.3619,36.5432,36.4581,36.5092,36.4878,36.5975,37.3667,37.0056,35.345607,35.0544,35.356615,35.438035,34.8416,35.3313,35.23918,36.102219,36.3144,34.1439,34.051097,34.066429,34.1992,33.9014,34.010283,34.13263,33.859662,34.3833,36.8669,36.9533,37.713299,39.150478,39.145733,39.43734,37.645718,37.962069,38.0697,36.48187,36.209286,36.694261,39.234402,39.3386,33.830586,33.819305,33.925062,38.74643,39.9395,40.301899,39.8134,33.7472,33.920758,33.583099,33.572019,33.852605,33.999449,33.996387,33.676535,38.613804,38.56844,38.302591,38.683304,38.593328,36.843425,36.485001,34.894054,34.243132,34.068114,34.0309,34.510955,35.774455,34.100132,34.416506,34.059626,34.0714,34.106678,37.8027,37.6825,35.614668,34.42775,34.7256,34.5414,34.402802,34.4897,34.637798,34.445301,36.98332,37.06315,40.5403,37.642165,37.4883,39.13868,36.489399,36.0319,34.21017,34.40428,34.44806,34.27632,34.25239,38.53455,36.280596,36.607215,35.04944,33.793713,34.181977,39.39861,36.841488,32.72519],[-120.764426,-120.072682,-121.84047,-121.66881,-120.680277,-121.99887,-119.97061,-119.7414,-119.77321,-119.8744,-120.3822,-119.77743,-119.5036,-119.7164,-122.190834,-118.330835,-117.9551,-117.8976,-118.0108,-117.9418,-117.8519,-116.8481,-117.871,-118.04,-118.4167,-118.2936,-118.851825,-119.4039,-119.062613,-119.016787,-118.8647,-119,-118.78863,-119.566002,-119.6436,-117.8508,-118.456386,-118.226755,-118.5331,-118.205,-118.068484,-118.127142,-118.200707,-118.5283,-120.01,-120.0341,-119.7061,-123.206528,-123.202995,-123.78766,-118.966515,-119.120278,-118.9477,-121.73333,-121.126371,-121.623271,-121.055603,-120.170303,-117.938509,-117.918759,-117.952586,-121.26498,-120.9443,-121.235001,-120.4707,-115.8201,-116.858419,-117.072197,-116.063823,-116.540965,-117.415831,-117.4925,-117.331027,-121.368007,-121.49311,-121.420838,-121.164457,-121.503728,-121.3621,-121.155602,-117.024756,-117.272275,-117.525796,-117.617403,-117.32555,-117.372109,-117.491982,-117.285602,-117.147347,-116.3906,-117.274063,-121.2208,-121.4406,-120.656912,-119.69091,-120.4278,-119.7906,-119.457497,-120.0458,-120.456703,-119.827797,-121.98822,-122.083092,-121.5764,-120.994212,-120.8358,-121.61884,-118.826897,-119.055,-118.87051,-118.80998,-119.2313,-118.68369,-119.14318,-121.7734,-118.011661,-118.05473,-118.18893,-118.171019,-118.363036,-123.35872,-121.533444,-116.36441],6,null,null,{"interactive":true,"className":"","stroke":true,"color":"black","weight":1,"opacity":0.5,"fill":true,"fillColor":["#98D83E","#30B57B","#9DD93B","#92D742","#9CD93B","#9CD93B","#3FBC73","#CAE11F","#D0E11C","#CAE11F","#C0DF25","#D9E319","#C6E021","#C8E020","#A3DA37","#B8DE29","#BCDF26","#BCDF26","#B8DE29","#C5E021","#BADE28","#FDE725","#BADE28","#C5E021","#ACDC31","#440154","#CAE11F","#C7E020","#D8E219","#CAE11F","#86D549","#D5E21A","#D0E11C","#C2DF23","#C9E020","#B1DD2E","#B1DD2E","#B4DE2C","#B2DD2D","#B4DE2C","#BBDE27","#ACDC31","#BEDF26","#A5DB36","#C6E021","#C9E020","#5DC863","#8AD547","#8ED645","#8CD646","#3EBC73","#57C666","#5BC864","#ABDC31","#ADDC30","#BEDF26","#66CB5D","#3ABA76","#B9DE29","#C3DF22","#C2DF23","#9CD93C","#69CD5B","#54C568","#53C568","#BADE28","#A6DB35","#B1DD2E","#FDE725","#DBE319","#C0DF25","#BEDF26","#B2DD2D","#A4DB36","#A6DB35","#ACDC31","#99D83D","#A3DA37","#A8DB34","#9DD93B","#BCDF26","#65CB5E","#BBDE27","#C0DF25","#94D741","#E0E318","#BADE28","#8FD744","#B3DD2C","#89D548","#BEDF26","#B7DE2A","#C1DF24","#99D83D","#B2DD2D","#A6DB35","#9AD93D","#A1DA38","#95D840","#BDDF26","#B8DE29","#96D83F","#2AB07F","#65CB5E","#B6DE2A","#AFDD2F","#95D840","#AFDD2F","#C9E020","#9ED93A","#A6DB35","#A1DA38","#9DD93B","#B3DD2C","#9CD93C","#B3DD2C","#C5E021","#A1DA38","#BADE28","#AFDD2F","#66CB5D","#B2DD2D","#76D153"],"fillOpacity":0.8},null,null,["Temp: 12.9 °C","Temp: -1.8 °C","Temp: 13.5 °C","Temp: 12.2 °C","Temp: 13.4 °C","Temp: 13.4 °C","Temp: 1 °C","Temp: 18.5 °C","Temp: 19.1 °C","Temp: 18.6 °C","Temp: 17.4 °C","Temp: 20.2 °C","Temp: 18.1 °C","Temp: 18.3 °C","Temp: 14.2 °C","Temp: 16.5 °C","Temp: 17 °C","Temp: 17 °C","Temp: 16.5 °C","Temp: 18 °C","Temp: 16.7 °C","Temp: 24.5 °C","Temp: 16.8 °C","Temp: 18 °C","Temp: 15.2 °C","Temp: -51.3 °C","Temp: 18.6 °C","Temp: 18.2 °C","Temp: 20 °C","Temp: 18.5 °C","Temp: 10.8 °C","Temp: 19.7 °C","Temp: 19.2 °C","Temp: 17.6 °C","Temp: 18.4 °C","Temp: 15.7 °C","Temp: 15.8 °C","Temp: 16.1 °C","Temp: 15.9 °C","Temp: 16.1 °C","Temp: 16.9 °C","Temp: 15.2 °C","Temp: 17.2 °C","Temp: 14.4 °C","Temp: 18.1 °C","Temp: 18.4 °C","Temp: 5.6 °C","Temp: 11.2 °C","Temp: 11.7 °C","Temp: 11.5 °C","Temp: 0.9 °C","Temp: 4.7 °C","Temp: 5.3 °C","Temp: 15.1 °C","Temp: 15.3 °C","Temp: 17.2 °C","Temp: 6.8 °C","Temp: 0.1 °C","Temp: 16.6 °C","Temp: 17.8 °C","Temp: 17.6 °C","Temp: 13.3 °C","Temp: 7.2 °C","Temp: 4.3 °C","Temp: 4.2 °C","Temp: 16.7 °C","Temp: 14.5 °C","Temp: 15.8 °C","Temp: 24.5 °C","Temp: 20.4 °C","Temp: 17.4 °C","Temp: 17.2 °C","Temp: 15.9 °C","Temp: 14.3 °C","Temp: 14.5 °C","Temp: 15.2 °C","Temp: 13 °C","Temp: 14.2 °C","Temp: 14.7 °C","Temp: 13.5 °C","Temp: 17 °C","Temp: 6.7 °C","Temp: 16.9 °C","Temp: 17.4 °C","Temp: 12.4 °C","Temp: 21 °C","Temp: 16.8 °C","Temp: 11.9 °C","Temp: 16 °C","Temp: 11.1 °C","Temp: 17.2 °C","Temp: 16.4 °C","Temp: 17.5 °C","Temp: 13 °C","Temp: 15.9 °C","Temp: 14.5 °C","Temp: 13.1 °C","Temp: 14 °C","Temp: 12.6 °C","Temp: 17.1 °C","Temp: 16.5 °C","Temp: 12.7 °C","Temp: -3.2 °C","Temp: 6.7 °C","Temp: 16.3 °C","Temp: 15.5 °C","Temp: 12.6 °C","Temp: 15.5 °C","Temp: 18.4 °C","Temp: 13.6 °C","Temp: 14.5 °C","Temp: 14 °C","Temp: 13.5 °C","Temp: 16 °C","Temp: 13.3 °C","Temp: 16 °C","Temp: 18 °C","Temp: 13.9 °C","Temp: 16.7 °C","Temp: 15.5 °C","Temp: 6.8 °C","Temp: 15.9 °C","Temp: 8.9 °C"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#440154 , #46075B 1.71503957783641%, #463480 14.9076517150396%, #375B8D 28.1002638522427%, #297B8E 41.2928759894459%, #1E9B8A 54.4854881266491%, #39BA76 67.6781002638522%, #7FD34E 80.8707124010554%, #D8E219 94.0633245382586%, #FDE725 "],"labels":["-50","-40","-30","-20","-10","0","10","20"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topright","type":"numeric","title":"Temperatura (°C)","extra":{"p_1":0.01715039577836408,"p_n":0.9406332453825857},"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[32.53533172607422,42],"lng":[-124.3758239746094,-114.1170120239258]}},"evals":[],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">as.geodata</span>(datosT) </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(temp)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Number of data points: 122 

Coordinates summary
         Este     Norte
min -325700.9 -580919.1
max  387269.8  281577.0

Distance summary
         min          max 
    609.2419 1000171.2033 

Data summary
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-3.20000 13.15000 15.80000 14.42869 17.20000 24.50000 </code></pre>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Gráficos de dispersión</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">GeoR</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Temperatura<span class="sc">~</span>Este, <span class="at">data =</span> datosT, <span class="at">ylab =</span> <span class="st">"Temperatura"</span>, <span class="at">xlab=</span><span class="st">"Este"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Temperatura<span class="sc">~</span>Norte, <span class="at">data =</span> datosT, <span class="at">ylab =</span> <span class="st">"Temperatura"</span>, <span class="at">xlab=</span><span class="st">"Norte"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Geo_uni_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(temp, <span class="at">qt.col =</span> <span class="fu">c</span>(<span class="st">"purple"</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"pink"</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"green"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"yellow"</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">scatter3d=</span>T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Geo_uni_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>En el gráfico se observa un agrupamiento en las coordenadas Norte con respecto a los datos, que puede llegar a corregirse con algún polinomio. Se probará con diferentes modelos a ver si se puede llegar a disminuir el efecto espacial.</p>
<section id="ajuste-del-modelo" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="ajuste-del-modelo"><span class="header-section-number">3.1.1</span> Ajuste del modelo</h3>
<p>El modelo que mejor atrapa el efecto de la media es:</p>
<p><span class="math display">
Temperatura = \beta_0 + \beta_1 \times Norte + \beta_2 \times Norte^2
</span></p>
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fitT <span class="ot">&lt;-</span> <span class="fu">lm</span>(Temperatura<span class="sc">~</span>Norte<span class="sc">+</span><span class="fu">I</span>(Norte<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> datosT) </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitT)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Temperatura ~ Norte + I(Norte^2), data = datosT)

Residuals:
     Min       1Q   Median       3Q      Max 
-18.3668  -1.1159   0.9092   2.1923   9.2782 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.326e+01  5.352e-01  24.766  &lt; 2e-16 ***
Norte       -2.229e-05  3.230e-06  -6.901 2.68e-10 ***
I(Norte^2)  -3.754e-11  8.551e-12  -4.390 2.47e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.049 on 119 degrees of freedom
Multiple R-squared:  0.3199,    Adjusted R-squared:  0.3084 
F-statistic: 27.98 on 2 and 119 DF,  p-value: 1.094e-10</code></pre>
</div>
</div>
<p>Observamos el comportamiento de sus residuales podemos notar que el modelo ayudo a reducir el efecto espacial.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Gráficos de dispersión</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">GeoR</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>datosT<span class="sc">$</span>Residuos <span class="ot">&lt;-</span> fitT<span class="sc">$</span>residuals</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Residuos<span class="sc">~</span>Este, <span class="at">data =</span> datosT, <span class="at">xlab=</span><span class="st">"Este"</span>, <span class="at">ylab=</span><span class="st">"Residuos"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Residuos<span class="sc">~</span>Norte, <span class="at">data =</span> datosT, <span class="at">xlab=</span><span class="st">"Norte"</span>, <span class="at">ylab=</span><span class="st">"Residuos"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Geo_uni_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(temp, <span class="at">qt.col =</span> <span class="fu">c</span>(<span class="st">"purple"</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"pink"</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"green"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"yellow"</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">scatter3d=</span>T, <span class="at">trend=</span><span class="sc">~</span>Norte<span class="sc">+</span><span class="fu">I</span>(Norte<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Geo_uni_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="estimación-empírica-del-semivariograma" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="estimación-empírica-del-semivariograma"><span class="header-section-number">3.1.2</span> Estimación empírica del semivariograma</h3>
<p>p¿Presentamos la estimación del semivariograma obtenida mediante la función variog para la variable temperatura. Se comparan los resultados al calcularlo directamente sobre los datos originales (sin remover la tendencia) y al utilizar los residuales de un modelo de regresión, con el objetivo de analizar cómo influye la presencia de tendencia en la estructura espacial.</p>
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>vg_T <span class="ot">&lt;-</span> <span class="fu">variog</span>(temp, <span class="at">estimator.type =</span> <span class="st">"modulus"</span>, <span class="at">pairs.min=</span><span class="dv">50</span>) <span class="co">#Sin tendencia espacial</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>variog: computing omnidirectional variogram</code></pre>
</div>
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>vg1_T <span class="ot">&lt;-</span> <span class="fu">variog</span>(temp, <span class="at">trend =</span> <span class="sc">~</span>Norte<span class="sc">+</span><span class="fu">I</span>(Norte<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">estimator.type =</span> <span class="st">"modulus"</span>, <span class="at">pairs.min=</span><span class="dv">50</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>variog: computing omnidirectional variogram</code></pre>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Con tendencia</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Removiendo tendencia</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(vg_T,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"h"</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Semivarianza"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.3</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">1.2</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Sin remover tendencia"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col.main =</span> <span class="dv">4</span>, <span class="at">cex.main =</span><span class="fl">1.3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Geo_uni_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(vg1_T,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"h"</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Semivarianza"</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.3</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">1.2</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Removiendo tendencia"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col.main =</span> <span class="dv">4</span>, <span class="at">cex.main =</span><span class="fl">1.3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Geo_uni_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Cuando no se remueve la tendencia, la semivarianza alcanza valores más altos y presenta una forma aparentemente más regular, aunque dicha regularidad está influenciada por la tendencia global de los datos. En cambio, al eliminar la tendencia, los valores de semivarianza disminuyen y el patrón pierde suavidad, pero el variograma refleja con mayor fidelidad la verdadera dependencia espacial.</p>
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(vg1_T<span class="sc">$</span>u, vg1_T<span class="sc">$</span>n, <span class="at">type=</span><span class="st">"b"</span>,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"distance"</span>, <span class="at">ylab=</span><span class="st">"n pairs"</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Número de pares por bin"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Geo_uni_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>En este caso, el último punto corresponde a menos de 25 pares de observaciones, por lo que su interpretación resulta menos confiable.</p>
</section>
<section id="estimación-del-modelo-teórico-de-semivariograma" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="estimación-del-modelo-teórico-de-semivariograma"><span class="header-section-number">3.1.3</span> Estimación del Modelo Teórico de Semivariograma</h3>
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dist_matrix_T <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(temp<span class="sc">$</span>coords))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#1. Funciones de correlación, covarianza y semivarianza: ----</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#1.1 Modelo exponencial ----</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>rho_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(h, phi){</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>(h<span class="sc">/</span>phi)) <span class="co">#Correlacion espacial</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>cov_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, h, phi){</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  sigma<span class="sc">*</span><span class="fu">rho_exp</span>(h, phi) <span class="co">#Covarianza espacial</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>sv_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(nugget, sigma, h, phi){</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  nugget <span class="sc">+</span> sigma <span class="sc">-</span> <span class="fu">cov_exp</span>(sigma, h, phi) <span class="co">#Semivarianza espacial</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co">#1.2 Modelo Gaussianio ----</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>rho_gauss <span class="ot">&lt;-</span> <span class="cf">function</span>(h, phi){</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>(h<span class="sc">/</span>phi)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>cov_gauss <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, h, phi){</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  sigma<span class="sc">*</span><span class="fu">rho_gauss</span>(h, phi) <span class="co">#Covarianza espacial</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>sv_gauss <span class="ot">&lt;-</span> <span class="cf">function</span>(nugget, sigma, h, phi){</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  nugget <span class="sc">+</span> sigma <span class="sc">-</span> <span class="fu">cov_gauss</span>(sigma, h, phi) <span class="co">#Semivarianza espacial</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="co">#1.3 Modelo Gneting ----</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>cov_gneiting <span class="ot">&lt;-</span> <span class="cf">function</span>(h){</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fl">0.301187465825</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(<span class="dv">0</span><span class="sc">&lt;=</span> s<span class="sc">*</span>h <span class="sc">&amp;</span>  s<span class="sc">*</span>h <span class="sc">&lt;=</span> <span class="dv">1</span>,</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span> <span class="sc">+</span> <span class="dv">8</span><span class="sc">*</span>s<span class="sc">*</span>h <span class="sc">+</span> <span class="dv">25</span><span class="sc">*</span>(s<span class="sc">*</span>h)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">32</span><span class="sc">*</span>(s<span class="sc">*</span>h)<span class="sc">^</span><span class="dv">3</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>s<span class="sc">*</span>h)<span class="sc">^</span><span class="dv">8</span>,</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>)</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>sv_gneiting <span class="ot">&lt;-</span> <span class="cf">function</span>(nugget, sigma, h){</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  nugget <span class="sc">+</span> sigma <span class="sc">-</span> <span class="fu">cov_gneiting</span>(h) <span class="co">#Semivarianza espacial</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a><span class="co">#1.4 Modelo Spherical ----</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>rho_spherical <span class="ot">&lt;-</span> <span class="cf">function</span>(h, phi){</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(h<span class="sc">&lt;</span>phi,</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>         <span class="dv">1</span> <span class="sc">-</span> <span class="fl">1.5</span><span class="sc">*</span>(h<span class="sc">/</span>phi) <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>(h<span class="sc">/</span>phi)<span class="sc">^</span><span class="dv">3</span>,</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>         <span class="dv">0</span>)</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>cov_spherical <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, h, phi){</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>  sigma<span class="sc">*</span><span class="fu">rho_spherical</span>(h, phi) <span class="co">#Covarianza espacial</span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>sv_spherical <span class="ot">&lt;-</span> <span class="cf">function</span>(nugget, sigma, h, phi){</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>  nugget <span class="sc">+</span> sigma <span class="sc">-</span> <span class="fu">cov_spherical</span>(sigma, h, phi) <span class="co">#Semivarianza espacial</span></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a><span class="co">#1.5 Modelo Matern ----</span></span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>rho_matern <span class="ot">&lt;-</span> <span class="cf">function</span>(h, phi, kappa){</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">gamma</span>(kappa))) <span class="sc">*</span> (h<span class="sc">/</span>phi)<span class="sc">^</span>kappa <span class="sc">*</span> <span class="fu">besselK</span>((h<span class="sc">/</span>phi), kappa)</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>cov_matern <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, h, phi, kappa){</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>  sigma<span class="sc">*</span><span class="fu">rho_matern</span>(h, phi, kappa) <span class="co">#Covarianza espacial</span></span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>sv_matern <span class="ot">&lt;-</span> <span class="cf">function</span>(nugget, sigma, h, phi, kappa){</span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>  nugget <span class="sc">+</span> sigma <span class="sc">-</span> <span class="fu">cov_matern</span>(sigma, h, phi, kappa) <span class="co">#Semivarianza espacial</span></span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a><span class="co">#2. Función para estimar por WLS----</span></span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>MSE_ponderados <span class="ot">&lt;-</span> <span class="cf">function</span>(par, h, gamma,<span class="at">kappa=</span><span class="cn">NA</span>,w, model, n, pesos){</span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>  nugget <span class="ot">&lt;-</span> par[<span class="dv">1</span>]</span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> par[<span class="dv">2</span>]</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> par[<span class="dv">3</span>]</span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>  gamma_hat <span class="ot">&lt;-</span> <span class="cf">switch</span>(model,</span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"exponencial"</span> <span class="ot">=</span> <span class="fu">sv_exp</span>(nugget, sigma, h, phi),</span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"gaussian"</span>    <span class="ot">=</span> <span class="fu">sv_gauss</span>(nugget, sigma, h, phi),</span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"gneiting"</span>    <span class="ot">=</span> <span class="fu">sv_gneiting</span>(nugget, sigma, h, phi),</span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"spherical"</span>   <span class="ot">=</span> <span class="fu">sv_spherical</span>(nugget, sigma, h, phi),</span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"matern"</span>      <span class="ot">=</span> <span class="fu">sv_matern</span>(nugget, sigma, h, phi, kappa)</span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>  w <span class="ot">&lt;-</span> <span class="cf">switch</span>(pesos,</span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Cressie"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>gamma_hat)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n),</span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>              <span class="st">"n"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>n,</span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>              <span class="st">"h/n"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>(h<span class="sc">/</span>n),</span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>              <span class="st">"I"</span> <span class="ot">=</span> <span class="dv">1</span>)</span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(w<span class="sc">*</span>(gamma <span class="sc">-</span> gamma_hat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a>est_sev_WLS <span class="ot">&lt;-</span> <span class="cf">function</span>(par, <span class="at">kappa =</span> <span class="cn">NA</span>, model, h, gamma, n){</span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a>  sigma_0 <span class="ot">&lt;-</span> par[<span class="dv">1</span>]</span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a>  phi_0 <span class="ot">&lt;-</span> par[<span class="dv">2</span>]</span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a>  nugget_0 <span class="ot">&lt;-</span> par[<span class="dv">3</span>]</span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a>  kappa_0 <span class="ot">&lt;-</span> kappa</span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Selección de función</span></span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a>  sv <span class="ot">&lt;-</span> <span class="cf">switch</span>(model,</span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a>               <span class="st">"exponencial"</span> <span class="ot">=</span> sv_exp,</span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a>               <span class="st">"gaussian"</span>    <span class="ot">=</span> sv_gauss,</span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a>               <span class="st">"spherical"</span>   <span class="ot">=</span> sv_spherical,</span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a>               <span class="st">"gneiting"</span>    <span class="ot">=</span> sv_gneiting,</span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a>               <span class="st">"matern"</span>      <span class="ot">=</span> sv_matern</span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a>  args_sv <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">formals</span>(sv))</span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a>  args_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">nugget =</span> nugget_0,</span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma  =</span> sigma_0,</span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">h      =</span> h,</span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">phi    =</span> phi_0,</span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">kappa  =</span> kappa_0</span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a>  args_list <span class="ot">&lt;-</span> args_list[<span class="fu">names</span>(args_list) <span class="sc">%in%</span> args_sv]</span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a>  sv_ini <span class="ot">&lt;-</span> <span class="fu">do.call</span>(sv, args_list)</span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true" tabindex="-1"></a>  formula_sv <span class="ot">&lt;-</span> <span class="cf">switch</span>(model,</span>
<span id="cb18-129"><a href="#cb18-129" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"gneiting"</span> <span class="ot">=</span> gamma <span class="sc">~</span> <span class="fu">sv</span>(nugget, sigma, h),</span>
<span id="cb18-130"><a href="#cb18-130" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"matern"</span> <span class="ot">=</span> gamma <span class="sc">~</span> <span class="fu">sv</span>(nugget, sigma, h, phi, kappa),</span>
<span id="cb18-131"><a href="#cb18-131" aria-hidden="true" tabindex="-1"></a>                       gamma <span class="sc">~</span> <span class="fu">sv</span>(nugget, sigma, h, phi)</span>
<span id="cb18-132"><a href="#cb18-132" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-133"><a href="#cb18-133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-134"><a href="#cb18-134" aria-hidden="true" tabindex="-1"></a>  start_list <span class="ot">&lt;-</span> <span class="cf">switch</span>(model,</span>
<span id="cb18-135"><a href="#cb18-135" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"gneting"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">nugget =</span> nugget_0, <span class="at">sigma =</span> sigma_0),</span>
<span id="cb18-136"><a href="#cb18-136" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"matern"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">nugget =</span> nugget_0, <span class="at">sigma =</span> sigma_0, <span class="at">phi =</span> phi_0, <span class="at">kappa =</span> kappa_0),</span>
<span id="cb18-137"><a href="#cb18-137" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">list</span>(<span class="at">nugget =</span> nugget_0, <span class="at">sigma =</span> sigma_0, <span class="at">phi =</span> phi_0)</span>
<span id="cb18-138"><a href="#cb18-138" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-139"><a href="#cb18-139" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-140"><a href="#cb18-140" aria-hidden="true" tabindex="-1"></a>    <span class="co">#1. Ponderación de Bessel</span></span>
<span id="cb18-141"><a href="#cb18-141" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-142"><a href="#cb18-142" aria-hidden="true" tabindex="-1"></a>    WW <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>sv_ini)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n)</span>
<span id="cb18-143"><a href="#cb18-143" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-144"><a href="#cb18-144" aria-hidden="true" tabindex="-1"></a>    Bessel <span class="ot">&lt;-</span> <span class="fu">nls</span>(<span class="at">formula =</span> formula_sv,</span>
<span id="cb18-145"><a href="#cb18-145" aria-hidden="true" tabindex="-1"></a>                  <span class="at">start =</span> start_list,</span>
<span id="cb18-146"><a href="#cb18-146" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weights =</span> <span class="dv">1</span><span class="sc">/</span>WW,</span>
<span id="cb18-147"><a href="#cb18-147" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">nls.control</span>(<span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">warnOnly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb18-148"><a href="#cb18-148" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-149"><a href="#cb18-149" aria-hidden="true" tabindex="-1"></a>    ini_Bessel<span class="ot">&lt;-</span><span class="fu">coef</span>(Bessel)</span>
<span id="cb18-150"><a href="#cb18-150" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-151"><a href="#cb18-151" aria-hidden="true" tabindex="-1"></a>    <span class="co">#1.1 Optim Bessel</span></span>
<span id="cb18-152"><a href="#cb18-152" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-153"><a href="#cb18-153" aria-hidden="true" tabindex="-1"></a>    optim_bessel <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb18-154"><a href="#cb18-154" aria-hidden="true" tabindex="-1"></a>      <span class="at">par =</span> <span class="fu">coef</span>(Bessel),</span>
<span id="cb18-155"><a href="#cb18-155" aria-hidden="true" tabindex="-1"></a>      <span class="at">fn =</span> MSE_ponderados,</span>
<span id="cb18-156"><a href="#cb18-156" aria-hidden="true" tabindex="-1"></a>      <span class="at">h =</span> h,</span>
<span id="cb18-157"><a href="#cb18-157" aria-hidden="true" tabindex="-1"></a>      <span class="at">gamma =</span> gamma,</span>
<span id="cb18-158"><a href="#cb18-158" aria-hidden="true" tabindex="-1"></a>      <span class="at">pesos =</span> <span class="st">"Cressie"</span>,</span>
<span id="cb18-159"><a href="#cb18-159" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> model,</span>
<span id="cb18-160"><a href="#cb18-160" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> n,</span>
<span id="cb18-161"><a href="#cb18-161" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"L-BFGS-B"</span>,</span>
<span id="cb18-162"><a href="#cb18-162" aria-hidden="true" tabindex="-1"></a>      <span class="at">lower =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb18-163"><a href="#cb18-163" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-164"><a href="#cb18-164" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-165"><a href="#cb18-165" aria-hidden="true" tabindex="-1"></a>    par_optim_Bess <span class="ot">&lt;-</span> optim_bessel<span class="sc">$</span>par[<span class="fu">c</span>(<span class="st">"nugget"</span>, <span class="st">"sigma"</span>, <span class="st">"phi"</span>)]</span>
<span id="cb18-166"><a href="#cb18-166" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-167"><a href="#cb18-167" aria-hidden="true" tabindex="-1"></a>    <span class="co">#2. Ponderación 1/n</span></span>
<span id="cb18-168"><a href="#cb18-168" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-169"><a href="#cb18-169" aria-hidden="true" tabindex="-1"></a>    W1 <span class="ot">&lt;-</span> n</span>
<span id="cb18-170"><a href="#cb18-170" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-171"><a href="#cb18-171" aria-hidden="true" tabindex="-1"></a>    n_pond <span class="ot">&lt;-</span> <span class="fu">nls</span>(<span class="at">formula =</span> formula_sv,</span>
<span id="cb18-172"><a href="#cb18-172" aria-hidden="true" tabindex="-1"></a>                  <span class="at">start =</span> start_list,</span>
<span id="cb18-173"><a href="#cb18-173" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weights =</span> <span class="dv">1</span><span class="sc">/</span>W1,</span>
<span id="cb18-174"><a href="#cb18-174" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">nls.control</span>(<span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">warnOnly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb18-175"><a href="#cb18-175" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-176"><a href="#cb18-176" aria-hidden="true" tabindex="-1"></a>    ini_n<span class="ot">&lt;-</span><span class="fu">coef</span>(n_pond)</span>
<span id="cb18-177"><a href="#cb18-177" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-178"><a href="#cb18-178" aria-hidden="true" tabindex="-1"></a>    <span class="co">#2.1 Optimización 1/n</span></span>
<span id="cb18-179"><a href="#cb18-179" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-180"><a href="#cb18-180" aria-hidden="true" tabindex="-1"></a>    optim_n <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb18-181"><a href="#cb18-181" aria-hidden="true" tabindex="-1"></a>      <span class="at">par =</span> <span class="fu">coef</span>(n_pond),</span>
<span id="cb18-182"><a href="#cb18-182" aria-hidden="true" tabindex="-1"></a>      <span class="at">fn =</span> MSE_ponderados,</span>
<span id="cb18-183"><a href="#cb18-183" aria-hidden="true" tabindex="-1"></a>      <span class="at">h =</span> h,</span>
<span id="cb18-184"><a href="#cb18-184" aria-hidden="true" tabindex="-1"></a>      <span class="at">gamma =</span> gamma,</span>
<span id="cb18-185"><a href="#cb18-185" aria-hidden="true" tabindex="-1"></a>      <span class="at">pesos =</span> <span class="st">"n"</span>,</span>
<span id="cb18-186"><a href="#cb18-186" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> n,</span>
<span id="cb18-187"><a href="#cb18-187" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> model,</span>
<span id="cb18-188"><a href="#cb18-188" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"L-BFGS-B"</span>,</span>
<span id="cb18-189"><a href="#cb18-189" aria-hidden="true" tabindex="-1"></a>      <span class="at">lower =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb18-190"><a href="#cb18-190" aria-hidden="true" tabindex="-1"></a>    )    </span>
<span id="cb18-191"><a href="#cb18-191" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-192"><a href="#cb18-192" aria-hidden="true" tabindex="-1"></a>    par_optim_n <span class="ot">&lt;-</span> optim_n<span class="sc">$</span>par[<span class="fu">c</span>(<span class="st">"nugget"</span>, <span class="st">"sigma"</span>, <span class="st">"phi"</span>)]</span>
<span id="cb18-193"><a href="#cb18-193" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-194"><a href="#cb18-194" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-195"><a href="#cb18-195" aria-hidden="true" tabindex="-1"></a>    <span class="co">#3. Ponderación h/n</span></span>
<span id="cb18-196"><a href="#cb18-196" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-197"><a href="#cb18-197" aria-hidden="true" tabindex="-1"></a>    W2 <span class="ot">&lt;-</span> h<span class="sc">/</span>n</span>
<span id="cb18-198"><a href="#cb18-198" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-199"><a href="#cb18-199" aria-hidden="true" tabindex="-1"></a>    h_n_pond <span class="ot">&lt;-</span> <span class="fu">nls</span>(<span class="at">formula =</span> formula_sv,</span>
<span id="cb18-200"><a href="#cb18-200" aria-hidden="true" tabindex="-1"></a>                    <span class="at">start =</span> start_list,</span>
<span id="cb18-201"><a href="#cb18-201" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="dv">1</span><span class="sc">/</span>W2,</span>
<span id="cb18-202"><a href="#cb18-202" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">nls.control</span>(<span class="at">maxiter =</span> <span class="dv">500</span>, <span class="at">warnOnly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb18-203"><a href="#cb18-203" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-204"><a href="#cb18-204" aria-hidden="true" tabindex="-1"></a>    ini_h_n<span class="ot">&lt;-</span><span class="fu">coef</span>(h_n_pond)</span>
<span id="cb18-205"><a href="#cb18-205" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-206"><a href="#cb18-206" aria-hidden="true" tabindex="-1"></a>    optim_h_n <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb18-207"><a href="#cb18-207" aria-hidden="true" tabindex="-1"></a>      <span class="at">par =</span> <span class="fu">coef</span>(h_n_pond),</span>
<span id="cb18-208"><a href="#cb18-208" aria-hidden="true" tabindex="-1"></a>      <span class="at">fn =</span> MSE_ponderados,</span>
<span id="cb18-209"><a href="#cb18-209" aria-hidden="true" tabindex="-1"></a>      <span class="at">h =</span> h,</span>
<span id="cb18-210"><a href="#cb18-210" aria-hidden="true" tabindex="-1"></a>      <span class="at">gamma =</span> gamma,</span>
<span id="cb18-211"><a href="#cb18-211" aria-hidden="true" tabindex="-1"></a>      <span class="at">pesos =</span> <span class="st">"h/n"</span>,</span>
<span id="cb18-212"><a href="#cb18-212" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> model,</span>
<span id="cb18-213"><a href="#cb18-213" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> n,</span>
<span id="cb18-214"><a href="#cb18-214" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"L-BFGS-B"</span>,</span>
<span id="cb18-215"><a href="#cb18-215" aria-hidden="true" tabindex="-1"></a>      <span class="at">lower =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb18-216"><a href="#cb18-216" aria-hidden="true" tabindex="-1"></a>    )    </span>
<span id="cb18-217"><a href="#cb18-217" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-218"><a href="#cb18-218" aria-hidden="true" tabindex="-1"></a>    par_optim_h_n <span class="ot">&lt;-</span> optim_h_n<span class="sc">$</span>par[<span class="fu">c</span>(<span class="st">"nugget"</span>, <span class="st">"sigma"</span>, <span class="st">"phi"</span>)]</span>
<span id="cb18-219"><a href="#cb18-219" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-220"><a href="#cb18-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-221"><a href="#cb18-221" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Bessel =</span> <span class="fu">list</span>(<span class="at">Iniciales =</span> ini_Bessel,</span>
<span id="cb18-222"><a href="#cb18-222" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Optimizados =</span> par_optim_Bess),</span>
<span id="cb18-223"><a href="#cb18-223" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">1/n</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">Iniciales =</span> ini_n,</span>
<span id="cb18-224"><a href="#cb18-224" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Optimizados =</span> par_optim_n),</span>
<span id="cb18-225"><a href="#cb18-225" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">h/n</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">Iniciales =</span> ini_h_n,</span>
<span id="cb18-226"><a href="#cb18-226" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Optimizados =</span> par_optim_h_n))    </span>
<span id="cb18-227"><a href="#cb18-227" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(res)</span>
<span id="cb18-228"><a href="#cb18-228" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-229"><a href="#cb18-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-230"><a href="#cb18-230" aria-hidden="true" tabindex="-1"></a>MSE_sv <span class="ot">&lt;-</span> <span class="cf">function</span>(gamma_hat, par, kappa, model, h){</span>
<span id="cb18-231"><a href="#cb18-231" aria-hidden="true" tabindex="-1"></a>  sigma_0 <span class="ot">&lt;-</span> par[[<span class="dv">2</span>]]</span>
<span id="cb18-232"><a href="#cb18-232" aria-hidden="true" tabindex="-1"></a>  phi_0 <span class="ot">&lt;-</span> par[[<span class="dv">3</span>]]</span>
<span id="cb18-233"><a href="#cb18-233" aria-hidden="true" tabindex="-1"></a>  nugget_0 <span class="ot">&lt;-</span> par[[<span class="dv">1</span>]]</span>
<span id="cb18-234"><a href="#cb18-234" aria-hidden="true" tabindex="-1"></a>  kappa_0 <span class="ot">&lt;-</span> kappa</span>
<span id="cb18-235"><a href="#cb18-235" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-236"><a href="#cb18-236" aria-hidden="true" tabindex="-1"></a>  sv <span class="ot">&lt;-</span> <span class="cf">switch</span>(model,</span>
<span id="cb18-237"><a href="#cb18-237" aria-hidden="true" tabindex="-1"></a>               <span class="st">"exponencial"</span> <span class="ot">=</span> sv_exp,</span>
<span id="cb18-238"><a href="#cb18-238" aria-hidden="true" tabindex="-1"></a>               <span class="st">"gaussian"</span>    <span class="ot">=</span> sv_gauss,</span>
<span id="cb18-239"><a href="#cb18-239" aria-hidden="true" tabindex="-1"></a>               <span class="st">"spherical"</span>   <span class="ot">=</span> sv_spherical,</span>
<span id="cb18-240"><a href="#cb18-240" aria-hidden="true" tabindex="-1"></a>               <span class="st">"gneiting"</span>    <span class="ot">=</span> sv_gneiting,</span>
<span id="cb18-241"><a href="#cb18-241" aria-hidden="true" tabindex="-1"></a>               <span class="st">"matern"</span>      <span class="ot">=</span> sv_matern</span>
<span id="cb18-242"><a href="#cb18-242" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-243"><a href="#cb18-243" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-244"><a href="#cb18-244" aria-hidden="true" tabindex="-1"></a>  args_sv <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">formals</span>(sv))</span>
<span id="cb18-245"><a href="#cb18-245" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-246"><a href="#cb18-246" aria-hidden="true" tabindex="-1"></a>  args_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb18-247"><a href="#cb18-247" aria-hidden="true" tabindex="-1"></a>    <span class="at">nugget =</span> nugget_0,</span>
<span id="cb18-248"><a href="#cb18-248" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma  =</span> sigma_0,</span>
<span id="cb18-249"><a href="#cb18-249" aria-hidden="true" tabindex="-1"></a>    <span class="at">h      =</span> h,</span>
<span id="cb18-250"><a href="#cb18-250" aria-hidden="true" tabindex="-1"></a>    <span class="at">phi    =</span> phi_0,</span>
<span id="cb18-251"><a href="#cb18-251" aria-hidden="true" tabindex="-1"></a>    <span class="at">kappa  =</span> kappa_0</span>
<span id="cb18-252"><a href="#cb18-252" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-253"><a href="#cb18-253" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-254"><a href="#cb18-254" aria-hidden="true" tabindex="-1"></a>  args_list <span class="ot">&lt;-</span> args_list[<span class="fu">names</span>(args_list) <span class="sc">%in%</span> args_sv]</span>
<span id="cb18-255"><a href="#cb18-255" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-256"><a href="#cb18-256" aria-hidden="true" tabindex="-1"></a>  sv_est <span class="ot">&lt;-</span> <span class="fu">do.call</span>(sv, args_list)</span>
<span id="cb18-257"><a href="#cb18-257" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-258"><a href="#cb18-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>((sv_est<span class="sc">-</span>gamma_hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb18-259"><a href="#cb18-259" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-260"><a href="#cb18-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-261"><a href="#cb18-261" aria-hidden="true" tabindex="-1"></a><span class="co">#3. Función para etimar por máxima verosimilitud</span></span>
<span id="cb18-262"><a href="#cb18-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-263"><a href="#cb18-263" aria-hidden="true" tabindex="-1"></a>loglik <span class="ot">&lt;-</span> <span class="cf">function</span>(par, <span class="at">kappa=</span><span class="cn">NA</span>, z, dist_matrix, model){</span>
<span id="cb18-264"><a href="#cb18-264" aria-hidden="true" tabindex="-1"></a>  sigma_0 <span class="ot">&lt;-</span> par[<span class="dv">1</span>]</span>
<span id="cb18-265"><a href="#cb18-265" aria-hidden="true" tabindex="-1"></a>  phi_0 <span class="ot">&lt;-</span> par[<span class="dv">2</span>]</span>
<span id="cb18-266"><a href="#cb18-266" aria-hidden="true" tabindex="-1"></a>  nugget_0 <span class="ot">&lt;-</span> par[<span class="dv">3</span>]</span>
<span id="cb18-267"><a href="#cb18-267" aria-hidden="true" tabindex="-1"></a>  kappa_0 <span class="ot">&lt;-</span> kappa</span>
<span id="cb18-268"><a href="#cb18-268" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-269"><a href="#cb18-269" aria-hidden="true" tabindex="-1"></a>  cov <span class="ot">&lt;-</span> <span class="cf">switch</span>(model,</span>
<span id="cb18-270"><a href="#cb18-270" aria-hidden="true" tabindex="-1"></a>               <span class="st">"exponencial"</span> <span class="ot">=</span> cov_exp,</span>
<span id="cb18-271"><a href="#cb18-271" aria-hidden="true" tabindex="-1"></a>               <span class="st">"gaussian"</span>    <span class="ot">=</span> cov_gauss,</span>
<span id="cb18-272"><a href="#cb18-272" aria-hidden="true" tabindex="-1"></a>               <span class="st">"spherical"</span>   <span class="ot">=</span> cov_spherical,</span>
<span id="cb18-273"><a href="#cb18-273" aria-hidden="true" tabindex="-1"></a>               <span class="st">"gneiting"</span>    <span class="ot">=</span> cov_gneiting,</span>
<span id="cb18-274"><a href="#cb18-274" aria-hidden="true" tabindex="-1"></a>               <span class="st">"matern"</span>      <span class="ot">=</span> cov_matern</span>
<span id="cb18-275"><a href="#cb18-275" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-276"><a href="#cb18-276" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-277"><a href="#cb18-277" aria-hidden="true" tabindex="-1"></a>  args_cov <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">formals</span>(cov))</span>
<span id="cb18-278"><a href="#cb18-278" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-279"><a href="#cb18-279" aria-hidden="true" tabindex="-1"></a>  args_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb18-280"><a href="#cb18-280" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma  =</span> sigma_0,</span>
<span id="cb18-281"><a href="#cb18-281" aria-hidden="true" tabindex="-1"></a>    <span class="at">nugget =</span> nugget_0,</span>
<span id="cb18-282"><a href="#cb18-282" aria-hidden="true" tabindex="-1"></a>    <span class="at">h      =</span> dist_matrix,</span>
<span id="cb18-283"><a href="#cb18-283" aria-hidden="true" tabindex="-1"></a>    <span class="at">phi    =</span> phi_0,</span>
<span id="cb18-284"><a href="#cb18-284" aria-hidden="true" tabindex="-1"></a>    <span class="at">kappa  =</span> kappa_0</span>
<span id="cb18-285"><a href="#cb18-285" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-286"><a href="#cb18-286" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-287"><a href="#cb18-287" aria-hidden="true" tabindex="-1"></a>  args_list <span class="ot">&lt;-</span> args_list[<span class="fu">names</span>(args_list) <span class="sc">%in%</span> args_cov]</span>
<span id="cb18-288"><a href="#cb18-288" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-289"><a href="#cb18-289" aria-hidden="true" tabindex="-1"></a>  Sigma <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cov, args_list) </span>
<span id="cb18-290"><a href="#cb18-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diag</span>(Sigma) <span class="ot">=</span> <span class="fu">diag</span>(Sigma) <span class="sc">+</span> nugget_0</span>
<span id="cb18-291"><a href="#cb18-291" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-292"><a href="#cb18-292" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Descomposición de Cholesky (más estable que solve o det)</span></span>
<span id="cb18-293"><a href="#cb18-293" aria-hidden="true" tabindex="-1"></a>  inv_Sigma <span class="ot">&lt;-</span> <span class="fu">solve</span>(Sigma)</span>
<span id="cb18-294"><a href="#cb18-294" aria-hidden="true" tabindex="-1"></a>  det <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">det</span>(Sigma))</span>
<span id="cb18-295"><a href="#cb18-295" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-296"><a href="#cb18-296" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Log-verosimilitud del modelo Gaussiano</span></span>
<span id="cb18-297"><a href="#cb18-297" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> z </span>
<span id="cb18-298"><a href="#cb18-298" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(z)</span>
<span id="cb18-299"><a href="#cb18-299" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> (n <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">2</span> <span class="sc">*</span> pi) <span class="sc">+</span> det <span class="sc">+</span> <span class="fu">crossprod</span>(z, inv_Sigma <span class="sc">%*%</span> z))  <span class="co"># Log-verosimilitud (negativa porque optim minimiza)</span></span>
<span id="cb18-300"><a href="#cb18-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span>ll)</span>
<span id="cb18-301"><a href="#cb18-301" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Los modelos obtenidos ajustanto por EyeFit, son:</p>
<pre class="text"><code>
cov.model sigmasq      phi tausq kappa kappa2 practicalRange
1 exponential   10.74 109166.3  2.07    NA     NA       327033.0
2    gaussian   10.00  80000.0  2.07    NA     NA       138465.5
3   spherical   10.00 157832.8  2.07    NA     NA       157832.8
</code></pre>
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>variog_T <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">h =</span> vg1_T<span class="sc">$</span>u, <span class="at">gamma_hat =</span> vg1_T<span class="sc">$</span>v,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">n =</span> vg1_T<span class="sc">$</span>n)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>range_sv_T <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">max</span>(variog_T<span class="sc">$</span>h), <span class="at">by=</span><span class="dv">1000</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo exponencial ----</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>sigma_0_eT <span class="ot">&lt;-</span> <span class="fl">10.74</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>phi_0_eT <span class="ot">&lt;-</span> <span class="fl">109166.3</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>nugget_0_eT <span class="ot">&lt;-</span> <span class="fl">2.07</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>par_eT <span class="ot">&lt;-</span> <span class="fu">c</span>(sigma_0_eT, phi_0_eT, nugget_0_eT)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>res_e_T <span class="ot">&lt;-</span> <span class="fu">est_sev_WLS</span>(<span class="at">par=</span>par_eT, <span class="at">kappa =</span> <span class="cn">NA</span>,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">model=</span><span class="st">"exponencial"</span>,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">h=</span>variog_T<span class="sc">$</span>h,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">gamma =</span> variog_T<span class="sc">$</span>gamma_hat,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">n =</span> variog_T<span class="sc">$</span>n)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nls(formula = formula_sv, start = start_list, weights = 1/W2, :
gradiente singular</code></pre>
</div>
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>MLE_eT <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">fn =</span> loglik,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">par =</span> par_eT,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">kappa=</span><span class="cn">NA</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">z =</span> datosT<span class="sc">$</span>Residuos, </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">dist_matrix=</span>dist_matrix_T,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">model =</span> <span class="st">"exponencial"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">method =</span> <span class="st">"L-BFGS-B"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">lower =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>estsv_exp_Bess_T <span class="ot">&lt;-</span> <span class="fu">do.call</span>(sv_exp, <span class="fu">c</span>(<span class="fu">as.list</span>(res_e_T<span class="sc">$</span>Bessel<span class="sc">$</span>Optimizados), <span class="fu">list</span>(<span class="at">h =</span> range_sv_T)))</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>estsv_exp_n_T <span class="ot">&lt;-</span> <span class="fu">do.call</span>(sv_exp, <span class="fu">c</span>(<span class="fu">as.list</span>(res_e_T<span class="sc">$</span><span class="st">`</span><span class="at">1/n</span><span class="st">`</span><span class="sc">$</span>Optimizados), <span class="fu">list</span>(<span class="at">h =</span> range_sv_T)))</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>estsv_exp_h_n_T <span class="ot">&lt;-</span> <span class="fu">do.call</span>(sv_exp, <span class="fu">c</span>(<span class="fu">as.list</span>(res_e_T<span class="sc">$</span><span class="st">`</span><span class="at">h/n</span><span class="st">`</span><span class="sc">$</span>Optimizados), <span class="fu">list</span>(<span class="at">h =</span> range_sv_T)))</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>estsv_exp_MLE_T <span class="ot">&lt;-</span> <span class="fu">do.call</span>(sv_exp, <span class="fu">c</span>(<span class="fu">list</span>(<span class="at">nugget =</span> MLE_eT<span class="sc">$</span>par[<span class="dv">3</span>], <span class="at">phi =</span> MLE_eT<span class="sc">$</span>par[<span class="dv">2</span>] , <span class="at">sigma =</span> MLE_eT<span class="sc">$</span>par[<span class="dv">1</span>],<span class="at">h =</span> range_sv_T)))</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo Gaussiano ----</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>sigma_0_gT <span class="ot">&lt;-</span> <span class="fl">10.00</span>    </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>phi_0_gT <span class="ot">&lt;-</span> <span class="fl">80000.0</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>nugget_0_gT <span class="ot">&lt;-</span> <span class="fl">2.07</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>par_gT <span class="ot">&lt;-</span> <span class="fu">c</span>(sigma_0_gT, phi_0_gT, nugget_0_gT)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>res_g_T <span class="ot">&lt;-</span> <span class="fu">est_sev_WLS</span>(<span class="at">par=</span>par_gT, <span class="at">kappa =</span> <span class="cn">NA</span>,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">model=</span><span class="st">"gaussian"</span>,</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">h=</span>variog_T<span class="sc">$</span>h,</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">gamma =</span> variog_T<span class="sc">$</span>gamma_hat,</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">n =</span> variog_T<span class="sc">$</span>n)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>estsv_g_Bess_T <span class="ot">&lt;-</span> <span class="fu">do.call</span>(sv_gauss, <span class="fu">c</span>(<span class="fu">as.list</span>(res_g_T<span class="sc">$</span>Bessel<span class="sc">$</span>Optimizados), <span class="fu">list</span>(<span class="at">h =</span> range_sv_T)))</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>estsv_g_n_T <span class="ot">&lt;-</span> <span class="fu">do.call</span>(sv_gauss, <span class="fu">c</span>(<span class="fu">as.list</span>(res_g_T<span class="sc">$</span><span class="st">`</span><span class="at">1/n</span><span class="st">`</span><span class="sc">$</span>Optimizados), <span class="fu">list</span>(<span class="at">h =</span> range_sv_T)))</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>estsv_g_h_n_T <span class="ot">&lt;-</span> <span class="fu">do.call</span>(sv_gauss, <span class="fu">c</span>(<span class="fu">as.list</span>(res_g_T<span class="sc">$</span><span class="st">`</span><span class="at">h/n</span><span class="st">`</span><span class="sc">$</span>Optimizados), <span class="fu">list</span>(<span class="at">h =</span> range_sv_T)))</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo esférico</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>sigma_0_esT <span class="ot">&lt;-</span> <span class="fl">10.00</span>   </span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>phi_0_esT <span class="ot">&lt;-</span> <span class="fl">157832.8</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>nugget_0_esT <span class="ot">&lt;-</span> <span class="fl">2.07</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>par_esT <span class="ot">&lt;-</span> <span class="fu">c</span>(sigma_0_esT, phi_0_esT, nugget_0_esT)</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>res_es_T <span class="ot">&lt;-</span> <span class="fu">est_sev_WLS</span>(<span class="at">par=</span>par_esT, <span class="at">kappa =</span> <span class="cn">NA</span>,</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>                       <span class="at">model=</span><span class="st">"spherical"</span>,</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>                       <span class="at">h=</span>variog_T<span class="sc">$</span>h,</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>                       <span class="at">gamma =</span> variog_T<span class="sc">$</span>gamma_hat,</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>                       <span class="at">n =</span> variog_T<span class="sc">$</span>n)</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>MLE_esT <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">fn =</span> loglik,</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>             <span class="at">par =</span> par_esT,</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>             <span class="at">kappa=</span><span class="cn">NA</span>,</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>             <span class="at">z =</span> datosT<span class="sc">$</span>Residuos, </span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">dist_matrix=</span>dist_matrix_T,</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">model =</span> <span class="st">"spherical"</span>,</span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>             <span class="at">method =</span> <span class="st">"L-BFGS-B"</span>,</span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>             <span class="at">lower =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>estsv_es_Bess_T <span class="ot">&lt;-</span> <span class="fu">do.call</span>(sv_spherical, <span class="fu">c</span>(<span class="fu">as.list</span>(res_es_T<span class="sc">$</span>Bessel<span class="sc">$</span>Optimizados), <span class="fu">list</span>(<span class="at">h =</span> range_sv_T)))</span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>estsv_es_n_T <span class="ot">&lt;-</span> <span class="fu">do.call</span>(sv_spherical, <span class="fu">c</span>(<span class="fu">as.list</span>(res_es_T<span class="sc">$</span><span class="st">`</span><span class="at">1/n</span><span class="st">`</span><span class="sc">$</span>Optimizados), <span class="fu">list</span>(<span class="at">h =</span> range_sv_T)))</span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>estsv_es_h_n_T <span class="ot">&lt;-</span> <span class="fu">do.call</span>(sv_spherical, <span class="fu">c</span>(<span class="fu">as.list</span>(res_es_T<span class="sc">$</span><span class="st">`</span><span class="at">h/n</span><span class="st">`</span><span class="sc">$</span>Optimizados), <span class="fu">list</span>(<span class="at">h =</span> range_sv_T)))</span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>estsv_es_MLE_T <span class="ot">&lt;-</span> <span class="fu">do.call</span>(sv_spherical, <span class="fu">c</span>(<span class="fu">list</span>(<span class="at">nugget =</span> MLE_esT<span class="sc">$</span>par[<span class="dv">3</span>], <span class="at">phi =</span> MLE_esT<span class="sc">$</span>par[<span class="dv">2</span>] , <span class="at">sigma =</span> MLE_esT<span class="sc">$</span>par[<span class="dv">1</span>],<span class="at">h =</span> range_sv_T)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Exponencial</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Gaussiano</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Esférico</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Óptim</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">GeoR</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(vg1_T,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"h"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Semivarianza"</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.3</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">1.2</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Estimación teórica del modelo de semivariograma </span><span class="sc">\n</span><span class="st"> (optim)"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col.main =</span> <span class="st">"#36648B"</span>, <span class="at">cex.main =</span><span class="fl">1.3</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(range_sv_T, estsv_exp_Bess_T, <span class="at">col=</span><span class="st">"#FF4040"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(range_sv_T, estsv_exp_n_T, <span class="at">col=</span><span class="st">"#4169E1"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(range_sv_T, estsv_exp_h_n_T, <span class="at">col=</span><span class="st">"#008B00"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(range_sv_T, estsv_exp_MLE_T, <span class="at">col=</span><span class="st">"#FFA500"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">"Cressie"</span>, <span class="st">"1/n"</span>, <span class="st">"n/h"</span>, <span class="st">"MLE"</span>),<span class="co">#, "REML"),</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">3</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#FF4040"</span>, <span class="st">"#4169E1"</span>, <span class="st">"#008B00"</span>,<span class="st">"#FFA500"</span>),</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">box.col =</span> <span class="dv">9</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">text.col =</span> <span class="fu">c</span>(<span class="st">"#FF4040"</span>, <span class="st">"#4169E1"</span>, <span class="st">"#008B00"</span>,<span class="st">"#FFA500"</span>),</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex=</span><span class="dv">1</span>,</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">seg.len =</span> .<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Geo_uni_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>resumen_exp_T <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"Cressie"</span>, <span class="st">"$$1/n$$"</span>, <span class="st">"$$n/h$$"</span>, <span class="st">"MLE"</span>),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>(res_e_T<span class="sc">$</span>Bessel<span class="sc">$</span>Optimizados),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>(res_e_T<span class="sc">$</span><span class="st">`</span><span class="at">1/n</span><span class="st">`</span><span class="sc">$</span>Optimizados),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>(res_e_T<span class="sc">$</span><span class="st">`</span><span class="at">h/n</span><span class="st">`</span><span class="sc">$</span>Optimizados),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    MLE_eT<span class="sc">$</span>par[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>)]</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">MSE =</span> <span class="fu">c</span>(</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, res_e_T<span class="sc">$</span>Bessel<span class="sc">$</span>Optimizados, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"exponencial"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, res_e_T<span class="sc">$</span><span class="st">`</span><span class="at">1/n</span><span class="st">`</span><span class="sc">$</span>Optimizados, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"exponencial"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, res_e_T<span class="sc">$</span><span class="st">`</span><span class="at">h/n</span><span class="st">`</span><span class="sc">$</span>Optimizados, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"exponencial"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, <span class="fu">list</span>(<span class="at">nugget =</span> MLE_eT<span class="sc">$</span>par[<span class="dv">3</span>], <span class="at">phi =</span> MLE_eT<span class="sc">$</span>par[<span class="dv">2</span>] , <span class="at">sigma =</span> MLE_eT<span class="sc">$</span>par[<span class="dv">1</span>]), <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"exponencial"</span>, variog_T<span class="sc">$</span>h)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>resumen_exp_T <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(resumen_exp_T)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>resumen_exp_T[ , <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(resumen_exp_T[ , <span class="sc">-</span><span class="dv">1</span>], <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">as.numeric</span>(x), <span class="dv">3</span>))</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(resumen_exp_T, <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Método"</span>, <span class="st">"Nugget"</span>, <span class="st">"Sigma"</span>, <span class="st">"Phi"</span>, <span class="st">"MSE"</span>),</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">escape =</span> F, <span class="at">row.names =</span> F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Método</th>
<th style="text-align: right;">Nugget</th>
<th style="text-align: right;">Sigma</th>
<th style="text-align: right;">Phi</th>
<th style="text-align: right;">MSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cressie</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12.944</td>
<td style="text-align: right;">98216.23</td>
<td style="text-align: right;">3.591000e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math display">1/n</span></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11.178</td>
<td style="text-align: right;">74809.84</td>
<td style="text-align: right;">3.867000e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math display">n/h</span></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12.797</td>
<td style="text-align: right;">98765.53</td>
<td style="text-align: right;">3.465000e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">MLE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">31.706</td>
<td style="text-align: right;">109166.30</td>
<td style="text-align: right;">1.191489e+10</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>ini1_exp_T <span class="ot">&lt;-</span> <span class="fu">c</span>(sigma_0_eT, phi_0_eT)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>fitvar1_exp_T <span class="ot">&lt;-</span> <span class="fu">variofit</span>(vg1_T,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cov.model =</span> <span class="st">"exponential"</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                    ini1_exp_T,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fix.nugget =</span> F,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nugget =</span> nugget_0_eT,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">wei =</span> <span class="st">"equal"</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>fitvar2_exp_T <span class="ot">&lt;-</span> <span class="fu">variofit</span>(vg1_T,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cov.model =</span> <span class="st">"exponential"</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>                    ini1_exp_T,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fix.nugget =</span> F,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nugget =</span> nugget_0_eT,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">wei =</span> <span class="st">"npairs"</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>fitvar3_exp_T <span class="ot">&lt;-</span> <span class="fu">variofit</span>(vg1_T,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cov.model =</span> <span class="st">"exponential"</span>,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>                    ini1_exp_T,</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fix.nugget =</span>F,</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nugget =</span> nugget_0_eT,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">wei =</span> <span class="st">"cressie"</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>fitvar4_exp_T <span class="ot">&lt;-</span> <span class="fu">likfit</span>(temp,</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">coords =</span> temp<span class="sc">$</span>coords,</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> temp<span class="sc">$</span>data,</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trend =</span> <span class="sc">~</span> <span class="fu">poly</span>(Norte, <span class="dv">2</span>, <span class="at">raw =</span> <span class="cn">FALSE</span>),</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ini.cov.pars =</span> ini1_exp_T,</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fix.nugget =</span> F,</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nugget =</span> nugget_0_eT,</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cov.model =</span> <span class="st">"exponential"</span>,</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lik.method =</span> <span class="st">"ML"</span>)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(vg1_T,</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"h"</span>,</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Semivarianza"</span>,</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.3</span>,</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">1.2</span>,</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Estimación teórica del modelo de semivariograma </span><span class="sc">\n</span><span class="st"> (GeoR, gstat)"</span>,</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>     <span class="at">col.main =</span> <span class="st">"#36648B"</span>, <span class="at">cex.main =</span><span class="fl">1.3</span>)</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fitvar1_exp_T, <span class="at">col=</span><span class="st">"#FF4040"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fitvar2_exp_T, <span class="at">col=</span><span class="st">"#4169E1"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fitvar3_exp_T, <span class="at">col=</span><span class="st">"#008B00"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fitvar4_exp_T, <span class="at">col=</span><span class="st">"#FFA500"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">"MCO"</span>, <span class="st">"1/n"</span>, <span class="st">"Cressie"</span>, <span class="st">"MLE"</span>),<span class="co">#, "REML"),</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">3</span>,</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#FF4040"</span>, <span class="st">"#4169E1"</span>, <span class="st">"#008B00"</span>,<span class="st">"#FFA500"</span>),</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">box.col =</span> <span class="dv">9</span>,</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>       <span class="at">text.col =</span> <span class="fu">c</span>(<span class="st">"#FF4040"</span>, <span class="st">"#4169E1"</span>, <span class="st">"#008B00"</span>,<span class="st">"#FFA500"</span>),</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex=</span><span class="dv">1</span>,</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">seg.len =</span> .<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Geo_uni_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>par1Texp <span class="ot">&lt;-</span> <span class="fu">c</span>(fitvar1_exp_T<span class="sc">$</span>nugget, fitvar1_exp_T<span class="sc">$</span>cov.pars[<span class="dv">1</span>], fitvar1_exp_T<span class="sc">$</span>cov.pars[<span class="dv">2</span>])</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>par2Texp <span class="ot">&lt;-</span> <span class="fu">c</span>(fitvar2_exp_T<span class="sc">$</span>nugget, fitvar2_exp_T<span class="sc">$</span>cov.pars[<span class="dv">1</span>], fitvar2_exp_T<span class="sc">$</span>cov.pars[<span class="dv">2</span>])</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>par3Texp <span class="ot">&lt;-</span> <span class="fu">c</span>(fitvar3_exp_T<span class="sc">$</span>nugget, fitvar3_exp_T<span class="sc">$</span>cov.pars[<span class="dv">1</span>], fitvar3_exp_T<span class="sc">$</span>cov.pars[<span class="dv">2</span>])</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>par4Texp <span class="ot">&lt;-</span> <span class="fu">c</span>(fitvar4_exp_T<span class="sc">$</span>nugget, fitvar4_exp_T<span class="sc">$</span>cov.pars[<span class="dv">1</span>], fitvar4_exp_T<span class="sc">$</span>cov.pars[<span class="dv">2</span>])</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>resumen_exp_T2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"MCO"</span>, <span class="st">"$$1/n$$"</span>, <span class="st">"$$Cressie$$"</span>,<span class="st">"MLE"</span>),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    par1Texp,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    par2Texp,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    par3Texp,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    par4Texp</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">MSE =</span> <span class="fu">c</span>(</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, par1Texp, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"exponencial"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, par2Texp, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"exponencial"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, par3Texp, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"exponencial"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, par4Texp, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"exponencial"</span>, variog_T<span class="sc">$</span>h)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>resumen_exp_T2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(resumen_exp_T2)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>resumen_exp_T2[ , <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(resumen_exp_T2[ , <span class="sc">-</span><span class="dv">1</span>], <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">as.numeric</span>(x), <span class="dv">3</span>))</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(resumen_exp_T2, <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Método"</span>, <span class="st">"Nugget"</span>, <span class="st">"Sigma"</span>, <span class="st">"Phi"</span>, <span class="st">"MSE"</span>),</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">escape =</span> F, <span class="at">row.names =</span> F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Método</th>
<th style="text-align: right;">Nugget</th>
<th style="text-align: right;">Sigma</th>
<th style="text-align: right;">Phi</th>
<th style="text-align: right;">MSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MCO</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12.141</td>
<td style="text-align: right;">82253.55</td>
<td style="text-align: right;">3.184</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math display">1/n</span></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12.423</td>
<td style="text-align: right;">83939.23</td>
<td style="text-align: right;">3.243</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math display">Cressie</span></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">13.298</td>
<td style="text-align: right;">109166.30</td>
<td style="text-align: right;">4.009</td>
</tr>
<tr class="even">
<td style="text-align: left;">MLE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">23.536</td>
<td style="text-align: right;">75307.76</td>
<td style="text-align: right;">117.550</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Óptim</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">GeoR</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(vg1_T,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"h"</span>,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Semivarianza"</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.3</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">1.2</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Estimación teórica del modelo de semivariograma </span><span class="sc">\n</span><span class="st"> (optim)"</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col.main =</span> <span class="st">"#36648B"</span>, <span class="at">cex.main =</span><span class="fl">1.3</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(range_sv_T, estsv_g_Bess_T, <span class="at">col=</span><span class="st">"#FF4040"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(range_sv_T, estsv_g_n_T, <span class="at">col=</span><span class="st">"#4169E1"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(range_sv_T, estsv_g_h_n_T, <span class="at">col=</span><span class="st">"#008B00"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">"Cressie"</span>, <span class="st">"1/n"</span>, <span class="st">"n/h"</span>),<span class="co">#, "REML"),</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">3</span>,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#FF4040"</span>, <span class="st">"#4169E1"</span>, <span class="st">"#008B00"</span>),</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">box.col =</span> <span class="dv">9</span>,</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">text.col =</span> <span class="fu">c</span>(<span class="st">"#FF4040"</span>, <span class="st">"#4169E1"</span>, <span class="st">"#008B00"</span>),</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex=</span><span class="dv">1</span>,</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">seg.len =</span> .<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Geo_uni_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>resumen_g_T <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"Cressie"</span>, <span class="st">"$$1/n$$"</span>, <span class="st">"$$n/h$$"</span>),</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>(res_g_T<span class="sc">$</span>Bessel<span class="sc">$</span>Optimizados),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>(res_g_T<span class="sc">$</span><span class="st">`</span><span class="at">1/n</span><span class="st">`</span><span class="sc">$</span>Optimizados),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>(res_g_T<span class="sc">$</span><span class="st">`</span><span class="at">h/n</span><span class="st">`</span><span class="sc">$</span>Optimizados)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">MSE =</span> <span class="fu">c</span>(</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, res_g_T<span class="sc">$</span>Bessel<span class="sc">$</span>Optimizados, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"gaussian"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, res_g_T<span class="sc">$</span><span class="st">`</span><span class="at">1/n</span><span class="st">`</span><span class="sc">$</span>Optimizados, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"gaussian"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, res_g_T<span class="sc">$</span><span class="st">`</span><span class="at">h/n</span><span class="st">`</span><span class="sc">$</span>Optimizados, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"gaussian"</span>, variog_T<span class="sc">$</span>h)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>resumen_g_T <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(resumen_g_T)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>resumen_g_T[ , <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(resumen_g_T[ , <span class="sc">-</span><span class="dv">1</span>], <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">as.numeric</span>(x), <span class="dv">3</span>))</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(resumen_g_T, <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Método"</span>, <span class="st">"Nugget"</span>, <span class="st">"Sigma"</span>, <span class="st">"Phi"</span>, <span class="st">"MSE"</span>),</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">escape =</span> F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Método</th>
<th style="text-align: right;">Nugget</th>
<th style="text-align: right;">Sigma</th>
<th style="text-align: right;">Phi</th>
<th style="text-align: right;">MSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cressie</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12.053</td>
<td style="text-align: right;">74520.03</td>
<td style="text-align: right;">2.809</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math display">1/n</span></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11.126</td>
<td style="text-align: right;">69274.92</td>
<td style="text-align: right;">3.233</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math display">n/h</span></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11.620</td>
<td style="text-align: right;">72540.07</td>
<td style="text-align: right;">2.825</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ini1_g_T <span class="ot">&lt;-</span> <span class="fu">c</span>(sigma_0_gT, phi_0_gT)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>fitvar1_g_T <span class="ot">&lt;-</span> <span class="fu">variofit</span>(vg1_T,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cov.model =</span> <span class="st">"gaussian"</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                    ini1_g_T,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fix.nugget =</span> F,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nugget =</span> nugget_0_gT,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">wei =</span> <span class="st">"equal"</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>fitvar2_g_T <span class="ot">&lt;-</span> <span class="fu">variofit</span>(vg1_T,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cov.model =</span> <span class="st">"gaussian"</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                    ini1_g_T,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fix.nugget =</span> F,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nugget =</span> nugget_0_gT,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">wei =</span> <span class="st">"npairs"</span>)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>fitvar3_g_T <span class="ot">&lt;-</span> <span class="fu">variofit</span>(vg1_T,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cov.model =</span> <span class="st">"gaussian"</span>,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>                    ini1_g_T,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fix.nugget =</span> F,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nugget =</span> nugget_0_gT,</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">wei =</span> <span class="st">"cressie"</span>)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>fitvar4_g_T <span class="ot">&lt;-</span> <span class="fu">likfit</span>(temp,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">coords =</span> temp<span class="sc">$</span>coords,</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> temp<span class="sc">$</span>data,</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trend =</span> <span class="sc">~</span> <span class="fu">poly</span>(Norte, <span class="dv">2</span>, <span class="at">raw =</span> <span class="cn">FALSE</span>),</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ini.cov.pars =</span> ini1_g_T,</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fix.nugget =</span> F,</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nugget =</span> nugget_0_gT,</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cov.model =</span> <span class="st">"gaussian"</span>,</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lik.method =</span> <span class="st">"ML"</span>)</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(vg1_T,</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"h"</span>,</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Semivarianza"</span>,</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.3</span>,</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">1.2</span>,</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Estimación teórica del modelo de semivariograma </span><span class="sc">\n</span><span class="st"> (GeoR, gstat)"</span>,</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>     <span class="at">col.main =</span> <span class="st">"#36648B"</span>, <span class="at">cex.main =</span><span class="fl">1.3</span>)</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fitvar1_g_T, <span class="at">col=</span><span class="st">"#FF4040"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fitvar2_g_T, <span class="at">col=</span><span class="st">"#4169E1"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fitvar3_g_T, <span class="at">col=</span><span class="st">"#008B00"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fitvar4_g_T, <span class="at">col=</span><span class="st">"#FFA500"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">"MCO"</span>, <span class="st">"1/n"</span>, <span class="st">"Cressie"</span>, <span class="st">"MLE"</span>),<span class="co">#, "REML"),</span></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">3</span>,</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#FF4040"</span>, <span class="st">"#4169E1"</span>, <span class="st">"#008B00"</span>,<span class="st">"#FFA500"</span>),</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">box.col =</span> <span class="dv">9</span>,</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>       <span class="at">text.col =</span> <span class="fu">c</span>(<span class="st">"#FF4040"</span>, <span class="st">"#4169E1"</span>, <span class="st">"#008B00"</span>,<span class="st">"#FFA500"</span>),</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex=</span><span class="dv">1</span>,</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">seg.len =</span> .<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Geo_uni_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>par1Tg <span class="ot">&lt;-</span> <span class="fu">c</span>(fitvar1_g_T<span class="sc">$</span>nugget, fitvar1_g_T<span class="sc">$</span>cov.pars[<span class="dv">1</span>], fitvar1_g_T<span class="sc">$</span>cov.pars[<span class="dv">2</span>])</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>par2Tg <span class="ot">&lt;-</span> <span class="fu">c</span>(fitvar2_g_T<span class="sc">$</span>nugget, fitvar2_g_T<span class="sc">$</span>cov.pars[<span class="dv">1</span>], fitvar2_g_T<span class="sc">$</span>cov.pars[<span class="dv">2</span>])</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>par3Tg <span class="ot">&lt;-</span> <span class="fu">c</span>(fitvar3_g_T<span class="sc">$</span>nugget, fitvar3_g_T<span class="sc">$</span>cov.pars[<span class="dv">1</span>], fitvar3_g_T<span class="sc">$</span>cov.pars[<span class="dv">2</span>])</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>par4Tg <span class="ot">&lt;-</span> <span class="fu">c</span>(fitvar4_g_T<span class="sc">$</span>nugget, fitvar4_g_T<span class="sc">$</span>cov.pars[<span class="dv">1</span>], fitvar4_g_T<span class="sc">$</span>cov.pars[<span class="dv">2</span>])</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>resumen_g_T2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"MCO"</span>, <span class="st">"$$1/n$$"</span>, <span class="st">"$$Cressie$$"</span>,<span class="st">"MLE"</span>),</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    par1Tg,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    par2Tg,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    par3Tg,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    par4Tg</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">MSE =</span> <span class="fu">c</span>(</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, par1Tg, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"gaussian"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, par2Tg, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"gaussian"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, par3Tg, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"gaussian"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, par4Tg, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"gaussian"</span>, variog_T<span class="sc">$</span>h)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>resumen_g_T2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(resumen_g_T2)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>resumen_g_T2[ , <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(resumen_g_T2[ , <span class="sc">-</span><span class="dv">1</span>], <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">as.numeric</span>(x), <span class="dv">3</span>))</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(resumen_g_T2, <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Método"</span>, <span class="st">"Nugget"</span>, <span class="st">"Sigma"</span>, <span class="st">"Phi"</span>, <span class="st">"MSE"</span>),</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">escape =</span> F, <span class="at">row.names =</span> F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Método</th>
<th style="text-align: right;">Nugget</th>
<th style="text-align: right;">Sigma</th>
<th style="text-align: right;">Phi</th>
<th style="text-align: right;">MSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MCO</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">11.862</td>
<td style="text-align: right;">74341.86</td>
<td style="text-align: right;">2.776</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math display">1/n</span></td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">11.883</td>
<td style="text-align: right;">74575.03</td>
<td style="text-align: right;">2.777</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math display">Cressie</span></td>
<td style="text-align: right;">0.349</td>
<td style="text-align: right;">11.781</td>
<td style="text-align: right;">80000.00</td>
<td style="text-align: right;">2.835</td>
</tr>
<tr class="even">
<td style="text-align: left;">MLE</td>
<td style="text-align: right;">3.589</td>
<td style="text-align: right;">21.264</td>
<td style="text-align: right;">80000.00</td>
<td style="text-align: right;">155.000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Óptim</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">GeoR</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(vg1_T,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"h"</span>,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Semivarianza"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.3</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">1.2</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Estimación teórica del modelo de semivariograma </span><span class="sc">\n</span><span class="st"> (optim)"</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col.main =</span> <span class="st">"#36648B"</span>, <span class="at">cex.main =</span><span class="fl">1.3</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(range_sv_T, estsv_es_Bess_T, <span class="at">col=</span><span class="st">"#FF4040"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(range_sv_T, estsv_es_n_T, <span class="at">col=</span><span class="st">"#4169E1"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(range_sv_T, estsv_es_h_n_T, <span class="at">col=</span><span class="st">"#008B00"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(range_sv_T, estsv_es_MLE_T, <span class="at">col=</span><span class="st">"#FFA500"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">"Cressie"</span>, <span class="st">"1/n"</span>, <span class="st">"n/h"</span>, <span class="st">"MLE"</span>),<span class="co">#, "REML"),</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">3</span>,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#FF4040"</span>, <span class="st">"#4169E1"</span>, <span class="st">"#008B00"</span>,<span class="st">"#FFA500"</span>),</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">box.col =</span> <span class="dv">9</span>,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">text.col =</span> <span class="fu">c</span>(<span class="st">"#FF4040"</span>, <span class="st">"#4169E1"</span>, <span class="st">"#008B00"</span>,<span class="st">"#FFA500"</span>),</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex=</span><span class="dv">1</span>,</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">seg.len =</span> .<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Geo_uni_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>resumen_es_T <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"Cressie"</span>, <span class="st">"$$1/n$$"</span>, <span class="st">"$$n/h$$"</span>,<span class="st">"MLE"</span>),</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>(res_es_T<span class="sc">$</span>Bessel<span class="sc">$</span>Optimizados),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>(res_es_T<span class="sc">$</span><span class="st">`</span><span class="at">1/n</span><span class="st">`</span><span class="sc">$</span>Optimizados),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>(res_es_T<span class="sc">$</span><span class="st">`</span><span class="at">h/n</span><span class="st">`</span><span class="sc">$</span>Optimizados),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    MLE_esT<span class="sc">$</span>par[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>)]</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">MSE =</span> <span class="fu">c</span>(</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, res_es_T<span class="sc">$</span>Bessel<span class="sc">$</span>Optimizados, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"spherical"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, res_es_T<span class="sc">$</span><span class="st">`</span><span class="at">1/n</span><span class="st">`</span><span class="sc">$</span>Optimizados, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"spherical"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, res_es_T<span class="sc">$</span><span class="st">`</span><span class="at">h/n</span><span class="st">`</span><span class="sc">$</span>Optimizados, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"spherical"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, <span class="fu">list</span>(<span class="at">nugget =</span> MLE_esT<span class="sc">$</span>par[<span class="dv">3</span>], <span class="at">phi =</span> MLE_esT<span class="sc">$</span>par[<span class="dv">2</span>] , <span class="at">sigma =</span> MLE_esT<span class="sc">$</span>par[<span class="dv">1</span>]), <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"spherical"</span>, variog_T<span class="sc">$</span>h)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>resumen_es_T <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(resumen_es_T)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>resumen_es_T[ , <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(resumen_es_T[ , <span class="sc">-</span><span class="dv">1</span>], <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">as.numeric</span>(x), <span class="dv">3</span>))</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(resumen_es_T, <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Método"</span>, <span class="st">"Nugget"</span>, <span class="st">"Sigma"</span>, <span class="st">"Phi"</span>, <span class="st">"MSE"</span>),</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">escape =</span> F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Método</th>
<th style="text-align: right;">Nugget</th>
<th style="text-align: right;">Sigma</th>
<th style="text-align: right;">Phi</th>
<th style="text-align: right;">MSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cressie</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12.165</td>
<td style="text-align: right;">191573.0</td>
<td style="text-align: right;">3.044000e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math display">1/n</span></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11.128</td>
<td style="text-align: right;">165974.6</td>
<td style="text-align: right;">3.417000e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math display">n/h</span></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11.692</td>
<td style="text-align: right;">175441.3</td>
<td style="text-align: right;">2.976000e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">MLE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">27.958</td>
<td style="text-align: right;">157832.8</td>
<td style="text-align: right;">2.490774e+10</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ini1_es_T <span class="ot">&lt;-</span> <span class="fu">c</span>(sigma_0_esT, phi_0_esT)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>fitvar1_es_T <span class="ot">&lt;-</span> <span class="fu">variofit</span>(vg1_T,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cov.model =</span> <span class="st">"spherical"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>                    ini1_es_T,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fix.nugget =</span> F,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nugget =</span> nugget_0_esT,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">wei =</span> <span class="st">"equal"</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>fitvar2_es_T <span class="ot">&lt;-</span> <span class="fu">variofit</span>(vg1_T,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cov.model =</span> <span class="st">"spherical"</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>                    ini1_es_T,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fix.nugget =</span> F,</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nugget =</span> nugget_0_esT,</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">wei =</span> <span class="st">"npairs"</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>fitvar3_es_T <span class="ot">&lt;-</span> <span class="fu">variofit</span>(vg1_T,</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cov.model =</span> <span class="st">"spherical"</span>,</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>                    ini1_es_T,</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fix.nugget =</span> F,</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nugget =</span> nugget_0_esT,</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">wei =</span> <span class="st">"cressie"</span>)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>fitvar4_es_T <span class="ot">&lt;-</span> <span class="fu">likfit</span>(temp,</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">coords =</span> temp<span class="sc">$</span>coords,</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> temp<span class="sc">$</span>data,</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trend =</span> <span class="sc">~</span> <span class="fu">poly</span>(Norte, <span class="dv">2</span>, <span class="at">raw =</span> <span class="cn">FALSE</span>),</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ini.cov.pars =</span> ini1_es_T,</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fix.nugget =</span> F,</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nugget =</span> nugget_0_esT,</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cov.model =</span> <span class="st">"spherical"</span>,</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lik.method =</span> <span class="st">"ML"</span>)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(vg1_T,</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"h"</span>,</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Semivarianza"</span>,</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.3</span>,</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">1.2</span>,</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Estimación teórica del modelo de semivariograma </span><span class="sc">\n</span><span class="st"> (GeoR, gstat)"</span>,</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>     <span class="at">col.main =</span> <span class="st">"#36648B"</span>, <span class="at">cex.main =</span><span class="fl">1.3</span>)</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fitvar1_es_T, <span class="at">col=</span><span class="st">"#FF4040"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fitvar2_es_T, <span class="at">col=</span><span class="st">"#4169E1"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fitvar3_es_T, <span class="at">col=</span><span class="st">"#008B00"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fitvar4_es_T, <span class="at">col=</span><span class="st">"#FFA500"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">"MCO"</span>, <span class="st">"1/n"</span>, <span class="st">"Cressie"</span>, <span class="st">"MLE"</span>),<span class="co">#, "REML"),</span></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">3</span>,</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#FF4040"</span>, <span class="st">"#4169E1"</span>, <span class="st">"#008B00"</span>,<span class="st">"#FFA500"</span>),</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">box.col =</span> <span class="dv">9</span>,</span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>       <span class="at">text.col =</span> <span class="fu">c</span>(<span class="st">"#FF4040"</span>, <span class="st">"#4169E1"</span>, <span class="st">"#008B00"</span>,<span class="st">"#FFA500"</span>),</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex=</span><span class="dv">1</span>,</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">seg.len =</span> .<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Geo_uni_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>par1Tes <span class="ot">&lt;-</span> <span class="fu">c</span>(fitvar1_es_T<span class="sc">$</span>nugget, fitvar1_es_T<span class="sc">$</span>cov.pars[<span class="dv">1</span>], fitvar1_es_T<span class="sc">$</span>cov.pars[<span class="dv">2</span>])</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>par2Tes <span class="ot">&lt;-</span> <span class="fu">c</span>(fitvar2_es_T<span class="sc">$</span>nugget, fitvar2_es_T<span class="sc">$</span>cov.pars[<span class="dv">1</span>], fitvar2_es_T<span class="sc">$</span>cov.pars[<span class="dv">2</span>])</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>par3Tes <span class="ot">&lt;-</span> <span class="fu">c</span>(fitvar3_es_T<span class="sc">$</span>nugget, fitvar3_es_T<span class="sc">$</span>cov.pars[<span class="dv">1</span>], fitvar3_es_T<span class="sc">$</span>cov.pars[<span class="dv">2</span>])</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>par4Tes <span class="ot">&lt;-</span> <span class="fu">c</span>(fitvar4_es_T<span class="sc">$</span>nugget, fitvar4_es_T<span class="sc">$</span>cov.pars[<span class="dv">1</span>], fitvar4_es_T<span class="sc">$</span>cov.pars[<span class="dv">2</span>])</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>resumen_es_T2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"MCO"</span>, <span class="st">"$$1/n$$"</span>, <span class="st">"$$Cressie$$"</span>,<span class="st">"MLE"</span>),</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    par1Tes,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    par2Tes,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    par3Tes,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    par4Tes</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">MSE =</span> <span class="fu">c</span>(</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, par1Tes, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"spherical"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, par2Tes, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"spherical"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, par3Tes, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"spherical"</span>, variog_T<span class="sc">$</span>h),</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MSE_sv</span>(variog_T<span class="sc">$</span>gamma_hat, par4Tes, <span class="cn">NA</span>, <span class="at">model =</span> <span class="st">"spherical"</span>, variog_T<span class="sc">$</span>h)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>resumen_es_T2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(resumen_es_T2)</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>resumen_es_T2[ , <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(resumen_es_T2[ , <span class="sc">-</span><span class="dv">1</span>], <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">as.numeric</span>(x), <span class="dv">3</span>))</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(resumen_es_T2, <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Método"</span>, <span class="st">"Nugget"</span>, <span class="st">"Sigma"</span>, <span class="st">"Phi"</span>, <span class="st">"MSE"</span>),</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">escape =</span> F, <span class="at">row.names =</span> F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Método</th>
<th style="text-align: right;">Nugget</th>
<th style="text-align: right;">Sigma</th>
<th style="text-align: right;">Phi</th>
<th style="text-align: right;">MSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MCO</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11.878</td>
<td style="text-align: right;">171733.0</td>
<td style="text-align: right;">2.938</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math display">1/n</span></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11.898</td>
<td style="text-align: right;">166427.4</td>
<td style="text-align: right;">2.944</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math display">Cressie</span></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11.860</td>
<td style="text-align: right;">157832.8</td>
<td style="text-align: right;">2.977</td>
</tr>
<tr class="even">
<td style="text-align: left;">MLE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">25.641</td>
<td style="text-align: right;">144147.3</td>
<td style="text-align: right;">179.276</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>El modelo con menor MSE es el modelo Gausiano. Sin embargo, dada la inestabilidad numérica que se observa al realizar la predicción se opta por usar el modelo esférico obtenido por mínimos cuadrados ponderados usando la ponderación <span class="math inline">1/n</span>, que es el segundo mejor en términos del MSE.</p>
</section>
<section id="kriging" class="level3" data-number="3.1.4">
<h3 data-number="3.1.4" class="anchored" data-anchor-id="kriging"><span class="header-section-number">3.1.4</span> Kriging</h3>
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>best_model_T <span class="ot">&lt;-</span> gstat<span class="sc">::</span><span class="fu">vgm</span>(<span class="at">psill =</span> res_es_T<span class="sc">$</span><span class="st">`</span><span class="at">1/n</span><span class="st">`</span><span class="sc">$</span>Optimizados[<span class="dv">2</span>],</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">model =</span> <span class="st">"Sph"</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">range =</span> res_es_T<span class="sc">$</span><span class="st">`</span><span class="at">1/n</span><span class="st">`</span><span class="sc">$</span>Optimizados[<span class="dv">3</span>],</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">nugget =</span> res_es_T<span class="sc">$</span><span class="st">`</span><span class="at">1/n</span><span class="st">`</span><span class="sc">$</span>Optimizados[<span class="dv">1</span>]</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>sh_mundos_utm <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(sh_mundos, <span class="at">crs =</span> <span class="fu">CRS</span>(<span class="st">"EPSG:3310"</span>))</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> sp<span class="sc">::</span><span class="fu">spsample</span>(<span class="fu">as</span>(sh_mundos_utm, <span class="st">"Spatial"</span>), <span class="at">n =</span> <span class="dv">10000</span>, <span class="at">type =</span> <span class="st">"regular"</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="fu">proj4string</span>(new) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"EPSG:3310"</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(new) <span class="sc">~</span> Este <span class="sc">+</span> Norte</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>coordinates(new) ~ Este + Norte</code></pre>
</div>
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(new<span class="sc">@</span>coords) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Este"</span>, <span class="st">"Norte"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(datosT) <span class="ot">&lt;-</span> <span class="er">~</span>Este <span class="sc">+</span> Norte</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">proj4string</span>(datosT) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"EPSG:3310"</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>g_obj<span class="ot">&lt;-</span>gstat<span class="sc">::</span><span class="fu">gstat</span>(<span class="at">id=</span><span class="st">"Temperatura"</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">formula =</span> Temperatura <span class="sc">~</span> Norte <span class="sc">+</span> <span class="fu">I</span>(Norte<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">model =</span> best_model_T,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> datosT)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>sh_mundos_sp_utm <span class="ot">&lt;-</span> <span class="fu">as</span>(sh_mundos_utm, <span class="st">"Spatial"</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>predic <span class="ot">&lt;-</span> <span class="fu">predict</span>(g_obj, <span class="at">newdata =</span> new)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[using universal kriging]</code></pre>
</div>
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gridded</span>(predic) <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>predic_raster_utm <span class="ot">&lt;-</span> <span class="fu">raster</span>(predic, <span class="at">layer =</span> <span class="st">"Temperatura.pred"</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Asegurarse de que el CRS del ráster se asigne correctamente (EPSG:3310)</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">crs</span>(predic_raster_utm) <span class="ot">&lt;-</span> <span class="st">"+init=epsg:3310"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in CPL_crs_from_input(x): GDAL Message 1: +init=epsg:XXXX syntax is
deprecated. It might return a CRS with a non-EPSG compliant axis order.</code></pre>
</div>
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>sh_mundos_utm_simple <span class="ot">&lt;-</span> <span class="fu">st_union</span>(sh_mundos_utm)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>sh_mundos_sp_utm_simple <span class="ot">&lt;-</span> <span class="fu">as</span>(sh_mundos_utm_simple, <span class="st">"Spatial"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>predic_raster_wgs84 <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">projectRaster</span>(</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    raster<span class="sc">::</span><span class="fu">mask</span>(</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>        predic_raster_utm, </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>        sh_mundos_sp_utm_simple</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">crs =</span> <span class="st">"+init=epsg:4326"</span>, </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"bilinear"</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>bins <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>pred_range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">minValue</span>(predic_raster_wgs84), <span class="fu">maxValue</span>(predic_raster_wgs84))</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>pal_pred <span class="ot">&lt;-</span> <span class="fu">colorBin</span>(</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> <span class="st">"viridis"</span>, <span class="co"># La paleta de colores</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">domain =</span> pred_range,</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">bins =</span> bins,</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.color =</span> <span class="st">"transparent"</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>mapa_kriging_leaflet <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>CartoDB.Positron) <span class="sc">%&gt;%</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Añadir la capa ráster de Predicción Kriging</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addRasterImage</span>(</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>    predic_raster_wgs84, <span class="co"># Usamos el objeto raster reproyectado</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> pal_pred, </span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">opacity =</span> <span class="fl">0.7</span>,</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="st">"Predicción Kriging"</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Añadir el contorno de California</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>(</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> sh_mundos_wgs84,</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight =</span> <span class="dv">2</span>,</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="st">"Contorno"</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">addCircleMarkers</span>(<span class="at">data =</span> datosT_sf_wgs84,</span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fillColor =</span> <span class="sc">~</span><span class="fu">pal</span>(Temperatura),</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fillOpacity =</span> <span class="fl">0.8</span>,</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>                   <span class="at">weight =</span> <span class="dv">1</span>,</span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>                   <span class="at">radius =</span> <span class="dv">6</span>,</span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>                   <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"Temp:"</span>, Temperatura, <span class="st">"°C"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(</span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">pal =</span> pal_pred, </span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> pred_range,</span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicción T (°C)"</span>,</span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"topright"</span></span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(<span class="at">pal =</span> pal,</span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">values =</span> datosT_sf_wgs84<span class="sc">$</span>Temperatura,</span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">"Temperatura Observada"</span>,</span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"topleft"</span></span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Añadir controles de capas</span></span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLayersControl</span>(</span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">overlayGroups =</span> <span class="fu">c</span>(<span class="st">"Predicción Kriging"</span>, <span class="st">"Contorno"</span>, <span class="st">"Temperatura Observada"</span>),</span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">options =</span> <span class="fu">layersControlOptions</span>(<span class="at">collapsed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a>var_raster_utm <span class="ot">&lt;-</span> <span class="fu">raster</span>(predic, <span class="at">layer =</span> <span class="st">"Temperatura.var"</span>)</span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Asegurarse de que el CRS del ráster se asigne correctamente (EPSG:3310)</span></span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a><span class="fu">crs</span>(var_raster_utm) <span class="ot">&lt;-</span> <span class="st">"+init=epsg:3310"</span></span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a>var_raster_wgs84 <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">projectRaster</span>(</span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a>    raster<span class="sc">::</span><span class="fu">mask</span>(</span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a>        var_raster_utm, </span>
<span id="cb41-78"><a href="#cb41-78" aria-hidden="true" tabindex="-1"></a>        sh_mundos_sp_utm_simple</span>
<span id="cb41-79"><a href="#cb41-79" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-80"><a href="#cb41-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">crs =</span> <span class="st">"+init=epsg:4326"</span>, </span>
<span id="cb41-81"><a href="#cb41-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"bilinear"</span></span>
<span id="cb41-82"><a href="#cb41-82" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-83"><a href="#cb41-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-84"><a href="#cb41-84" aria-hidden="true" tabindex="-1"></a>binsv <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">30</span>, <span class="at">by=</span><span class="dv">5</span>)</span>
<span id="cb41-85"><a href="#cb41-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-86"><a href="#cb41-86" aria-hidden="true" tabindex="-1"></a>var_range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">minValue</span>(var_raster_wgs84), <span class="fu">maxValue</span>(var_raster_wgs84))</span>
<span id="cb41-87"><a href="#cb41-87" aria-hidden="true" tabindex="-1"></a>pal_var <span class="ot">&lt;-</span> <span class="fu">colorBin</span>(</span>
<span id="cb41-88"><a href="#cb41-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> <span class="st">"Spectral"</span>, <span class="co"># La paleta de colores</span></span>
<span id="cb41-89"><a href="#cb41-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">domain =</span> var_range,</span>
<span id="cb41-90"><a href="#cb41-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">bins =</span> binsv,</span>
<span id="cb41-91"><a href="#cb41-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.color =</span> <span class="st">"transparent"</span></span>
<span id="cb41-92"><a href="#cb41-92" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-93"><a href="#cb41-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-94"><a href="#cb41-94" aria-hidden="true" tabindex="-1"></a>mapa_var_leaflet <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-95"><a href="#cb41-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>CartoDB.Positron) <span class="sc">%&gt;%</span></span>
<span id="cb41-96"><a href="#cb41-96" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-97"><a href="#cb41-97" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Añadir la capa ráster de Predicción Kriging</span></span>
<span id="cb41-98"><a href="#cb41-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addRasterImage</span>(</span>
<span id="cb41-99"><a href="#cb41-99" aria-hidden="true" tabindex="-1"></a>    var_raster_wgs84, <span class="co"># Usamos el objeto raster reproyectado</span></span>
<span id="cb41-100"><a href="#cb41-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> pal_var, </span>
<span id="cb41-101"><a href="#cb41-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">opacity =</span> <span class="fl">0.7</span>,</span>
<span id="cb41-102"><a href="#cb41-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="st">"Predicción Kriging"</span></span>
<span id="cb41-103"><a href="#cb41-103" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-104"><a href="#cb41-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-105"><a href="#cb41-105" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Añadir el contorno de California</span></span>
<span id="cb41-106"><a href="#cb41-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>(</span>
<span id="cb41-107"><a href="#cb41-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> sh_mundos_wgs84,</span>
<span id="cb41-108"><a href="#cb41-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb41-109"><a href="#cb41-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight =</span> <span class="dv">2</span>,</span>
<span id="cb41-110"><a href="#cb41-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-111"><a href="#cb41-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="st">"Contorno"</span></span>
<span id="cb41-112"><a href="#cb41-112" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb41-113"><a href="#cb41-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-114"><a href="#cb41-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(</span>
<span id="cb41-115"><a href="#cb41-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">pal =</span> pal_var, </span>
<span id="cb41-116"><a href="#cb41-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> var_range,</span>
<span id="cb41-117"><a href="#cb41-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Varianza"</span>,</span>
<span id="cb41-118"><a href="#cb41-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"topright"</span></span>
<span id="cb41-119"><a href="#cb41-119" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-120"><a href="#cb41-120" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Añadir controles de capas</span></span>
<span id="cb41-121"><a href="#cb41-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLayersControl</span>(</span>
<span id="cb41-122"><a href="#cb41-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">overlayGroups =</span> <span class="fu">c</span>(<span class="st">"Varianza de pred"</span>, <span class="st">"Contorno"</span>),</span>
<span id="cb41-123"><a href="#cb41-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">options =</span> <span class="fu">layersControlOptions</span>(<span class="at">collapsed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-124"><a href="#cb41-124" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Predicción</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Varianza</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>mapa_kriging_leaflet</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-9f2ab8f6f96ebcfbf0f2" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9f2ab8f6f96ebcfbf0f2">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKIAAAC0CAYAAAAXffedAAAK4klEQVR4nO2dP4tVRxiH37sEtJG1CUSrJWKQtZItUgjpgoWk3DKLn0AwlZ2bziqBfAIxpXWKkE6wSLGkUiQS2TQasHFJkzTeFDJm7uz8n3dm3pnze+CC7L177/GeZ38z78ycOav1ek0A9Gar9wEAQAQRgRAgIhABRAQigIhABB/1+NAvt/bFleq/vHu06n0MSyZKRInigLkINs1LkXAp/0+peEXEyQGtQLECROAVER140AokIhABRAQiCIqI5hm0AIkIRAARgQggIhBBl7nmEFvXdq0/f/fbs8ZHAlrRVUSXcDmvh6Rj01TEVPFK3xtyjgOLiDUFK0HqcYHTBEW8sXdvjRMKaoOqGYgAIgIRBEX8+ehbTPGB6iARgQggIhBBUMQbe/dwuQCoDhIRiMArItIQtMI5oN1Twre7297nzz87aXQkoBVWEVtLGBLP9XoIOQ9d+4hvd7eTJTR/H8xBl2VgEAiYNE9ESAhsNEtECAh8NEnEHAlPLq0+PLjfG8jDmYhclWmqKDbx1M+2/8Cw5qxYRdTlsYkUIyeHgLbXQMY5Wbnus/L5199FnXFTyhoCmoRkzE1xLHnrh1NERayQOeRIqIhNxhQpIWI/gsXKrz9+U+Xk+CT859N/Tz1Sfl8HxcwYRFXN3DK6JHJJ53oOMs5D8wFtmzw+AW2vDb0fGI9oEX/98ZtVaTK6JEwFMs5Hs5mVFAmv7ryy/vzp8cWN3z378szG+2NoZ1ySm+acVOSQMPdzwBiIuVTg6s6roITm8znNOpBJVtOsJ0+oOYxJw5IUjAELaOVTnIipzWFpitWWFvQhS8Tnh3c27HPJGCMpp1i2dEYajkF2IqJ/BjjJEnHn4f01UbqMkBe4YKuazWa4dbMMxqbZ8A1XGuqD2iHQPxyH4pkVfYbDt5gBAB9VEzFlMUMsaM7nJEvE44O7G9FnWz+IFAQpiJniy8UnPNYhjsOQIrqaZyx6GJchRTRBN2B8uoqYMhRjEpuKaJ7HIHgVnw81w1JKSSWsy6wvlNXnnVPHE3E1X3tENM1cyehqolNTETvltqcoEYlkpCKRPRljUlG/caTtVm9IxzYUJ+Lxwd2VOa6YQ0kqEvEMdNvuZop0bANb03x8cHdVIgOHSOo9VBOtFy4oWmTD2kf86YsfxDRjsTLG3HkVqVgfEcUKJznJunVt98PDBWSsS3GxYiO1gKmxkEH1OVMKl1hQwPBTRURFrJC1VtRAxnEQIaIiRcj9C0cf/v3o9Z7zdTVlfLu7XW23tKUhqo+YO4Szf+FoQ0wdVNJjUFXEnPHFp8cXi4S0UVPGmhuZLonqiZg72M0tow/I2B9RTXMsIdlsz/tSkQgy9qaZiGdfnvE+bJRM++UkYypmsQMZ8xGViC4huaidikTvZYSQ6YgQ8fnhnZWS0EzI2qlYenmBawjoyuH3kDGBquOIJvrJ0cfzQlvXmeOLKc2ubYzRN7ZIlDe+aEvTk0urUxtWATtNRdTRmy+17bAppJJRFzGn72fKGBKRiEdG9f+BjGFENM1KhNZ7YLv6irm45OVaPDwz3UR0TY3pMqrEKl00axIzlVhauCi5leyQ0Y+IRCTaFNOXjL555Rx8qcg5BXh15xXdfHwbMjoQI6KJkpFjSMc3wK3jkpFTSMhop5uIN/burc8/OyH1uLF3b+1bycLdPOvoFbqrv5gjo63YIiJ68OL6+sGL6xBSo1vVTORe9ayfdL2vxV09E8VdF63jq6bVcbuOmej0cd+6/AQVNQltmvWTrQuhS5PTVww10WYypjTV5s9s11jbPh/J+J6uiUjkvxYkJ2FiCCUj0em+aezQ0smlVdb459KTUWQi+jCF4UxGMx1jEtL1fGo3YunJKFpE1UTXGOgOLaJVuIQ0H/rrYz4HbCJaxFhyxxZ9MoaENNGfz70YbMmp2Ow2uTGoLT9iLnrnQslok1kJZd6e10fpFYlKxqX1GbsnorosU993xtyDxtX34iR0AVbO3VNLWFo6dq+aFV9u7W8ciErFt7vbzkpUh7svxjWVWHpcS0lGMSISbcq4dW2X/vzqfHS/q1ZRUCIk1zEtQcbuTbPOL+8erYjeS6gPEPe8t4qvya7Nwbk3dHDuDb376zM5aVEJUSIS/S+jNFKFLJFXCagzu4yimmYfts673my2Tq1Qk10qooutT34X+YdairhETKHnYLEvIWse16zJOHQiKlQ6zTKL4UtEnZnScehENOFevS2dmdJRfCLefHx77Us6m3wzJGNsKhLNkYyiEzF3WT2ScTxEixhiacL5GF1G0SJKuksBqItoEYny+3ujp+XDvz9O/p2RU1HUMjBQji7jSEWM+ET0TfjPUB3XZKSlZOKHbxQpX2rN6beWpAzh2Hj498fDrNwRn4iKW5efrLi+1NH7jymMcjH/MCKCNHKKnZ4MJ2IoFWPTbkmpSCS/vziciERuGZcmVyqSm+khRbQxm4QlhUqoWZYo47Ai6qk4m4QtkCbjsCISvZexRMIZBR6tSFEMLeKslI4fxiIpFYcXEQsjypAi4/AiEkHGUiTIOIWIRHPJ2KOf11vGYeaaY0ld1S193jmlv8glcI/56WkSUTFTMhLFy8WZoj3ScbpEVMQmo/RE7E2rdJwuEQEvrdIRIgIRTCtibF9xxtkVblqk4rQiEs1XuMzMtMWKTkzhUrNocaXuiIVSreIFImr02P64xx9A6XHUkBEiGnDdySoFThlbHQu3jBDRQuzJ4Cx0SmXscSycMk5drOTy6PVe8MSazz89vlh0K99ckWKOtdWxlLCIRFTDDxx3qIq5oWTp5vMxidRKFt+xcCbiokQkqnMCuUW0sX/hqNuYZwsZF9c017hdhS5erVtx9Bx4b/HZ2ISJiZ73gtGx9VNrHtuDF9fXHKm4iKZZYU5VzTK9F1sk1eq7QsREZhCxpDInkivjokRU+Kpo84vuLWupeCYczbT5HXEk4uKKlVEoHZesifnHybGVySIT0YeU5ltJePblGSIK37A8Bu6ihbOZRtVsYH6Jty5vPp8iamggPISSUP27REYpVb0LNM2VMNPClh5qTNP23NWdVxviSZTQ9seV219E05xBzExNyaB5Tnq6+pMtklD9X0uKFohoYOt0277glMqbgxg5W0w12ti/cIThm1KUULcuP1n5Kj/XF21bYlZrsWvvoSQXHJdkLFpEUzyXjLF/7Tcf317rJ6XGRUemjL3HPbmuC1q0iESbsijh9JTkem9OuO9PXSIvRGSEa+Le9r7c79mCFDG5RMTwDfXZdIibg3Nv2Db47HF1IRKxMq1S0Sdh7gZNscmIYmUQbE0/t6AxaZgjZIyMHCKiaW6AlKa/xt7c6CMODue9BVNIlbFVfxEiViSm+ZWSljlw7i2EPmIlbIPlKa/PITbtUvuKZj+xxuZWSMRGhETjSMZRb/ZDBBGrkSOW6jeWSBmSsTQNa4GFsRUpEUoXILVgGDEZkYhC0fthNfa3iaHlZ0LEgWgppOtzau3Ci6pZMFI3GK0hI0QUTOq+jjqtNhzFMjDh6BLlnqwSEW245Cxt7jlkRNVciZ+++GFVKtLT44us151IvdSACIkomp2H94tPTu0LqNA0L4QUGfUL8s3roGsIibnmhWGTUZfOhe2ifC4huStniDgIVw6/zzpRrh0iUoWsfRcvFCsL5PjgrrilZ0jEgYhJxeeHd8RJFgNEBCLAXDMQAUQEIoCIQAQQEYgAIgIRQEQggv8A6jv/H2ozGtUAAAAASUVORK5CYII=",[[42.40486193660753,-124.8128902362941],[32.07286193660753,-113.1326902362941]],null,"Predicción Kriging",{"tileSize":256,"zIndex":1,"minZoom":0,"opacity":0.7}]},{"method":"addPolygons","args":[[[[{"lng":[-117.1223754882812,-117.1333312988281,-117.1827087402344,-117.2129135131836,-117.2123794555664,-117.2005081176758,-117.1740798950195,-117.1472244262695,-117.1156234741211,-117.1166534423828,-117.1413879394531,-117.2021560668945,-117.2288131713867,-117.2405471801758,-117.2420425415039,-117.2549896240234,-117.2684783935547,-117.26611328125,-117.2587661743164,-117.2803421020508,-117.2529220581055,-117.2490615844727,-117.25,-117.2698593139648,-117.3197326660156,-117.3294525146484,-117.3402862548828,-117.4094390869141,-117.480827331543,-117.495002746582,-117.6319427490234,-117.6725006103516,-117.7744369506836,-117.8638916015625,-117.8840179443359,-117.9108276367188,-117.9361114501953,-117.9550018310547,-117.9736175537109,-117.9949951171875,-118.0270843505859,-118.0452728271484,-118.0830688476562,-118.1081848144531,-118.1347427368164,-118.2222213745117,-118.2671279907227,-118.272087097168,-118.2977752685547,-118.3180694580078,-118.400016784668,-118.4174652099609,-118.3986206054688,-118.3861846923828,-118.4211044311523,-118.432502746582,-118.4544525146484,-118.4711227416992,-118.508903503418,-118.5300064086914,-118.554443359375,-118.6549987792969,-118.6977691650391,-118.7525024414062,-118.7811126708984,-118.8364028930664,-118.9361114501953,-118.9614028930664,-118.9811096191406,-119.1291732788086,-119.1743011474609,-119.2196502685547,-119.2558441162109,-119.3124694824219,-119.4161071777344,-119.446662902832,-119.5416717529297,-119.5772171020508,-119.5997314453125,-119.6247100830078,-119.7986068725586,-120.0037460327148,-120.1308288574219,-120.245002746582,-120.3550033569336,-120.4241561889648,-120.4490280151367,-120.4819412231445,-120.4953460693359,-120.5583267211914,-120.5831909179688,-120.605827331543,-120.6259613037109,-120.6283264160156,-120.623893737793,-120.6033248901367,-120.5941696166992,-120.5913772583008,-120.5980606079102,-120.6247100830078,-120.6137466430664,-120.6000671386719,-120.6181945800781,-120.6805572509766,-120.7186813354492,-120.7385330200195,-120.8313903808594,-120.8567962646484,-120.8697280883789,-120.8681945800781,-120.8591613769531,-120.8411102294922,-120.9199981689453,-120.9770812988281,-120.9994506835938,-121.0477752685547,-121.1666564941406,-121.2687530517578,-121.29638671875,-121.3215408325195,-121.3680572509766,-121.4349899291992,-121.4418029785156,-121.4609680175781,-121.4720840454102,-121.6654205322266,-121.7580642700195,-121.7961044311523,-121.8676300048828,-121.8641662597656,-121.8734664916992,-121.8847427368164,-121.8976440429688,-121.9216613769531,-121.9432525634766,-121.8997955322266,-121.8656158447266,-121.8450012207031,-121.8255615234375,-121.8091506958008,-121.7993087768555,-121.7747192382812,-121.7639007568359,-121.7991638183594,-121.8511123657227,-121.8791656494141,-121.9135971069336,-121.9783325195312,-122.0202865600586,-122.0415191650391,-122.0709762573242,-122.1472320556641,-122.1795806884766,-122.379020690918,-122.3883438110352,-122.393684387207,-122.3844528198242,-122.3731918334961,-122.378044128418,-122.4259719848633,-122.4433288574219,-122.4806137084961,-122.4902801513672,-122.4958267211914,-122.4994430541992,-122.4905471801758,-122.4843063354492,-122.4481201171875,-122.379638671875,-122.359992980957,-122.3513870239258,-122.35693359375,-122.3673553466797,-122.3577728271484,-122.0643005371094,-122.0231857299805,-122.0058364868164,-122.0297164916992,-122.0808334350586,-122.1259689331055,-122.1308288574219,-122.1384811401367,-122.1572265625,-122.1747131347656,-122.2427673339844,-122.2999877929688,-122.3934097290039,-122.352783203125,-122.2252731323242,-122.1633224487305,-122.1277313232422,-122.0158386230469,-121.9894409179688,-121.9155578613281,-121.8572235107422,-121.8337554931641,-121.6848526000977,-121.6541976928711,-121.6434936523438,-121.5911102294922,-121.498046875,-121.4272155761719,-121.4705505371094,-121.5531921386719,-121.5850067138672,-121.6622161865234,-121.6852188110352,-121.7229156494141,-121.8186798095703,-121.9052734375,-121.977783203125,-122.0186233520508,-122.0500030517578,-122.109733581543,-122.2641830444336,-122.2920837402344,-122.311393737793,-122.3652801513672,-122.3908386230469,-122.4783248901367,-122.479866027832,-122.4433288574219,-122.4201354980469,-122.456672668457,-122.505485534668,-122.6566619873047,-122.7822875976562,-122.8169631958008,-122.8966674804688,-122.9283294677734,-122.9563903808594,-122.9269409179688,-122.8399963378906,-122.8030471801758,-122.8077697753906,-122.83056640625,-122.9586181640625,-123.1072235107422,-123.1290283203125,-123.1716613769531,-123.2372131347656,-123.2666625976562,-123.3130645751953,-123.3530578613281,-123.4475021362305,-123.5361175537109,-123.620002746582,-123.7015228271484,-123.7072601318359,-123.6745834350586,-123.6669387817383,-123.6861038208008,-123.712646484375,-123.7541809082031,-123.7957000732422,-123.7956924438477,-123.774169921875,-123.7630615234375,-123.7368698120117,-123.7723617553711,-123.8202819824219,-123.8674926757812,-123.9311065673828,-124.0623550415039,-124.0927734375,-124.1525726318359,-124.2022171020508,-124.297233581543,-124.331184387207,-124.3240356445312,-124.3233413696289,-124.3543090820312,-124.3758239746094,-124.3523559570312,-124.3319473266602,-124.2750091552734,-124.2529144287109,-124.2294464111328,-124.1994323730469,-124.14306640625,-124.0988922119141,-124.0993041992188,-124.1125030517578,-124.1222229003906,-124.0909729003906,-124.061393737793,-124.0458374023438,-124.0399932861328,-124.0467987060547,-124.063606262207,-124.1186065673828,-124.1813812255859,-124.2155609130859,-124.1973571777344,-124.1902770996094,-124.1752777099609,-124.1841583251953,-124.1858520507812,-123.9505615234375,-123.883903503418,-123.5336227416992,-123.4836120605469,-123.4169464111328,-123.366943359375,-123.3169631958008,-123.2669525146484,-123.2169494628906,-123.1669464111328,-123.116943359375,-123.0669631958008,-122.8999862670898,-122.8177795410156,-122.7508392333984,-122.6341705322266,-122.600830078125,-122.5175018310547,-122.2172164916992,-122.1505584716797,-122.1172180175781,-122.0005569458008,-121.9669494628906,-121.8836212158203,-121.8002777099609,-121.7169494628906,-121.6677703857422,-121.5341567993164,-121.4841613769531,-121.4341583251953,-121.3008270263672,-121.1838836669922,-121.133903503418,-121.0672302246094,-120.9169464111328,-120.8510971069336,-120.7677764892578,-120.6841583251953,-120.3208236694336,-120.0341567993164,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.001106262207,-119.8197326660156,-119.5155563354492,-119.0130615234375,-118.8799896240234,-118.3752670288086,-118.2108306884766,-117.8919525146484,-117.7452697753906,-117.5747222900391,-117.4211120605469,-117.2677764892578,-117.1069488525391,-116.946662902832,-116.8027801513672,-116.6513977050781,-116.4924926757812,-116.1999969482422,-116.0269470214844,-115.8622131347656,-115.7527923583984,-115.5580368041992,-115.2555694580078,-115.1241607666016,-114.9933319091797,-114.6563873291016,-114.6219329833984,-114.6197128295898,-114.5563812255859,-114.4933319091797,-114.4561233520508,-114.4188766479492,-114.3781890869141,-114.3695068359375,-114.3358306884766,-114.2726440429688,-114.230827331543,-114.2005615234375,-114.1700668334961,-114.1516723632812,-114.1344528198242,-114.1170120239258,-114.2226409912109,-114.3141632080078,-114.3576278686523,-114.3834762573242,-114.4070892333984,-114.4207611083984,-114.4554061889648,-114.4755630493164,-114.5127868652344,-114.5233306884766,-114.510009765625,-114.4941635131836,-114.48388671875,-114.5275039672852,-114.6404876708984,-114.7255630493164,-114.7260971069336,-114.7038879394531,-114.6836090087891,-114.6681900024414,-114.6752777099609,-114.6965179443359,-114.6970748901367,-114.6788787841797,-114.6626281738281,-114.6029205322266,-114.5701370239258,-114.5452728271484,-114.5153503417969,-114.4644470214844,-114.4587478637695,-114.5352096557617,-114.5541687011719,-114.5844497680664,-114.6125030517578,-114.6526412963867,-114.6955490112305,-114.7190933227539,-114.7297973632812,-114.8713455200195,-115.0258941650391,-115.2024993896484,-115.404167175293,-115.6055603027344,-115.9077835083008,-116.2426376342773,-116.5081481933594,-116.7130584716797,-116.9141693115234,-117.0952911376953,-117.1223754882812],"lat":[32.53533172607422,32.56582641601562,32.65929412841797,32.68302917480469,32.69705581665039,32.69759368896484,32.6749382019043,32.61860275268555,32.62131118774414,32.64249420166016,32.68061447143555,32.72769546508789,32.71561431884766,32.68464279174805,32.66253280639648,32.65713882446289,32.68842315673828,32.70860290527344,32.77041625976562,32.82921600341797,32.86082458496094,32.87129211425781,32.88971710205078,32.97707366943359,33.10527038574219,33.12443542480469,33.14166259765625,33.24415588378906,33.32749176025391,33.34221649169922,33.44276428222656,33.47054290771484,33.53943634033203,33.59568405151367,33.60055160522461,33.60665893554688,33.62054443359375,33.63276672363281,33.64554595947266,33.66249084472656,33.69401931762695,33.70943450927734,33.73971557617188,33.75693893432617,33.76666259765625,33.78416442871094,33.75777435302734,33.72332000732422,33.71610260009766,33.7208251953125,33.74985504150391,33.78179931640625,33.80804443359375,33.84096527099609,33.92124557495117,33.93915557861328,33.96776580810547,33.98777008056641,34.03110504150391,34.04791259765625,34.05568695068359,34.0494384765625,34.04610443115234,34.03971862792969,34.03318786621094,34.03054809570312,34.05554962158203,34.06221008300781,34.06749725341797,34.11388397216797,34.1361083984375,34.16492080688477,34.22346115112305,34.28351593017578,34.35749816894531,34.37332153320312,34.41415405273438,34.42054748535156,34.42360687255859,34.42471313476562,34.42638397216797,34.4679069519043,34.47873687744141,34.47360229492188,34.46582794189453,34.45610046386719,34.4556884765625,34.50957489013672,34.53047561645508,34.56193542480469,34.56221389770508,34.55860137939453,34.58443832397461,34.62360382080078,34.64110565185547,34.66943740844727,34.69026947021484,34.71082305908203,34.8608283996582,34.89499664306641,35.01860427856445,35.10005950927734,35.13943862915039,35.17110443115234,35.18054580688477,35.16464233398438,35.20999145507812,35.22880935668945,35.25722122192383,35.27999496459961,35.3074951171875,35.35527038574219,35.44887542724609,35.46596145629883,35.47915649414062,35.52499008178711,35.64916229248047,35.70013046264648,35.76610565185547,35.79402542114258,35.82916259765625,35.8942985534668,35.92804718017578,35.97943496704102,35.99777221679688,36.18304443359375,36.22943496704102,36.24110412597656,36.31533813476562,36.3429069519043,36.39388656616211,36.43387603759766,36.46735382080078,36.51805114746094,36.59457397460938,36.64124298095703,36.61985397338867,36.61513137817383,36.6270751953125,36.64846420288086,36.66790771484375,36.75916290283203,36.81249237060547,36.88401794433594,36.95068740844727,36.97248840332031,36.9803352355957,36.96915435791016,36.95485305786133,36.95415878295898,36.96235275268555,36.99582672119141,37.01763153076172,37.19998931884766,37.22026824951172,37.25186538696289,37.28971862792969,37.32915878295898,37.37443542480469,37.48429489135742,37.50436782836914,37.5122184753418,37.52999114990234,37.56610107421875,37.58998870849609,37.75222015380859,37.78992462158203,37.81005859375,37.81381225585938,37.78693771362305,37.73165893554688,37.68762969970703,37.65443420410156,37.61582565307617,37.45929718017578,37.45790863037109,37.47137451171875,37.47943115234375,37.51027297973633,37.6027717590332,37.6322135925293,37.66221618652344,37.69470977783203,37.71471405029297,37.76666259765625,37.82638549804688,37.95915985107422,37.99082946777344,38.06415939331055,38.04743576049805,38.03526306152344,38.06610107421875,38.06554412841797,38.05416107177734,38.04305267333984,38.03666305541992,38.01811599731445,38.04861831665039,38.0789909362793,38.10464859008789,38.04888153076172,38.01290893554688,38.05499267578125,38.11041259765625,38.11568832397461,38.09658813476562,38.06646728515625,38.04746627807617,38.08115386962891,38.06610107421875,38.09721374511719,38.14811325073242,38.10877990722656,38.06137847900391,38.10999298095703,38.12693405151367,38.1361083984375,38.15554809570312,38.14749145507812,38.11957168579102,37.9366569519043,37.90693664550781,37.88318634033203,37.83346557617188,37.83103942871094,37.91054534912109,38.00131607055664,38.02027130126953,38.05443572998047,38.05360412597656,38.05804443359375,38.16249084472656,38.10777282714844,38.08193969726562,38.09498977661133,38.12748718261719,38.28527069091797,38.46277236938477,38.47290802001953,38.49193572998047,38.52276611328125,38.54083251953125,38.57388305664062,38.62443542480469,38.7340202331543,38.79610443115234,38.86082458496094,38.93041229248047,38.97109985351562,39.00458145141602,39.02554702758789,39.1219367980957,39.17804718017578,39.25943756103516,39.35332489013672,39.38582611083984,39.49652099609375,39.51915740966797,39.55499267578125,39.70971298217773,39.79166412353516,39.86915588378906,39.94971466064453,40.09165954589844,40.11631011962891,40.14790725708008,40.17416381835938,40.23804473876953,40.27245712280273,40.31193542480469,40.33624267578125,40.41526794433594,40.44769668579102,40.5322151184082,40.5816650390625,40.6947135925293,40.724365234375,40.74638366699219,40.74554443359375,40.81193542480469,40.99193572998047,41.03853607177734,41.0574951171875,41.15749359130859,41.24985504150391,41.34415435791016,41.39443969726562,41.42777252197266,41.46318435668945,41.51527404785156,41.68305206298828,41.75416564941406,41.81999206542969,41.84804916381836,41.86943817138672,41.94971466064453,41.99415588378906,41.99946594238281,42,42,42,42,42,42,42,42,42,42,42,42,42,42,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,42,42,42,42,42,42,42,42,42,42,42,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99964904785156,42,41.99943542480469,40.43305206298828,39.84943389892578,39.56610107421875,39.44971466064453,39.33332824707031,39.00721740722656,38.88276672363281,38.67276763916016,38.32054901123047,38.22609710693359,37.86527252197266,37.74638366699219,37.51416015625,37.40665435791016,37.28110504150391,37.16721343994141,37.05304718017578,36.93276977539062,36.81221008300781,36.70360565185547,36.58860015869141,36.46749114990234,36.24276733398438,36.10888671875,35.98081970214844,35.89499664306641,35.74221801757812,35.50277709960938,35.39804840087891,35.29332733154297,35.02165985107422,34.99214935302734,34.88193511962891,34.81666564941406,34.75833129882812,34.69860076904297,34.63166046142578,34.55082702636719,34.52193832397461,34.46415710449219,34.41582489013672,34.38999176025391,34.37276458740234,34.35867691040039,34.34276580810547,34.32332611083984,34.28804779052734,34.19624328613281,34.14665985107422,34.12568283081055,34.11429977416992,34.09207153320312,34.03013229370117,34.00124359130859,33.98721313476562,33.96152114868164,33.94415283203125,33.86888122558594,33.78305053710938,33.72193145751953,33.55929946899414,33.42033767700195,33.39916229248047,33.31888580322266,33.28054809570312,33.24638366699219,33.20901870727539,33.15541076660156,33.115478515625,33.08943557739258,33.06137847900391,33.04374313354492,33.02971267700195,33.03360748291016,33.03471755981445,33.02554702758789,32.97165679931641,32.86235046386719,32.73200607299805,32.72499084472656,32.72568511962891,32.73110198974609,32.74179840087891,32.74096298217773,32.71845626831055,32.71771240234375,32.70785140991211,32.69698715209961,32.68444061279297,32.66971588134766,32.65471649169922,32.63194274902344,32.60577011108398,32.58499908447266,32.568603515625,32.55221557617188,32.53665924072266,32.53533172607422]}],[{"lng":[-119.8680572509766,-119.6983337402344,-119.5936126708984,-119.5631866455078,-119.5527801513672,-119.5155639648438,-119.5329895019531,-119.5899963378906,-119.7133331298828,-119.7727813720703,-119.788330078125,-119.8369369506836,-119.8709716796875,-119.9177703857422,-119.9142303466797,-119.8680572509766],"lat":[34.08415985107422,34.04527282714844,34.05387878417969,34.06583023071289,34.06582641601562,34.04457855224609,34.01513290405273,33.99721527099609,33.97082138061523,33.96720886230469,33.96720886230469,33.97415924072266,33.99151992797852,34.06526947021484,34.0826301574707,34.08415985107422]}],[{"lng":[-120,-119.9694442749023,-119.9663925170898,-120.0365295410156,-120.1074981689453,-120.1216583251953,-120.1452789306641,-120.164436340332,-120.172233581543,-120.1922073364258,-120.2260971069336,-120.1847229003906,-120.135009765625,-120.0519409179688,-120.0352783203125,-120],"lat":[33.98963165283203,33.99235534667969,33.96249008178711,33.91915893554688,33.90554809570312,33.90804290771484,33.91666412353516,33.92777252197266,33.93471527099609,33.95943450927734,34.006103515625,34.01583099365234,34.02610015869141,34.03610992431641,34.02388000488281,33.98963165283203]}],[{"lng":[-118.5166625976562,-118.4452667236328,-118.4033432006836,-118.3497314453125,-118.297233581543,-118.2931213378906,-118.3037414550781,-118.4496459960938,-118.5899276733398,-118.5811233520508,-118.5418014526367,-118.5288925170898,-118.5166625976562],"lat":[33.47776794433594,33.44276428222656,33.42804718017578,33.39833068847656,33.34609985351562,33.32867431640625,33.30985260009766,33.32860565185547,33.48381042480469,33.49082946777344,33.48943710327148,33.48624420166016,33.47776794433594]}],[{"lng":[-118.5302886962891,-118.5261077880859,-118.5202789306641,-118.504997253418,-118.4822235107422,-118.413330078125,-118.3691635131836,-118.3694534301758,-118.4086074829102,-118.477783203125,-118.4869384765625,-118.4938812255859,-118.5338897705078,-118.570556640625,-118.5948638916016,-118.5938949584961,-118.5544281005859,-118.5302886962891],"lat":[32.99332427978516,32.98360443115234,32.97499084472656,32.959716796875,32.93804168701172,32.88555145263672,32.85471343994141,32.83277130126953,32.81707763671875,32.85277557373047,32.85888671875,32.86666107177734,32.92721557617188,32.98416137695312,33.03305053710938,33.04458236694336,33.04305267333984,32.99332427978516]}]]],null,"Contorno",{"interactive":true,"className":"","stroke":true,"color":"black","weight":2,"opacity":0.5,"fill":false,"fillColor":"black","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[[38.342606,38.690757,39.76168,39.32756,38.20185,39.18919,38.94498,36.7056,36.78538,36.8414,36.6324,36.71088,36.5975,36.819199,39.53387,37.360701,36.3261,36.3663,36.3619,36.5432,36.4581,36.5092,36.4878,36.5975,37.3667,37.0056,35.345607,35.0544,35.356615,35.438035,34.8416,35.3313,35.23918,36.102219,36.3144,34.1439,34.051097,34.066429,34.1992,33.9014,34.010283,34.13263,33.859662,34.3833,36.8669,36.9533,37.713299,39.150478,39.145733,39.43734,37.645718,37.962069,38.0697,36.48187,36.209286,36.694261,39.234402,39.3386,33.830586,33.819305,33.925062,38.74643,39.9395,40.301899,39.8134,33.7472,33.920758,33.583099,33.572019,33.852605,33.999449,33.996387,33.676535,38.613804,38.56844,38.302591,38.683304,38.593328,36.843425,36.485001,34.894054,34.243132,34.068114,34.0309,34.510955,35.774455,34.100132,34.416506,34.059626,34.0714,34.106678,37.8027,37.6825,35.614668,34.42775,34.7256,34.5414,34.402802,34.4897,34.637798,34.445301,36.98332,37.06315,40.5403,37.642165,37.4883,39.13868,36.489399,36.0319,34.21017,34.40428,34.44806,34.27632,34.25239,38.53455,36.280596,36.607215,35.04944,33.793713,34.181977,39.39861,36.841488,32.72519],[-120.764426,-120.072682,-121.84047,-121.66881,-120.680277,-121.99887,-119.97061,-119.7414,-119.77321,-119.8744,-120.3822,-119.77743,-119.5036,-119.7164,-122.190834,-118.330835,-117.9551,-117.8976,-118.0108,-117.9418,-117.8519,-116.8481,-117.871,-118.04,-118.4167,-118.2936,-118.851825,-119.4039,-119.062613,-119.016787,-118.8647,-119,-118.78863,-119.566002,-119.6436,-117.8508,-118.456386,-118.226755,-118.5331,-118.205,-118.068484,-118.127142,-118.200707,-118.5283,-120.01,-120.0341,-119.7061,-123.206528,-123.202995,-123.78766,-118.966515,-119.120278,-118.9477,-121.73333,-121.126371,-121.623271,-121.055603,-120.170303,-117.938509,-117.918759,-117.952586,-121.26498,-120.9443,-121.235001,-120.4707,-115.8201,-116.858419,-117.072197,-116.063823,-116.540965,-117.415831,-117.4925,-117.331027,-121.368007,-121.49311,-121.420838,-121.164457,-121.503728,-121.3621,-121.155602,-117.024756,-117.272275,-117.525796,-117.617403,-117.32555,-117.372109,-117.491982,-117.285602,-117.147347,-116.3906,-117.274063,-121.2208,-121.4406,-120.656912,-119.69091,-120.4278,-119.7906,-119.457497,-120.0458,-120.456703,-119.827797,-121.98822,-122.083092,-121.5764,-120.994212,-120.8358,-121.61884,-118.826897,-119.055,-118.87051,-118.80998,-119.2313,-118.68369,-119.14318,-121.7734,-118.011661,-118.05473,-118.18893,-118.171019,-118.363036,-123.35872,-121.533444,-116.36441],6,null,null,{"interactive":true,"className":"","stroke":true,"color":"black","weight":1,"opacity":0.5,"fill":true,"fillColor":["#98D83E","#30B57B","#9DD93B","#92D742","#9CD93B","#9CD93B","#3FBC73","#CAE11F","#D0E11C","#CAE11F","#C0DF25","#D9E319","#C6E021","#C8E020","#A3DA37","#B8DE29","#BCDF26","#BCDF26","#B8DE29","#C5E021","#BADE28","#FDE725","#BADE28","#C5E021","#ACDC31","#440154","#CAE11F","#C7E020","#D8E219","#CAE11F","#86D549","#D5E21A","#D0E11C","#C2DF23","#C9E020","#B1DD2E","#B1DD2E","#B4DE2C","#B2DD2D","#B4DE2C","#BBDE27","#ACDC31","#BEDF26","#A5DB36","#C6E021","#C9E020","#5DC863","#8AD547","#8ED645","#8CD646","#3EBC73","#57C666","#5BC864","#ABDC31","#ADDC30","#BEDF26","#66CB5D","#3ABA76","#B9DE29","#C3DF22","#C2DF23","#9CD93C","#69CD5B","#54C568","#53C568","#BADE28","#A6DB35","#B1DD2E","#FDE725","#DBE319","#C0DF25","#BEDF26","#B2DD2D","#A4DB36","#A6DB35","#ACDC31","#99D83D","#A3DA37","#A8DB34","#9DD93B","#BCDF26","#65CB5E","#BBDE27","#C0DF25","#94D741","#E0E318","#BADE28","#8FD744","#B3DD2C","#89D548","#BEDF26","#B7DE2A","#C1DF24","#99D83D","#B2DD2D","#A6DB35","#9AD93D","#A1DA38","#95D840","#BDDF26","#B8DE29","#96D83F","#2AB07F","#65CB5E","#B6DE2A","#AFDD2F","#95D840","#AFDD2F","#C9E020","#9ED93A","#A6DB35","#A1DA38","#9DD93B","#B3DD2C","#9CD93C","#B3DD2C","#C5E021","#A1DA38","#BADE28","#AFDD2F","#66CB5D","#B2DD2D","#76D153"],"fillOpacity":0.8},null,null,["Temp: 12.9 °C","Temp: -1.8 °C","Temp: 13.5 °C","Temp: 12.2 °C","Temp: 13.4 °C","Temp: 13.4 °C","Temp: 1 °C","Temp: 18.5 °C","Temp: 19.1 °C","Temp: 18.6 °C","Temp: 17.4 °C","Temp: 20.2 °C","Temp: 18.1 °C","Temp: 18.3 °C","Temp: 14.2 °C","Temp: 16.5 °C","Temp: 17 °C","Temp: 17 °C","Temp: 16.5 °C","Temp: 18 °C","Temp: 16.7 °C","Temp: 24.5 °C","Temp: 16.8 °C","Temp: 18 °C","Temp: 15.2 °C","Temp: -51.3 °C","Temp: 18.6 °C","Temp: 18.2 °C","Temp: 20 °C","Temp: 18.5 °C","Temp: 10.8 °C","Temp: 19.7 °C","Temp: 19.2 °C","Temp: 17.6 °C","Temp: 18.4 °C","Temp: 15.7 °C","Temp: 15.8 °C","Temp: 16.1 °C","Temp: 15.9 °C","Temp: 16.1 °C","Temp: 16.9 °C","Temp: 15.2 °C","Temp: 17.2 °C","Temp: 14.4 °C","Temp: 18.1 °C","Temp: 18.4 °C","Temp: 5.6 °C","Temp: 11.2 °C","Temp: 11.7 °C","Temp: 11.5 °C","Temp: 0.9 °C","Temp: 4.7 °C","Temp: 5.3 °C","Temp: 15.1 °C","Temp: 15.3 °C","Temp: 17.2 °C","Temp: 6.8 °C","Temp: 0.1 °C","Temp: 16.6 °C","Temp: 17.8 °C","Temp: 17.6 °C","Temp: 13.3 °C","Temp: 7.2 °C","Temp: 4.3 °C","Temp: 4.2 °C","Temp: 16.7 °C","Temp: 14.5 °C","Temp: 15.8 °C","Temp: 24.5 °C","Temp: 20.4 °C","Temp: 17.4 °C","Temp: 17.2 °C","Temp: 15.9 °C","Temp: 14.3 °C","Temp: 14.5 °C","Temp: 15.2 °C","Temp: 13 °C","Temp: 14.2 °C","Temp: 14.7 °C","Temp: 13.5 °C","Temp: 17 °C","Temp: 6.7 °C","Temp: 16.9 °C","Temp: 17.4 °C","Temp: 12.4 °C","Temp: 21 °C","Temp: 16.8 °C","Temp: 11.9 °C","Temp: 16 °C","Temp: 11.1 °C","Temp: 17.2 °C","Temp: 16.4 °C","Temp: 17.5 °C","Temp: 13 °C","Temp: 15.9 °C","Temp: 14.5 °C","Temp: 13.1 °C","Temp: 14 °C","Temp: 12.6 °C","Temp: 17.1 °C","Temp: 16.5 °C","Temp: 12.7 °C","Temp: -3.2 °C","Temp: 6.7 °C","Temp: 16.3 °C","Temp: 15.5 °C","Temp: 12.6 °C","Temp: 15.5 °C","Temp: 18.4 °C","Temp: 13.6 °C","Temp: 14.5 °C","Temp: 14 °C","Temp: 13.5 °C","Temp: 16 °C","Temp: 13.3 °C","Temp: 16 °C","Temp: 18 °C","Temp: 13.9 °C","Temp: 16.7 °C","Temp: 15.5 °C","Temp: 6.8 °C","Temp: 15.9 °C","Temp: 8.9 °C"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#440154","#46327E","#365C8D","#277F8E","#1FA187","#4AC16D","#9FDA3A","#FDE725"],"labels":["-5 &ndash; 0","0 &ndash; 5","5 &ndash; 8","8 &ndash; 10","10 &ndash; 12","12 &ndash; 15","15 &ndash; 20","20 &ndash; 25"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topright","type":"bin","title":"Predicción T (°C)","extra":null,"layerId":null,"className":"info legend","group":null}]},{"method":"addLegend","args":[{"colors":["#440154 , #46075B 1.71503957783641%, #463480 14.9076517150396%, #375B8D 28.1002638522427%, #297B8E 41.2928759894459%, #1E9B8A 54.4854881266491%, #39BA76 67.6781002638522%, #7FD34E 80.8707124010554%, #D8E219 94.0633245382586%, #FDE725 "],"labels":["-50","-40","-30","-20","-10","0","10","20"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topleft","type":"numeric","title":"Temperatura Observada","extra":{"p_1":0.01715039577836408,"p_n":0.9406332453825857},"layerId":null,"className":"info legend","group":null}]},{"method":"addLayersControl","args":[[],["Predicción Kriging","Contorno","Temperatura Observada"],{"collapsed":false,"autoZIndex":true,"position":"topright"}]}],"limits":{"lat":[32.07286193660753,42.40486193660753],"lng":[-124.8128902362941,-113.1326902362941]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Ver código</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>mapa_var_leaflet</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-925b584b3ccf8ace5fda" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-925b584b3ccf8ace5fda">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKIAAAC0CAYAAAAXffedAAAJLUlEQVR4nO2dvWoeRxSGz0qpBC4NceV0Ji7tCxC4Nxaoyw24FwZfg0GkS+FcgDqDhHuDLsAqFdRFVQwpA6oSbQqz1no1u3Pm95wz8z7gwvL37bfyPt975m9nh3EcCQBpdqRPAAAiiAiUABGBCiAiUAFEBCr4QeJDn7/7pK6r/vnti0H6HHqGJaJGcUBbeEtzLxL28ntqZVNEXBxQC3RWgAo2RUQDHtRCpNfM4fXLP6Lf+/7jzxnPBNRATMQU0cod+0XW8wB8vCJ+fvtieP7u01hSHABYnRVICEqDXjNQgdrOypyXP22f5sc//610JqAU6kT0Scd9D+S0hQoRY+QLPSbE1I2YiCXk434epNRHdRFrC+g7B0ipA68Vv1/+lrzwIUW+H//+h/W6Lw8fRB1fwxcDFErE1IvLlW/tPbFSAjm8xtRMjBgBt44DIe3gHdB+tPe6ygqcXBIuj1niuCA/KhpIHFluP1w4f75z+Ix9fCSkXkRFTBHQ9e8+KSGkXryl+a+b90VuF/BJePvhwiuh6z05PhvUR2TRA0fCWLgCo/2oi00RS6Rh6sW/Oruhq7Mb7+uQjrYY1ralkyzJLtbke/Jqz/uZnA4NEdHw+A3u0RHCmYhWJJz+zZeQKaUe1KFKG7FGewwy2qa4iFwBY9Iw9LWQUS/ZxxGlG/9XZzeb7cZJRm67EdTBK2INsXInlU/G6TMhox6cpXlq00mnWwo5h3hAecTv4vPJwBmeWQMy2kF0rlmLBNN57B4Jn0jHOBOxxsBuLQm5MzFAltXSPDx+M5QSMkTCXBJBRt1424i5ZZSQcH48CKmT1bnmJeP1cfS0X0wZriHMsiO0e3SCuWYhgjsrNdp2tVKLM94I6sAW8a5E/1J0X22Uzj4RH0ecIyEhxNdBsIil2lEQom9UJKK0hNKfDxSICAkAUcDwzZzL/QPvmzi9UW0SPj0/xfCNEFGJyLlgvsFjbRICWYqXZsxmAA5Rq284pXkJZARbiHdWACCCiEAJEBGoACICFRQbvgEgBCQiUIHIzVPzWRcM6wCihER88mrv25/Q9239HfRJltLMlWntdZARRC16mPjv1/urtVP2MdRSptEZq0/2NmIL6Xa5fzBCxrokJSKROxVT0JKKExCyDsltxN2jk6Hl2zBzf9GAm2zjiLlkbKG0g3CyDmi3moxIxfJgZoUJZCxLcmfFRepF09JhWWsmtJr8khRJRHRgQChFEnFivD4eY/fKkU5Fbqep5S9cTYq3EXcOn2HTdOClaCIS3d/OTnJ/RC5baeg6Jwx6p1NcRCJbMq5J6DsPyJiGyPCNlVI93ZPN+TLE3GIL7hBJRCLdqZgCkjEOsQFtK6kYyuX+wYh0DEfFzIpvCMTi/DNkDKOKiL5HZbQ6QNzq71WCqok4CdnTk+IhIw8VpblVpk4WZPQjJmJIKlrqNa8BGbdRk4itztnOv0SQcR01IrbMfFAcMrqpMqDtwnVBdo9OhpBbVC0yH4pqtQrEICYiET8dWhKRCDK6QGkWAO3G+4iKyEmD1tLQBWRUnIitP41g+bv1LqPItnRbtCwfWEdVIvYuYc+pqCIRLQm4XAmU+9wnGXvrTYsnovX/8JjNSjn0lo7iIhK1sao5dedcFz3JqEJEIjsybpXiEBm5Jb0XGdWISNSGjCXoQUbRKb41LC2zn1IwVs6QFLXent5CpYguLMkZQ+9bnKgqzT3Te5sRIiqCI+PV2U2Tt6xCRGWsyeiae29JRvVtxJb+s0N58mqPlZJWRhu2UC1izxKGYl1GlOZGsP6lVS2i9W854KNaRBCG5aEd1W1EIvslpxauAXFLg9/qExHl2c/arIylhFQvIhFk3MLiln0u1JfmJSjVXwkRcOfwWdBeQxKouFWgJq4LaPlWBR9WduY1UZrnPD0/HXKXo1bK2xaufcw1YU5Eoq+9wVh5LKVfKss0HK+PR61Cmi7NqYtSl8fKLalkM2CrJI/Xx6O2NqPJRCT6fowsNB3XZKhRokvd9ReKtmQ0KyKRXRmnz9EgpBZMi7gk14W1Lgi3p6wpFc2LWGoaq1ZiSUuvRUbzIhLpnVO10kPXIGMTIhLdyWhxjJH7GSXPRVrGZkQkKpOMqalmJRWJZMcZmxKRSGeZ5mw66ku7mm1JCRnNLXrg4lscwb2wpRIt9AHlUnPMtQa+m0vEnJQsq2spOfXW5+JJ9qxrpWOzIm4Nv3AubK22HWd3MUvtzFiaLc1E369Qni6mdElegzsvHboOMRelS3SziUh0fwpQq4QhtPq0haYTcWJKxvkF3JJS6kLPz4lzDpwvVu6FsaWSsQsRQ3rQ0mkTuhzNJ2OJFdolZISIxpFIRaL8MjbdRuwBqQTPPawDETvg9sOF9Cl4gYidoF1GiAiiyVmeIWJHaE5FiGic0Hno2w8XWYXMlYpdiPj0/HTA/jnfoy0duxCxZVKGb3LJmCMVuxjQXtLaAHfqMrHUAe8cg9sQsSFShMwx+5IiZJcibtGKpLFSSgkJEQOxJmqMkBKlGp2Vxqk9Fx1bniFiIBaHgUJljO1No42YEdcG6K5bVK2VaKKydwKm9py7F3ESb/foZNjahX/tfumWheSKiOGbRJbircnIvWn/cv9gnJdu7ZLmWN2da4Fs121El2Dzn+0enQwhO0dYaz/62o41pwG7FpHoTrwUAS0jfY/ORPciEuncL6c3IGJBrJXqGHItAzP9VAELPD0/HZadGCL9HRmiug8LQiJWoOVkRK/ZOFoW60rv4T0BEQvCeUytpIxbEtYcQyTqfEC7JK7B8q3XX+4fjCWefrVGymB2iS1HkIiV8KXjPBlLP1pDYr8cH0jEgoSm4tp7c27mmWOvHGzC1BGc9qWL1D24a7cNv31u7gOCPMTO9iyFCynzkg8Zh4iNwd2MdEnNJV/Ozy9xUCDDsiyX6IGXesoApvgaIUW60JI8lxEzK8qZHicm/Yy70uOS2PtGOTmSgptUNdPwy8MH9/7kAKW5IDlllN40aU24R3uvUZpbp/hDdphpWFpCIoionklGqTG+GhISoTSbYHj8Zhivj8edw2fZSnSo2LnFW4IpPiPMe6cuGTnz0RMa79FBIhphSkXf6zQsto0BiQhUgM4KUAFEBCqAiEAFEBGoACICFUBEoIL/AfB0ot8uZqx8AAAAAElFTkSuQmCC",[[42.40486193660753,-124.8128902362941],[32.07286193660753,-113.1326902362941]],null,"Predicción Kriging",{"tileSize":256,"zIndex":1,"minZoom":0,"opacity":0.7}]},{"method":"addPolygons","args":[[[[{"lng":[-117.1223754882812,-117.1333312988281,-117.1827087402344,-117.2129135131836,-117.2123794555664,-117.2005081176758,-117.1740798950195,-117.1472244262695,-117.1156234741211,-117.1166534423828,-117.1413879394531,-117.2021560668945,-117.2288131713867,-117.2405471801758,-117.2420425415039,-117.2549896240234,-117.2684783935547,-117.26611328125,-117.2587661743164,-117.2803421020508,-117.2529220581055,-117.2490615844727,-117.25,-117.2698593139648,-117.3197326660156,-117.3294525146484,-117.3402862548828,-117.4094390869141,-117.480827331543,-117.495002746582,-117.6319427490234,-117.6725006103516,-117.7744369506836,-117.8638916015625,-117.8840179443359,-117.9108276367188,-117.9361114501953,-117.9550018310547,-117.9736175537109,-117.9949951171875,-118.0270843505859,-118.0452728271484,-118.0830688476562,-118.1081848144531,-118.1347427368164,-118.2222213745117,-118.2671279907227,-118.272087097168,-118.2977752685547,-118.3180694580078,-118.400016784668,-118.4174652099609,-118.3986206054688,-118.3861846923828,-118.4211044311523,-118.432502746582,-118.4544525146484,-118.4711227416992,-118.508903503418,-118.5300064086914,-118.554443359375,-118.6549987792969,-118.6977691650391,-118.7525024414062,-118.7811126708984,-118.8364028930664,-118.9361114501953,-118.9614028930664,-118.9811096191406,-119.1291732788086,-119.1743011474609,-119.2196502685547,-119.2558441162109,-119.3124694824219,-119.4161071777344,-119.446662902832,-119.5416717529297,-119.5772171020508,-119.5997314453125,-119.6247100830078,-119.7986068725586,-120.0037460327148,-120.1308288574219,-120.245002746582,-120.3550033569336,-120.4241561889648,-120.4490280151367,-120.4819412231445,-120.4953460693359,-120.5583267211914,-120.5831909179688,-120.605827331543,-120.6259613037109,-120.6283264160156,-120.623893737793,-120.6033248901367,-120.5941696166992,-120.5913772583008,-120.5980606079102,-120.6247100830078,-120.6137466430664,-120.6000671386719,-120.6181945800781,-120.6805572509766,-120.7186813354492,-120.7385330200195,-120.8313903808594,-120.8567962646484,-120.8697280883789,-120.8681945800781,-120.8591613769531,-120.8411102294922,-120.9199981689453,-120.9770812988281,-120.9994506835938,-121.0477752685547,-121.1666564941406,-121.2687530517578,-121.29638671875,-121.3215408325195,-121.3680572509766,-121.4349899291992,-121.4418029785156,-121.4609680175781,-121.4720840454102,-121.6654205322266,-121.7580642700195,-121.7961044311523,-121.8676300048828,-121.8641662597656,-121.8734664916992,-121.8847427368164,-121.8976440429688,-121.9216613769531,-121.9432525634766,-121.8997955322266,-121.8656158447266,-121.8450012207031,-121.8255615234375,-121.8091506958008,-121.7993087768555,-121.7747192382812,-121.7639007568359,-121.7991638183594,-121.8511123657227,-121.8791656494141,-121.9135971069336,-121.9783325195312,-122.0202865600586,-122.0415191650391,-122.0709762573242,-122.1472320556641,-122.1795806884766,-122.379020690918,-122.3883438110352,-122.393684387207,-122.3844528198242,-122.3731918334961,-122.378044128418,-122.4259719848633,-122.4433288574219,-122.4806137084961,-122.4902801513672,-122.4958267211914,-122.4994430541992,-122.4905471801758,-122.4843063354492,-122.4481201171875,-122.379638671875,-122.359992980957,-122.3513870239258,-122.35693359375,-122.3673553466797,-122.3577728271484,-122.0643005371094,-122.0231857299805,-122.0058364868164,-122.0297164916992,-122.0808334350586,-122.1259689331055,-122.1308288574219,-122.1384811401367,-122.1572265625,-122.1747131347656,-122.2427673339844,-122.2999877929688,-122.3934097290039,-122.352783203125,-122.2252731323242,-122.1633224487305,-122.1277313232422,-122.0158386230469,-121.9894409179688,-121.9155578613281,-121.8572235107422,-121.8337554931641,-121.6848526000977,-121.6541976928711,-121.6434936523438,-121.5911102294922,-121.498046875,-121.4272155761719,-121.4705505371094,-121.5531921386719,-121.5850067138672,-121.6622161865234,-121.6852188110352,-121.7229156494141,-121.8186798095703,-121.9052734375,-121.977783203125,-122.0186233520508,-122.0500030517578,-122.109733581543,-122.2641830444336,-122.2920837402344,-122.311393737793,-122.3652801513672,-122.3908386230469,-122.4783248901367,-122.479866027832,-122.4433288574219,-122.4201354980469,-122.456672668457,-122.505485534668,-122.6566619873047,-122.7822875976562,-122.8169631958008,-122.8966674804688,-122.9283294677734,-122.9563903808594,-122.9269409179688,-122.8399963378906,-122.8030471801758,-122.8077697753906,-122.83056640625,-122.9586181640625,-123.1072235107422,-123.1290283203125,-123.1716613769531,-123.2372131347656,-123.2666625976562,-123.3130645751953,-123.3530578613281,-123.4475021362305,-123.5361175537109,-123.620002746582,-123.7015228271484,-123.7072601318359,-123.6745834350586,-123.6669387817383,-123.6861038208008,-123.712646484375,-123.7541809082031,-123.7957000732422,-123.7956924438477,-123.774169921875,-123.7630615234375,-123.7368698120117,-123.7723617553711,-123.8202819824219,-123.8674926757812,-123.9311065673828,-124.0623550415039,-124.0927734375,-124.1525726318359,-124.2022171020508,-124.297233581543,-124.331184387207,-124.3240356445312,-124.3233413696289,-124.3543090820312,-124.3758239746094,-124.3523559570312,-124.3319473266602,-124.2750091552734,-124.2529144287109,-124.2294464111328,-124.1994323730469,-124.14306640625,-124.0988922119141,-124.0993041992188,-124.1125030517578,-124.1222229003906,-124.0909729003906,-124.061393737793,-124.0458374023438,-124.0399932861328,-124.0467987060547,-124.063606262207,-124.1186065673828,-124.1813812255859,-124.2155609130859,-124.1973571777344,-124.1902770996094,-124.1752777099609,-124.1841583251953,-124.1858520507812,-123.9505615234375,-123.883903503418,-123.5336227416992,-123.4836120605469,-123.4169464111328,-123.366943359375,-123.3169631958008,-123.2669525146484,-123.2169494628906,-123.1669464111328,-123.116943359375,-123.0669631958008,-122.8999862670898,-122.8177795410156,-122.7508392333984,-122.6341705322266,-122.600830078125,-122.5175018310547,-122.2172164916992,-122.1505584716797,-122.1172180175781,-122.0005569458008,-121.9669494628906,-121.8836212158203,-121.8002777099609,-121.7169494628906,-121.6677703857422,-121.5341567993164,-121.4841613769531,-121.4341583251953,-121.3008270263672,-121.1838836669922,-121.133903503418,-121.0672302246094,-120.9169464111328,-120.8510971069336,-120.7677764892578,-120.6841583251953,-120.3208236694336,-120.0341567993164,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.001106262207,-119.8197326660156,-119.5155563354492,-119.0130615234375,-118.8799896240234,-118.3752670288086,-118.2108306884766,-117.8919525146484,-117.7452697753906,-117.5747222900391,-117.4211120605469,-117.2677764892578,-117.1069488525391,-116.946662902832,-116.8027801513672,-116.6513977050781,-116.4924926757812,-116.1999969482422,-116.0269470214844,-115.8622131347656,-115.7527923583984,-115.5580368041992,-115.2555694580078,-115.1241607666016,-114.9933319091797,-114.6563873291016,-114.6219329833984,-114.6197128295898,-114.5563812255859,-114.4933319091797,-114.4561233520508,-114.4188766479492,-114.3781890869141,-114.3695068359375,-114.3358306884766,-114.2726440429688,-114.230827331543,-114.2005615234375,-114.1700668334961,-114.1516723632812,-114.1344528198242,-114.1170120239258,-114.2226409912109,-114.3141632080078,-114.3576278686523,-114.3834762573242,-114.4070892333984,-114.4207611083984,-114.4554061889648,-114.4755630493164,-114.5127868652344,-114.5233306884766,-114.510009765625,-114.4941635131836,-114.48388671875,-114.5275039672852,-114.6404876708984,-114.7255630493164,-114.7260971069336,-114.7038879394531,-114.6836090087891,-114.6681900024414,-114.6752777099609,-114.6965179443359,-114.6970748901367,-114.6788787841797,-114.6626281738281,-114.6029205322266,-114.5701370239258,-114.5452728271484,-114.5153503417969,-114.4644470214844,-114.4587478637695,-114.5352096557617,-114.5541687011719,-114.5844497680664,-114.6125030517578,-114.6526412963867,-114.6955490112305,-114.7190933227539,-114.7297973632812,-114.8713455200195,-115.0258941650391,-115.2024993896484,-115.404167175293,-115.6055603027344,-115.9077835083008,-116.2426376342773,-116.5081481933594,-116.7130584716797,-116.9141693115234,-117.0952911376953,-117.1223754882812],"lat":[32.53533172607422,32.56582641601562,32.65929412841797,32.68302917480469,32.69705581665039,32.69759368896484,32.6749382019043,32.61860275268555,32.62131118774414,32.64249420166016,32.68061447143555,32.72769546508789,32.71561431884766,32.68464279174805,32.66253280639648,32.65713882446289,32.68842315673828,32.70860290527344,32.77041625976562,32.82921600341797,32.86082458496094,32.87129211425781,32.88971710205078,32.97707366943359,33.10527038574219,33.12443542480469,33.14166259765625,33.24415588378906,33.32749176025391,33.34221649169922,33.44276428222656,33.47054290771484,33.53943634033203,33.59568405151367,33.60055160522461,33.60665893554688,33.62054443359375,33.63276672363281,33.64554595947266,33.66249084472656,33.69401931762695,33.70943450927734,33.73971557617188,33.75693893432617,33.76666259765625,33.78416442871094,33.75777435302734,33.72332000732422,33.71610260009766,33.7208251953125,33.74985504150391,33.78179931640625,33.80804443359375,33.84096527099609,33.92124557495117,33.93915557861328,33.96776580810547,33.98777008056641,34.03110504150391,34.04791259765625,34.05568695068359,34.0494384765625,34.04610443115234,34.03971862792969,34.03318786621094,34.03054809570312,34.05554962158203,34.06221008300781,34.06749725341797,34.11388397216797,34.1361083984375,34.16492080688477,34.22346115112305,34.28351593017578,34.35749816894531,34.37332153320312,34.41415405273438,34.42054748535156,34.42360687255859,34.42471313476562,34.42638397216797,34.4679069519043,34.47873687744141,34.47360229492188,34.46582794189453,34.45610046386719,34.4556884765625,34.50957489013672,34.53047561645508,34.56193542480469,34.56221389770508,34.55860137939453,34.58443832397461,34.62360382080078,34.64110565185547,34.66943740844727,34.69026947021484,34.71082305908203,34.8608283996582,34.89499664306641,35.01860427856445,35.10005950927734,35.13943862915039,35.17110443115234,35.18054580688477,35.16464233398438,35.20999145507812,35.22880935668945,35.25722122192383,35.27999496459961,35.3074951171875,35.35527038574219,35.44887542724609,35.46596145629883,35.47915649414062,35.52499008178711,35.64916229248047,35.70013046264648,35.76610565185547,35.79402542114258,35.82916259765625,35.8942985534668,35.92804718017578,35.97943496704102,35.99777221679688,36.18304443359375,36.22943496704102,36.24110412597656,36.31533813476562,36.3429069519043,36.39388656616211,36.43387603759766,36.46735382080078,36.51805114746094,36.59457397460938,36.64124298095703,36.61985397338867,36.61513137817383,36.6270751953125,36.64846420288086,36.66790771484375,36.75916290283203,36.81249237060547,36.88401794433594,36.95068740844727,36.97248840332031,36.9803352355957,36.96915435791016,36.95485305786133,36.95415878295898,36.96235275268555,36.99582672119141,37.01763153076172,37.19998931884766,37.22026824951172,37.25186538696289,37.28971862792969,37.32915878295898,37.37443542480469,37.48429489135742,37.50436782836914,37.5122184753418,37.52999114990234,37.56610107421875,37.58998870849609,37.75222015380859,37.78992462158203,37.81005859375,37.81381225585938,37.78693771362305,37.73165893554688,37.68762969970703,37.65443420410156,37.61582565307617,37.45929718017578,37.45790863037109,37.47137451171875,37.47943115234375,37.51027297973633,37.6027717590332,37.6322135925293,37.66221618652344,37.69470977783203,37.71471405029297,37.76666259765625,37.82638549804688,37.95915985107422,37.99082946777344,38.06415939331055,38.04743576049805,38.03526306152344,38.06610107421875,38.06554412841797,38.05416107177734,38.04305267333984,38.03666305541992,38.01811599731445,38.04861831665039,38.0789909362793,38.10464859008789,38.04888153076172,38.01290893554688,38.05499267578125,38.11041259765625,38.11568832397461,38.09658813476562,38.06646728515625,38.04746627807617,38.08115386962891,38.06610107421875,38.09721374511719,38.14811325073242,38.10877990722656,38.06137847900391,38.10999298095703,38.12693405151367,38.1361083984375,38.15554809570312,38.14749145507812,38.11957168579102,37.9366569519043,37.90693664550781,37.88318634033203,37.83346557617188,37.83103942871094,37.91054534912109,38.00131607055664,38.02027130126953,38.05443572998047,38.05360412597656,38.05804443359375,38.16249084472656,38.10777282714844,38.08193969726562,38.09498977661133,38.12748718261719,38.28527069091797,38.46277236938477,38.47290802001953,38.49193572998047,38.52276611328125,38.54083251953125,38.57388305664062,38.62443542480469,38.7340202331543,38.79610443115234,38.86082458496094,38.93041229248047,38.97109985351562,39.00458145141602,39.02554702758789,39.1219367980957,39.17804718017578,39.25943756103516,39.35332489013672,39.38582611083984,39.49652099609375,39.51915740966797,39.55499267578125,39.70971298217773,39.79166412353516,39.86915588378906,39.94971466064453,40.09165954589844,40.11631011962891,40.14790725708008,40.17416381835938,40.23804473876953,40.27245712280273,40.31193542480469,40.33624267578125,40.41526794433594,40.44769668579102,40.5322151184082,40.5816650390625,40.6947135925293,40.724365234375,40.74638366699219,40.74554443359375,40.81193542480469,40.99193572998047,41.03853607177734,41.0574951171875,41.15749359130859,41.24985504150391,41.34415435791016,41.39443969726562,41.42777252197266,41.46318435668945,41.51527404785156,41.68305206298828,41.75416564941406,41.81999206542969,41.84804916381836,41.86943817138672,41.94971466064453,41.99415588378906,41.99946594238281,42,42,42,42,42,42,42,42,42,42,42,42,42,42,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,42,42,42,42,42,42,42,42,42,42,42,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99964904785156,42,41.99943542480469,40.43305206298828,39.84943389892578,39.56610107421875,39.44971466064453,39.33332824707031,39.00721740722656,38.88276672363281,38.67276763916016,38.32054901123047,38.22609710693359,37.86527252197266,37.74638366699219,37.51416015625,37.40665435791016,37.28110504150391,37.16721343994141,37.05304718017578,36.93276977539062,36.81221008300781,36.70360565185547,36.58860015869141,36.46749114990234,36.24276733398438,36.10888671875,35.98081970214844,35.89499664306641,35.74221801757812,35.50277709960938,35.39804840087891,35.29332733154297,35.02165985107422,34.99214935302734,34.88193511962891,34.81666564941406,34.75833129882812,34.69860076904297,34.63166046142578,34.55082702636719,34.52193832397461,34.46415710449219,34.41582489013672,34.38999176025391,34.37276458740234,34.35867691040039,34.34276580810547,34.32332611083984,34.28804779052734,34.19624328613281,34.14665985107422,34.12568283081055,34.11429977416992,34.09207153320312,34.03013229370117,34.00124359130859,33.98721313476562,33.96152114868164,33.94415283203125,33.86888122558594,33.78305053710938,33.72193145751953,33.55929946899414,33.42033767700195,33.39916229248047,33.31888580322266,33.28054809570312,33.24638366699219,33.20901870727539,33.15541076660156,33.115478515625,33.08943557739258,33.06137847900391,33.04374313354492,33.02971267700195,33.03360748291016,33.03471755981445,33.02554702758789,32.97165679931641,32.86235046386719,32.73200607299805,32.72499084472656,32.72568511962891,32.73110198974609,32.74179840087891,32.74096298217773,32.71845626831055,32.71771240234375,32.70785140991211,32.69698715209961,32.68444061279297,32.66971588134766,32.65471649169922,32.63194274902344,32.60577011108398,32.58499908447266,32.568603515625,32.55221557617188,32.53665924072266,32.53533172607422]}],[{"lng":[-119.8680572509766,-119.6983337402344,-119.5936126708984,-119.5631866455078,-119.5527801513672,-119.5155639648438,-119.5329895019531,-119.5899963378906,-119.7133331298828,-119.7727813720703,-119.788330078125,-119.8369369506836,-119.8709716796875,-119.9177703857422,-119.9142303466797,-119.8680572509766],"lat":[34.08415985107422,34.04527282714844,34.05387878417969,34.06583023071289,34.06582641601562,34.04457855224609,34.01513290405273,33.99721527099609,33.97082138061523,33.96720886230469,33.96720886230469,33.97415924072266,33.99151992797852,34.06526947021484,34.0826301574707,34.08415985107422]}],[{"lng":[-120,-119.9694442749023,-119.9663925170898,-120.0365295410156,-120.1074981689453,-120.1216583251953,-120.1452789306641,-120.164436340332,-120.172233581543,-120.1922073364258,-120.2260971069336,-120.1847229003906,-120.135009765625,-120.0519409179688,-120.0352783203125,-120],"lat":[33.98963165283203,33.99235534667969,33.96249008178711,33.91915893554688,33.90554809570312,33.90804290771484,33.91666412353516,33.92777252197266,33.93471527099609,33.95943450927734,34.006103515625,34.01583099365234,34.02610015869141,34.03610992431641,34.02388000488281,33.98963165283203]}],[{"lng":[-118.5166625976562,-118.4452667236328,-118.4033432006836,-118.3497314453125,-118.297233581543,-118.2931213378906,-118.3037414550781,-118.4496459960938,-118.5899276733398,-118.5811233520508,-118.5418014526367,-118.5288925170898,-118.5166625976562],"lat":[33.47776794433594,33.44276428222656,33.42804718017578,33.39833068847656,33.34609985351562,33.32867431640625,33.30985260009766,33.32860565185547,33.48381042480469,33.49082946777344,33.48943710327148,33.48624420166016,33.47776794433594]}],[{"lng":[-118.5302886962891,-118.5261077880859,-118.5202789306641,-118.504997253418,-118.4822235107422,-118.413330078125,-118.3691635131836,-118.3694534301758,-118.4086074829102,-118.477783203125,-118.4869384765625,-118.4938812255859,-118.5338897705078,-118.570556640625,-118.5948638916016,-118.5938949584961,-118.5544281005859,-118.5302886962891],"lat":[32.99332427978516,32.98360443115234,32.97499084472656,32.959716796875,32.93804168701172,32.88555145263672,32.85471343994141,32.83277130126953,32.81707763671875,32.85277557373047,32.85888671875,32.86666107177734,32.92721557617188,32.98416137695312,33.03305053710938,33.04458236694336,33.04305267333984,32.99332427978516]}]]],null,"Contorno",{"interactive":true,"className":"","stroke":true,"color":"black","weight":2,"opacity":0.5,"fill":false,"fillColor":"black","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#D53E4F","#FC8D59","#FEE08B","#E6F598","#99D594","#3288BD"],"labels":["0 &ndash; 5","5 &ndash; 10","10 &ndash; 15","15 &ndash; 20","20 &ndash; 25","25 &ndash; 30"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topright","type":"bin","title":"Varianza","extra":null,"layerId":null,"className":"info legend","group":null}]},{"method":"addLayersControl","args":[[],["Varianza de pred","Contorno"],{"collapsed":false,"autoZIndex":true,"position":"topright"}]}],"limits":{"lat":[32.07286193660753,42.40486193660753],"lng":[-124.8128902362941,-113.1326902362941]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>



</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Referencias</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-EPA2024" class="csl-entry" role="listitem">
United States Environmental Protection Agency (EPA). 2024. <span>«AirNow: Air Quality Data»</span>. 2024. <a href="https://files.airnowtech.org/">https://files.airnowtech.org/</a>.
</div>
</div></section></div></main> <!-- /main -->
<div class="custom-footer">

  <div class="footer-logo">

    <!-- Escudo para tema claro -->

    <img src="UNAL_NEGRO.png" alt="Escudo UNAL claro" class="logo-light">

    <!-- Escudo para tema oscuro -->

    <img src="UNAL_BLANCO.png" alt="Escudo UNAL oscuro" class="logo-dark">

  </div>



  <div>

    <strong>Contacto:</strong><br>

    <a href="mailto:ldiazca@unal.edu.co">ldiazca@unal.edu.co</a><br>

    <a href="mailto:craba@unal.edu.co">craba@unal.edu.co</a>

  </div>

  <div>

    <strong>Institución:</strong><br>

    Departamento de Estadística <br>

    Universidad Nacional de Colombia

  </div>

  <div>

     © Estadística Espacial <br>

    2025

  </div>

</div>

<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>