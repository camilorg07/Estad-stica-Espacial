{
  "hash": "f5937fcd845a02dc67566bd9d5f9a125",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Análisis geoestadístico del ozono y la temperatura en California durante marzo de 2024\"\nlang: es\nauthor: \n  - name: \"Luna Katerin Díaz Casallas\"\n    email: \"ldiazca@unal.edu.co\"\n  - name: \"Camilo Alejandro Raba Gómez\"\n    email: \"craba@unal.edu.co\"\ninstitute: \"Departamento de Estadística - Universidad Nacional de Colombia\"\ndate: today\nformat:\n  html:\n    toc: True\n    toc-title: \"Tabla de contenidos\"\n    toc-depth: 3  # Profundidad de los encabezados a enumerar\n    number-sections: true  # Activa la numeración de secciones\n    html-math-method: katex\n    code-fold: true\n    code-summary: \"Ver código\"\n    link-external-newwindow: true\n    css: styles.css\n    theme:\n      light: flatly\n      dark: darkly\n    include-after-body: footer.html\neditor_options:\n  chunk_output_type: console\nbibliography: referencias.bib\nnocite: '@*'\n---\n\n\n\n\n# Introducción\n\nLa calidad del aire es un factor clave para la salud pública, el bienestar social y la sostenibilidad ambiental, y California se destaca como uno de los estados más afectados de Estados Unidos por la contaminación atmosférica. La combinación de una alta densidad poblacional, una intensa actividad industrial y vehicular, junto con fenómenos naturales como los incendios forestales, ha hecho que varias de sus ciudades se ubiquen entre las más contaminadas del país. Al mismo tiempo, la temperatura cumple un papel fundamental en la dinámica atmosférica, ya que influye en la dispersión, concentración y formación de contaminantes, además de constituir en sí misma un aspecto crítico para comprender las condiciones ambientales regionales. Frente a este contexto, resulta necesario llevar a cabo un análisis geoespacial que considere tanto la calidad del aire como la temperatura en California, con el fin de identificar patrones espaciales, contrastes regionales y áreas críticas que permitan orientar acciones de mitigación y gestión ambiental.\n\n# Descripción\n\nLos datos objeto de este estudio provienen de la [Agencia de Protección Ambiental (EPA)](https://www.epa.gov/) de los Estados Unidos y corresponden a registros horarios obtenidos de las estaciones de monitoreo durante el mes de marzo de 2024. En partícular, se analizan las variables **Temperatura** y **Ozono (**$O_3$**)**.\n\n## Unidades\n\n-   *Temperatura:* Medido en grados celsius (C°) con una intensidad horaria.\n\n-   *Ozono:* Medido en partes por billón (ppb) con una intensidad horaria.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Librerias necesarias\nlibrary(dplyr)\nlibrary(geoR)\nlibrary(sp)\nlibrary(readxl)\nlibrary(tidyr)\nlibrary(sf)\nlibrary(ggplot2)\nlibrary(knitr)\nlibrary(plotly)\nlibrary(leaflet)\nlibrary(raster)\nlibrary(stars)\n\n#Carga de datos\nCali_Marz <- read.csv(\"AirNow_Marzo_California.csv\", colClasses = c(\"AQSID\"=\"character\"))\n\nOzone <- Cali_Marz %>% filter(Variable==\"OZONE\") \nNO2 <- Cali_Marz %>% filter(Variable==\"NO2\")\nTemp <- read.csv(\"Temperatura.csv\", colClasses = c(\"AQSID\"=\"character\"))\n\nOzone <- Ozone %>% mutate(DateTime = paste(Date, Hour, sep = \" \"))\nNO2 <- NO2 %>% mutate(DateTime = paste(Date, Hour, sep = \" \"))\nTemp <- Temp[,-1]\n\n#Para el mapa de California\nsh_mundos<-st_read(\"admin00.shp\",quiet=TRUE)\nsh_mundos <- sh_mundos %>% filter(CNTRY_NAME==\"United States\")\nsh_mundos <- sh_mundos %>% filter(ADMIN_NAME==\"California\")\n\n#Datos de las estaciones\ndata <- read.csv(\"HourlyAQObs_2024010101.dat\")\ndata <- data %>% filter(CountryCode==\"US\")\ndata <- data %>% filter(StateName==\"CA\")\n\nCRS_UTM_NY = \"+init=epsg:3310\"\n\nOzone_Matrix <- Ozone %>%\n  dplyr::select(DateTime, AQSID, Value) %>%\n  pivot_wider(names_from = AQSID, values_from = Value) \n\nTemp_Matrix <- Temp %>%\n  dplyr::select(DateTime, AQSID, Value) %>%\n  pivot_wider(names_from = AQSID, values_from = Value) \n\n#Para el mapa\n\nsh_mundos_wgs84 <- st_transform(sh_mundos, crs = 4326)\n\nsh_mundos_utm <- st_transform(sh_mundos, crs = CRS(\"EPSG:3310\"))\n\nnew <- sp::spsample(as(sh_mundos_utm, \"Spatial\"), n = 50000, type = \"regular\")\n\nproj4string(new) <- CRS(\"EPSG:3310\")\ncoordinates(new) ~ Este + Norte\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ncoordinates(new) ~ Este + Norte\n```\n\n\n:::\n\n```{.r .cell-code}\ncolnames(new@coords) <- c(\"Este\", \"Norte\")\n\nsh_mundos_sp_utm <- as(sh_mundos_utm, \"Spatial\")\n\nsh_mundos_utm_simple <- st_union(sh_mundos_utm)\nsh_mundos_sp_utm_simple <- as(sh_mundos_utm_simple, \"Spatial\")\n```\n:::\n\n\n\n\n# Análisis geoestadístico univariado\n\n## Variable Ozono\n\nSe tomaron los datos de Temperatura de la madrugada el primero de marzo de 2024:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nEstacionesOz <- data %>% filter(AQSID %in% colnames(Ozone_Matrix)[-1])\nEstacionesOz <- EstacionesOz[,c(1:10,13)]\n\nest_sf_Oz <- st_as_sf(EstacionesOz, \n                   coords = c(\"Longitude\", \"Latitude\"), \n                   crs = 4326)\nest_sf_utm_O <- st_transform(est_sf_Oz, crs = 3310)\ndeci_coord_O = SpatialPoints(cbind(EstacionesOz$Longitude,\n                                 EstacionesOz$Latitude),\n                           proj4string = CRS(\"+proj=longlat\"))\nutm_coord_O = spTransform(deci_coord_O, CRS(\"EPSG:3310\"))\nutm_coord_df_O = as.data.frame(utm_coord_O)\nEstacionesOz$x <- utm_coord_df_O$coords.x1\nEstacionesOz$y <- utm_coord_df_O$coords.x2\n\ny_oz <- Ozone_Matrix[1,] #Tomar una fecha\ny_oz <- cbind(colnames(y_oz),t(y_oz[1,]))\ny_oz <- y_oz[-1,]\ny_oz <- as.data.frame(y_oz)\ny_oz <- na.omit(y_oz)\ny_oz <- inner_join(y_oz, EstacionesOz, by=c(\"V1\"=\"AQSID\"))\ndatosOZ <- y_oz[,c(13,14,2)] #Datos1 es la base con coordenadas + variable\ncolnames(datosOZ)=c(\"Este\",\"Norte\",\"Ozono\")\ndatosOZ$Ozono <- as.numeric(datosOZ$Ozono)\n\ncoords_3310O <- st_coordinates(est_sf_utm_O)\nest_sf_utm_O$Este <- coords_3310O[, \"X\"]\nest_sf_utm_O$Norte <- coords_3310O[, \"Y\"]\n\ndatosO_sf_utm <- merge(est_sf_utm_O, y_oz[, c(\"V1\", \"V2\")], by.x = \"AQSID\", by.y = \"V1\")\ndatosO_sf_utm$Ozono <- as.numeric(datosO_sf_utm$V2)\n\ndatosO_sf_wgs84 <- merge(est_sf_Oz, y_oz[, c(\"V1\", \"V2\")], by.x = \"AQSID\", by.y = \"V1\")\ndatosO_sf_wgs84$Ozono <- as.numeric(datosO_sf_wgs84$V2)\n\n\n\npalO <- colorNumeric(palette = \"viridis\", domain = datosO_sf_wgs84$Ozono)\n\nleaflet() %>%\n  addProviderTiles(providers$CartoDB.Positron) %>%\n  # Contorno de California\n  addPolygons(data = sh_mundos_wgs84, fill = FALSE, color = \"black\", weight = 2) %>%\n  # Puntos de temperatura\n  addCircleMarkers(data = datosO_sf_wgs84,\n                   fillColor = ~palO(Ozono),\n                   fillOpacity = 0.8,\n                   color = \"black\",\n                   weight = 1,\n                   radius = 6,\n                   popup = ~paste(\"Ozono:\", Ozono, \"°C\")) %>%\n  addLegend(pal = palO, values = datosO_sf_wgs84$Ozono, title = \"Ozono (ppb)\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-a27f20f3c583e88754be\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-a27f20f3c583e88754be\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.Positron\",null,null,{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addPolygons\",\"args\":[[[[{\"lng\":[-117.1223754882812,-117.1333312988281,-117.1827087402344,-117.2129135131836,-117.2123794555664,-117.2005081176758,-117.1740798950195,-117.1472244262695,-117.1156234741211,-117.1166534423828,-117.1413879394531,-117.2021560668945,-117.2288131713867,-117.2405471801758,-117.2420425415039,-117.2549896240234,-117.2684783935547,-117.26611328125,-117.2587661743164,-117.2803421020508,-117.2529220581055,-117.2490615844727,-117.25,-117.2698593139648,-117.3197326660156,-117.3294525146484,-117.3402862548828,-117.4094390869141,-117.480827331543,-117.495002746582,-117.6319427490234,-117.6725006103516,-117.7744369506836,-117.8638916015625,-117.8840179443359,-117.9108276367188,-117.9361114501953,-117.9550018310547,-117.9736175537109,-117.9949951171875,-118.0270843505859,-118.0452728271484,-118.0830688476562,-118.1081848144531,-118.1347427368164,-118.2222213745117,-118.2671279907227,-118.272087097168,-118.2977752685547,-118.3180694580078,-118.400016784668,-118.4174652099609,-118.3986206054688,-118.3861846923828,-118.4211044311523,-118.432502746582,-118.4544525146484,-118.4711227416992,-118.508903503418,-118.5300064086914,-118.554443359375,-118.6549987792969,-118.6977691650391,-118.7525024414062,-118.7811126708984,-118.8364028930664,-118.9361114501953,-118.9614028930664,-118.9811096191406,-119.1291732788086,-119.1743011474609,-119.2196502685547,-119.2558441162109,-119.3124694824219,-119.4161071777344,-119.446662902832,-119.5416717529297,-119.5772171020508,-119.5997314453125,-119.6247100830078,-119.7986068725586,-120.0037460327148,-120.1308288574219,-120.245002746582,-120.3550033569336,-120.4241561889648,-120.4490280151367,-120.4819412231445,-120.4953460693359,-120.5583267211914,-120.5831909179688,-120.605827331543,-120.6259613037109,-120.6283264160156,-120.623893737793,-120.6033248901367,-120.5941696166992,-120.5913772583008,-120.5980606079102,-120.6247100830078,-120.6137466430664,-120.6000671386719,-120.6181945800781,-120.6805572509766,-120.7186813354492,-120.7385330200195,-120.8313903808594,-120.8567962646484,-120.8697280883789,-120.8681945800781,-120.8591613769531,-120.8411102294922,-120.9199981689453,-120.9770812988281,-120.9994506835938,-121.0477752685547,-121.1666564941406,-121.2687530517578,-121.29638671875,-121.3215408325195,-121.3680572509766,-121.4349899291992,-121.4418029785156,-121.4609680175781,-121.4720840454102,-121.6654205322266,-121.7580642700195,-121.7961044311523,-121.8676300048828,-121.8641662597656,-121.8734664916992,-121.8847427368164,-121.8976440429688,-121.9216613769531,-121.9432525634766,-121.8997955322266,-121.8656158447266,-121.8450012207031,-121.8255615234375,-121.8091506958008,-121.7993087768555,-121.7747192382812,-121.7639007568359,-121.7991638183594,-121.8511123657227,-121.8791656494141,-121.9135971069336,-121.9783325195312,-122.0202865600586,-122.0415191650391,-122.0709762573242,-122.1472320556641,-122.1795806884766,-122.379020690918,-122.3883438110352,-122.393684387207,-122.3844528198242,-122.3731918334961,-122.378044128418,-122.4259719848633,-122.4433288574219,-122.4806137084961,-122.4902801513672,-122.4958267211914,-122.4994430541992,-122.4905471801758,-122.4843063354492,-122.4481201171875,-122.379638671875,-122.359992980957,-122.3513870239258,-122.35693359375,-122.3673553466797,-122.3577728271484,-122.0643005371094,-122.0231857299805,-122.0058364868164,-122.0297164916992,-122.0808334350586,-122.1259689331055,-122.1308288574219,-122.1384811401367,-122.1572265625,-122.1747131347656,-122.2427673339844,-122.2999877929688,-122.3934097290039,-122.352783203125,-122.2252731323242,-122.1633224487305,-122.1277313232422,-122.0158386230469,-121.9894409179688,-121.9155578613281,-121.8572235107422,-121.8337554931641,-121.6848526000977,-121.6541976928711,-121.6434936523438,-121.5911102294922,-121.498046875,-121.4272155761719,-121.4705505371094,-121.5531921386719,-121.5850067138672,-121.6622161865234,-121.6852188110352,-121.7229156494141,-121.8186798095703,-121.9052734375,-121.977783203125,-122.0186233520508,-122.0500030517578,-122.109733581543,-122.2641830444336,-122.2920837402344,-122.311393737793,-122.3652801513672,-122.3908386230469,-122.4783248901367,-122.479866027832,-122.4433288574219,-122.4201354980469,-122.456672668457,-122.505485534668,-122.6566619873047,-122.7822875976562,-122.8169631958008,-122.8966674804688,-122.9283294677734,-122.9563903808594,-122.9269409179688,-122.8399963378906,-122.8030471801758,-122.8077697753906,-122.83056640625,-122.9586181640625,-123.1072235107422,-123.1290283203125,-123.1716613769531,-123.2372131347656,-123.2666625976562,-123.3130645751953,-123.3530578613281,-123.4475021362305,-123.5361175537109,-123.620002746582,-123.7015228271484,-123.7072601318359,-123.6745834350586,-123.6669387817383,-123.6861038208008,-123.712646484375,-123.7541809082031,-123.7957000732422,-123.7956924438477,-123.774169921875,-123.7630615234375,-123.7368698120117,-123.7723617553711,-123.8202819824219,-123.8674926757812,-123.9311065673828,-124.0623550415039,-124.0927734375,-124.1525726318359,-124.2022171020508,-124.297233581543,-124.331184387207,-124.3240356445312,-124.3233413696289,-124.3543090820312,-124.3758239746094,-124.3523559570312,-124.3319473266602,-124.2750091552734,-124.2529144287109,-124.2294464111328,-124.1994323730469,-124.14306640625,-124.0988922119141,-124.0993041992188,-124.1125030517578,-124.1222229003906,-124.0909729003906,-124.061393737793,-124.0458374023438,-124.0399932861328,-124.0467987060547,-124.063606262207,-124.1186065673828,-124.1813812255859,-124.2155609130859,-124.1973571777344,-124.1902770996094,-124.1752777099609,-124.1841583251953,-124.1858520507812,-123.9505615234375,-123.883903503418,-123.5336227416992,-123.4836120605469,-123.4169464111328,-123.366943359375,-123.3169631958008,-123.2669525146484,-123.2169494628906,-123.1669464111328,-123.116943359375,-123.0669631958008,-122.8999862670898,-122.8177795410156,-122.7508392333984,-122.6341705322266,-122.600830078125,-122.5175018310547,-122.2172164916992,-122.1505584716797,-122.1172180175781,-122.0005569458008,-121.9669494628906,-121.8836212158203,-121.8002777099609,-121.7169494628906,-121.6677703857422,-121.5341567993164,-121.4841613769531,-121.4341583251953,-121.3008270263672,-121.1838836669922,-121.133903503418,-121.0672302246094,-120.9169464111328,-120.8510971069336,-120.7677764892578,-120.6841583251953,-120.3208236694336,-120.0341567993164,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.001106262207,-119.8197326660156,-119.5155563354492,-119.0130615234375,-118.8799896240234,-118.3752670288086,-118.2108306884766,-117.8919525146484,-117.7452697753906,-117.5747222900391,-117.4211120605469,-117.2677764892578,-117.1069488525391,-116.946662902832,-116.8027801513672,-116.6513977050781,-116.4924926757812,-116.1999969482422,-116.0269470214844,-115.8622131347656,-115.7527923583984,-115.5580368041992,-115.2555694580078,-115.1241607666016,-114.9933319091797,-114.6563873291016,-114.6219329833984,-114.6197128295898,-114.5563812255859,-114.4933319091797,-114.4561233520508,-114.4188766479492,-114.3781890869141,-114.3695068359375,-114.3358306884766,-114.2726440429688,-114.230827331543,-114.2005615234375,-114.1700668334961,-114.1516723632812,-114.1344528198242,-114.1170120239258,-114.2226409912109,-114.3141632080078,-114.3576278686523,-114.3834762573242,-114.4070892333984,-114.4207611083984,-114.4554061889648,-114.4755630493164,-114.5127868652344,-114.5233306884766,-114.510009765625,-114.4941635131836,-114.48388671875,-114.5275039672852,-114.6404876708984,-114.7255630493164,-114.7260971069336,-114.7038879394531,-114.6836090087891,-114.6681900024414,-114.6752777099609,-114.6965179443359,-114.6970748901367,-114.6788787841797,-114.6626281738281,-114.6029205322266,-114.5701370239258,-114.5452728271484,-114.5153503417969,-114.4644470214844,-114.4587478637695,-114.5352096557617,-114.5541687011719,-114.5844497680664,-114.6125030517578,-114.6526412963867,-114.6955490112305,-114.7190933227539,-114.7297973632812,-114.8713455200195,-115.0258941650391,-115.2024993896484,-115.404167175293,-115.6055603027344,-115.9077835083008,-116.2426376342773,-116.5081481933594,-116.7130584716797,-116.9141693115234,-117.0952911376953,-117.1223754882812],\"lat\":[32.53533172607422,32.56582641601562,32.65929412841797,32.68302917480469,32.69705581665039,32.69759368896484,32.6749382019043,32.61860275268555,32.62131118774414,32.64249420166016,32.68061447143555,32.72769546508789,32.71561431884766,32.68464279174805,32.66253280639648,32.65713882446289,32.68842315673828,32.70860290527344,32.77041625976562,32.82921600341797,32.86082458496094,32.87129211425781,32.88971710205078,32.97707366943359,33.10527038574219,33.12443542480469,33.14166259765625,33.24415588378906,33.32749176025391,33.34221649169922,33.44276428222656,33.47054290771484,33.53943634033203,33.59568405151367,33.60055160522461,33.60665893554688,33.62054443359375,33.63276672363281,33.64554595947266,33.66249084472656,33.69401931762695,33.70943450927734,33.73971557617188,33.75693893432617,33.76666259765625,33.78416442871094,33.75777435302734,33.72332000732422,33.71610260009766,33.7208251953125,33.74985504150391,33.78179931640625,33.80804443359375,33.84096527099609,33.92124557495117,33.93915557861328,33.96776580810547,33.98777008056641,34.03110504150391,34.04791259765625,34.05568695068359,34.0494384765625,34.04610443115234,34.03971862792969,34.03318786621094,34.03054809570312,34.05554962158203,34.06221008300781,34.06749725341797,34.11388397216797,34.1361083984375,34.16492080688477,34.22346115112305,34.28351593017578,34.35749816894531,34.37332153320312,34.41415405273438,34.42054748535156,34.42360687255859,34.42471313476562,34.42638397216797,34.4679069519043,34.47873687744141,34.47360229492188,34.46582794189453,34.45610046386719,34.4556884765625,34.50957489013672,34.53047561645508,34.56193542480469,34.56221389770508,34.55860137939453,34.58443832397461,34.62360382080078,34.64110565185547,34.66943740844727,34.69026947021484,34.71082305908203,34.8608283996582,34.89499664306641,35.01860427856445,35.10005950927734,35.13943862915039,35.17110443115234,35.18054580688477,35.16464233398438,35.20999145507812,35.22880935668945,35.25722122192383,35.27999496459961,35.3074951171875,35.35527038574219,35.44887542724609,35.46596145629883,35.47915649414062,35.52499008178711,35.64916229248047,35.70013046264648,35.76610565185547,35.79402542114258,35.82916259765625,35.8942985534668,35.92804718017578,35.97943496704102,35.99777221679688,36.18304443359375,36.22943496704102,36.24110412597656,36.31533813476562,36.3429069519043,36.39388656616211,36.43387603759766,36.46735382080078,36.51805114746094,36.59457397460938,36.64124298095703,36.61985397338867,36.61513137817383,36.6270751953125,36.64846420288086,36.66790771484375,36.75916290283203,36.81249237060547,36.88401794433594,36.95068740844727,36.97248840332031,36.9803352355957,36.96915435791016,36.95485305786133,36.95415878295898,36.96235275268555,36.99582672119141,37.01763153076172,37.19998931884766,37.22026824951172,37.25186538696289,37.28971862792969,37.32915878295898,37.37443542480469,37.48429489135742,37.50436782836914,37.5122184753418,37.52999114990234,37.56610107421875,37.58998870849609,37.75222015380859,37.78992462158203,37.81005859375,37.81381225585938,37.78693771362305,37.73165893554688,37.68762969970703,37.65443420410156,37.61582565307617,37.45929718017578,37.45790863037109,37.47137451171875,37.47943115234375,37.51027297973633,37.6027717590332,37.6322135925293,37.66221618652344,37.69470977783203,37.71471405029297,37.76666259765625,37.82638549804688,37.95915985107422,37.99082946777344,38.06415939331055,38.04743576049805,38.03526306152344,38.06610107421875,38.06554412841797,38.05416107177734,38.04305267333984,38.03666305541992,38.01811599731445,38.04861831665039,38.0789909362793,38.10464859008789,38.04888153076172,38.01290893554688,38.05499267578125,38.11041259765625,38.11568832397461,38.09658813476562,38.06646728515625,38.04746627807617,38.08115386962891,38.06610107421875,38.09721374511719,38.14811325073242,38.10877990722656,38.06137847900391,38.10999298095703,38.12693405151367,38.1361083984375,38.15554809570312,38.14749145507812,38.11957168579102,37.9366569519043,37.90693664550781,37.88318634033203,37.83346557617188,37.83103942871094,37.91054534912109,38.00131607055664,38.02027130126953,38.05443572998047,38.05360412597656,38.05804443359375,38.16249084472656,38.10777282714844,38.08193969726562,38.09498977661133,38.12748718261719,38.28527069091797,38.46277236938477,38.47290802001953,38.49193572998047,38.52276611328125,38.54083251953125,38.57388305664062,38.62443542480469,38.7340202331543,38.79610443115234,38.86082458496094,38.93041229248047,38.97109985351562,39.00458145141602,39.02554702758789,39.1219367980957,39.17804718017578,39.25943756103516,39.35332489013672,39.38582611083984,39.49652099609375,39.51915740966797,39.55499267578125,39.70971298217773,39.79166412353516,39.86915588378906,39.94971466064453,40.09165954589844,40.11631011962891,40.14790725708008,40.17416381835938,40.23804473876953,40.27245712280273,40.31193542480469,40.33624267578125,40.41526794433594,40.44769668579102,40.5322151184082,40.5816650390625,40.6947135925293,40.724365234375,40.74638366699219,40.74554443359375,40.81193542480469,40.99193572998047,41.03853607177734,41.0574951171875,41.15749359130859,41.24985504150391,41.34415435791016,41.39443969726562,41.42777252197266,41.46318435668945,41.51527404785156,41.68305206298828,41.75416564941406,41.81999206542969,41.84804916381836,41.86943817138672,41.94971466064453,41.99415588378906,41.99946594238281,42,42,42,42,42,42,42,42,42,42,42,42,42,42,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,42,42,42,42,42,42,42,42,42,42,42,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99964904785156,42,41.99943542480469,40.43305206298828,39.84943389892578,39.56610107421875,39.44971466064453,39.33332824707031,39.00721740722656,38.88276672363281,38.67276763916016,38.32054901123047,38.22609710693359,37.86527252197266,37.74638366699219,37.51416015625,37.40665435791016,37.28110504150391,37.16721343994141,37.05304718017578,36.93276977539062,36.81221008300781,36.70360565185547,36.58860015869141,36.46749114990234,36.24276733398438,36.10888671875,35.98081970214844,35.89499664306641,35.74221801757812,35.50277709960938,35.39804840087891,35.29332733154297,35.02165985107422,34.99214935302734,34.88193511962891,34.81666564941406,34.75833129882812,34.69860076904297,34.63166046142578,34.55082702636719,34.52193832397461,34.46415710449219,34.41582489013672,34.38999176025391,34.37276458740234,34.35867691040039,34.34276580810547,34.32332611083984,34.28804779052734,34.19624328613281,34.14665985107422,34.12568283081055,34.11429977416992,34.09207153320312,34.03013229370117,34.00124359130859,33.98721313476562,33.96152114868164,33.94415283203125,33.86888122558594,33.78305053710938,33.72193145751953,33.55929946899414,33.42033767700195,33.39916229248047,33.31888580322266,33.28054809570312,33.24638366699219,33.20901870727539,33.15541076660156,33.115478515625,33.08943557739258,33.06137847900391,33.04374313354492,33.02971267700195,33.03360748291016,33.03471755981445,33.02554702758789,32.97165679931641,32.86235046386719,32.73200607299805,32.72499084472656,32.72568511962891,32.73110198974609,32.74179840087891,32.74096298217773,32.71845626831055,32.71771240234375,32.70785140991211,32.69698715209961,32.68444061279297,32.66971588134766,32.65471649169922,32.63194274902344,32.60577011108398,32.58499908447266,32.568603515625,32.55221557617188,32.53665924072266,32.53533172607422]}],[{\"lng\":[-119.8680572509766,-119.6983337402344,-119.5936126708984,-119.5631866455078,-119.5527801513672,-119.5155639648438,-119.5329895019531,-119.5899963378906,-119.7133331298828,-119.7727813720703,-119.788330078125,-119.8369369506836,-119.8709716796875,-119.9177703857422,-119.9142303466797,-119.8680572509766],\"lat\":[34.08415985107422,34.04527282714844,34.05387878417969,34.06583023071289,34.06582641601562,34.04457855224609,34.01513290405273,33.99721527099609,33.97082138061523,33.96720886230469,33.96720886230469,33.97415924072266,33.99151992797852,34.06526947021484,34.0826301574707,34.08415985107422]}],[{\"lng\":[-120,-119.9694442749023,-119.9663925170898,-120.0365295410156,-120.1074981689453,-120.1216583251953,-120.1452789306641,-120.164436340332,-120.172233581543,-120.1922073364258,-120.2260971069336,-120.1847229003906,-120.135009765625,-120.0519409179688,-120.0352783203125,-120],\"lat\":[33.98963165283203,33.99235534667969,33.96249008178711,33.91915893554688,33.90554809570312,33.90804290771484,33.91666412353516,33.92777252197266,33.93471527099609,33.95943450927734,34.006103515625,34.01583099365234,34.02610015869141,34.03610992431641,34.02388000488281,33.98963165283203]}],[{\"lng\":[-118.5166625976562,-118.4452667236328,-118.4033432006836,-118.3497314453125,-118.297233581543,-118.2931213378906,-118.3037414550781,-118.4496459960938,-118.5899276733398,-118.5811233520508,-118.5418014526367,-118.5288925170898,-118.5166625976562],\"lat\":[33.47776794433594,33.44276428222656,33.42804718017578,33.39833068847656,33.34609985351562,33.32867431640625,33.30985260009766,33.32860565185547,33.48381042480469,33.49082946777344,33.48943710327148,33.48624420166016,33.47776794433594]}],[{\"lng\":[-118.5302886962891,-118.5261077880859,-118.5202789306641,-118.504997253418,-118.4822235107422,-118.413330078125,-118.3691635131836,-118.3694534301758,-118.4086074829102,-118.477783203125,-118.4869384765625,-118.4938812255859,-118.5338897705078,-118.570556640625,-118.5948638916016,-118.5938949584961,-118.5544281005859,-118.5302886962891],\"lat\":[32.99332427978516,32.98360443115234,32.97499084472656,32.959716796875,32.93804168701172,32.88555145263672,32.85471343994141,32.83277130126953,32.81707763671875,32.85277557373047,32.85888671875,32.86666107177734,32.92721557617188,32.98416137695312,33.03305053710938,33.04458236694336,33.04305267333984,32.99332427978516]}]]],null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":\"black\",\"weight\":2,\"opacity\":0.5,\"fill\":false,\"fillColor\":\"black\",\"fillOpacity\":0.2,\"smoothFactor\":1,\"noClip\":false},null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addCircleMarkers\",\"args\":[[37.743061,37.8148,37.6547,38.342606,39.76168,38.20185,39.18919,38.006311,37.743649,36.7056,36.78538,36.8414,36.6324,36.5975,36.819199,39.53387,32.67618,32.7917,33.0325,37.360701,36.5092,37.3667,35.345607,35.0544,35.356615,35.438035,35.3313,35.23918,35.50349,36.3144,34.1439,34.051097,34.066429,34.1992,33.9014,34.010283,34.0667,34.13263,34.3833,36.8669,36.9533,37.9722,37.713299,39.145733,36.48187,36.209286,36.694261,39.234402,33.830586,33.925062,39.1003,38.74643,39.166,33.7472,33.920758,33.583099,33.852605,33.999449,33.996387,33.676535,33.61235,38.613804,38.56844,38.302591,38.683304,38.494475,36.843425,36.485001,34.894054,34.243132,34.510955,35.774455,34.100132,34.416506,34.059626,34.0714,34.106678,32.631229,32.842297,33.217026,32.579361,32.845467,32.789561,37.7658,37.6825,35.614668,35.0315,35.494556,35.64366,35.35474,37.4828,34.42775,34.7256,34.5414,34.402802,34.4897,34.637798,34.445301,34.605819,36.999571,37.3483,37.2267,36.98332,40.5497,40.5403,41.72679,38.102507,38.356556,37.642165,37.4883,39.13868,40.170917,36.489399,36.0319,37.98178,34.21017,34.40428,34.44806,34.27632,34.25239,38.53455,38.661239,39.757861,38.730278,36.6972,35.04944,33.793713,34.181977,34.7254,38.93568,38.86794,33.447867,32.710177,32.72519,37.961578,35.361589,34.890667,36.30815,36.1358],[-122.169907,-122.282402,-122.0317,-120.764426,-121.84047,-120.680277,-121.99887,-121.641918,-121.934188,-119.7414,-119.77321,-119.8744,-120.3822,-119.5036,-119.7164,-122.190834,-115.48307,-115.5617,-115.6225,-118.330835,-116.8481,-118.4167,-118.851825,-119.4039,-119.062613,-119.016787,-119,-118.78863,-119.27264,-119.6436,-117.8508,-118.456386,-118.226755,-118.5331,-118.205,-118.068484,-117.7506,-118.127142,-118.5283,-120.01,-120.0341,-122.5189,-119.7061,-123.202995,-121.73333,-121.126371,-121.623271,-121.055603,-117.938509,-117.952586,-120.9528,-121.26498,-120.1488,-115.8201,-116.858419,-117.072197,-116.540965,-117.415831,-117.4925,-117.331027,-114.60209,-121.368007,-121.49311,-121.420838,-121.164457,-121.211131,-121.3621,-121.155602,-117.024756,-117.272275,-117.32555,-117.372109,-117.491982,-117.285602,-117.147347,-116.3906,-117.274063,-117.059074,-116.768326,-117.396156,-116.929486,-117.123894,-116.944222,-122.3978,-121.4406,-120.656912,-120.50101,-120.666203,-120.23134,-120.04013,-122.2022,-119.69091,-120.4278,-119.7906,-119.457497,-120.0458,-120.456703,-119.827797,-120.07506,-121.574684,-121.8947,-121.9786,-121.98822,-122.3792,-121.5764,-122.63359,-122.237976,-121.949853,-120.994212,-120.8358,-121.61884,-122.255667,-118.826897,-119.055,-120.378551,-118.87051,-118.80998,-119.2313,-118.68369,-119.14318,-121.7734,-121.732683,-121.607908,-120.813697,-119.0189,-118.18893,-118.171019,-118.363036,-118.1786,-121.09959,-121.33835,-117.088649,-117.142665,-116.36441,-121.281414,-120.836819,-120.432844,-119.3129,-118.8108],6,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":\"black\",\"weight\":1,\"opacity\":0.5,\"fill\":true,\"fillColor\":[\"#25858E\",\"#2A768E\",\"#2D708E\",\"#228D8D\",\"#25858E\",\"#228D8D\",\"#1FA287\",\"#277E8E\",\"#2A768E\",\"#2A768E\",\"#31688E\",\"#20938C\",\"#38598C\",\"#20938C\",\"#228D8D\",\"#1FA287\",\"#51C46A\",\"#24AA83\",\"#73D056\",\"#228D8D\",\"#73D056\",\"#2A768E\",\"#1E9B8A\",\"#1FA287\",\"#20938C\",\"#1FA287\",\"#25858E\",\"#1FA287\",\"#1E9B8A\",\"#25858E\",\"#2BB07F\",\"#1FA287\",\"#1E9B8A\",\"#24AA83\",\"#1E9B8A\",\"#1E9B8A\",\"#2BB07F\",\"#1E9B8A\",\"#35B779\",\"#1E9B8A\",\"#1FA287\",\"#277E8E\",\"#41BE71\",\"#2BB07F\",\"#228D8D\",\"#228D8D\",\"#20938C\",\"#38598C\",\"#2D708E\",\"#1E9B8A\",\"#3F4788\",\"#3C508B\",\"#1E9B8A\",\"#FDE725\",\"#35B779\",\"#35B779\",\"#51C46A\",\"#41BE71\",\"#35B779\",\"#1FA287\",\"#20938C\",\"#277E8E\",\"#25858E\",\"#440154\",\"#453581\",\"#472C7A\",\"#31688E\",\"#20938C\",\"#85D54A\",\"#41BE71\",\"#35B779\",\"#41BE71\",\"#1FA287\",\"#41BE71\",\"#2BB07F\",\"#61CA60\",\"#41BE71\",\"#2BB07F\",\"#35B779\",\"#41BE71\",\"#1FA287\",\"#24AA83\",\"#1FA287\",\"#2D708E\",\"#34608D\",\"#228D8D\",\"#1FA287\",\"#2A768E\",\"#24AA83\",\"#24AA83\",\"#2D708E\",\"#1E9B8A\",\"#228D8D\",\"#51C46A\",\"#472C7A\",\"#20938C\",\"#1E9B8A\",\"#20938C\",\"#1E9B8A\",\"#25858E\",\"#31688E\",\"#25858E\",\"#228D8D\",\"#51C46A\",\"#35B779\",\"#35B779\",\"#20938C\",\"#20938C\",\"#277E8E\",\"#34608D\",\"#228D8D\",\"#1FA287\",\"#1FA287\",\"#20938C\",\"#228D8D\",\"#1FA287\",\"#24AA83\",\"#35B779\",\"#1FA287\",\"#2BB07F\",\"#24AA83\",\"#1FA287\",\"#228D8D\",\"#25858E\",\"#1E9B8A\",\"#24AA83\",\"#20938C\",\"#2BB07F\",\"#85D54A\",\"#453581\",\"#482173\",\"#61CA60\",\"#1FA287\",\"#99D83D\",\"#31688E\",\"#1E9B8A\",\"#20938C\",\"#20938C\",\"#24AA83\"],\"fillOpacity\":0.8},null,null,[\"Ozono: 35 °C\",\"Ozono: 33 °C\",\"Ozono: 32 °C\",\"Ozono: 36 °C\",\"Ozono: 35 °C\",\"Ozono: 36 °C\",\"Ozono: 39 °C\",\"Ozono: 34 °C\",\"Ozono: 33 °C\",\"Ozono: 33 °C\",\"Ozono: 31 °C\",\"Ozono: 37 °C\",\"Ozono: 29 °C\",\"Ozono: 37 °C\",\"Ozono: 36 °C\",\"Ozono: 39 °C\",\"Ozono: 44 °C\",\"Ozono: 40 °C\",\"Ozono: 46 °C\",\"Ozono: 36 °C\",\"Ozono: 46 °C\",\"Ozono: 33 °C\",\"Ozono: 38 °C\",\"Ozono: 39 °C\",\"Ozono: 37 °C\",\"Ozono: 39 °C\",\"Ozono: 35 °C\",\"Ozono: 39 °C\",\"Ozono: 38 °C\",\"Ozono: 35 °C\",\"Ozono: 41 °C\",\"Ozono: 39 °C\",\"Ozono: 38 °C\",\"Ozono: 40 °C\",\"Ozono: 38 °C\",\"Ozono: 38 °C\",\"Ozono: 41 °C\",\"Ozono: 38 °C\",\"Ozono: 42 °C\",\"Ozono: 38 °C\",\"Ozono: 39 °C\",\"Ozono: 34 °C\",\"Ozono: 43 °C\",\"Ozono: 41 °C\",\"Ozono: 36 °C\",\"Ozono: 36 °C\",\"Ozono: 37 °C\",\"Ozono: 29 °C\",\"Ozono: 32 °C\",\"Ozono: 38 °C\",\"Ozono: 27 °C\",\"Ozono: 28 °C\",\"Ozono: 38 °C\",\"Ozono: 53 °C\",\"Ozono: 42 °C\",\"Ozono: 42 °C\",\"Ozono: 44 °C\",\"Ozono: 43 °C\",\"Ozono: 42 °C\",\"Ozono: 39 °C\",\"Ozono: 37 °C\",\"Ozono: 34 °C\",\"Ozono: 35 °C\",\"Ozono: 20 °C\",\"Ozono: 25 °C\",\"Ozono: 24 °C\",\"Ozono: 31 °C\",\"Ozono: 37 °C\",\"Ozono: 47 °C\",\"Ozono: 43 °C\",\"Ozono: 42 °C\",\"Ozono: 43 °C\",\"Ozono: 39 °C\",\"Ozono: 43 °C\",\"Ozono: 41 °C\",\"Ozono: 45 °C\",\"Ozono: 43 °C\",\"Ozono: 41 °C\",\"Ozono: 42 °C\",\"Ozono: 43 °C\",\"Ozono: 39 °C\",\"Ozono: 40 °C\",\"Ozono: 39 °C\",\"Ozono: 32 °C\",\"Ozono: 30 °C\",\"Ozono: 36 °C\",\"Ozono: 39 °C\",\"Ozono: 33 °C\",\"Ozono: 40 °C\",\"Ozono: 40 °C\",\"Ozono: 32 °C\",\"Ozono: 38 °C\",\"Ozono: 36 °C\",\"Ozono: 44 °C\",\"Ozono: 24 °C\",\"Ozono: 37 °C\",\"Ozono: 38 °C\",\"Ozono: 37 °C\",\"Ozono: 38 °C\",\"Ozono: 35 °C\",\"Ozono: 31 °C\",\"Ozono: 35 °C\",\"Ozono: 36 °C\",\"Ozono: 44 °C\",\"Ozono: 42 °C\",\"Ozono: 42 °C\",\"Ozono: 37 °C\",\"Ozono: 37 °C\",\"Ozono: 34 °C\",\"Ozono: 30 °C\",\"Ozono: 36 °C\",\"Ozono: 39 °C\",\"Ozono: 39 °C\",\"Ozono: 37 °C\",\"Ozono: 36 °C\",\"Ozono: 39 °C\",\"Ozono: 40 °C\",\"Ozono: 42 °C\",\"Ozono: 39 °C\",\"Ozono: 41 °C\",\"Ozono: 40 °C\",\"Ozono: 39 °C\",\"Ozono: 36 °C\",\"Ozono: 35 °C\",\"Ozono: 38 °C\",\"Ozono: 40 °C\",\"Ozono: 37 °C\",\"Ozono: 41 °C\",\"Ozono: 47 °C\",\"Ozono: 25 °C\",\"Ozono: 23 °C\",\"Ozono: 45 °C\",\"Ozono: 39 °C\",\"Ozono: 48 °C\",\"Ozono: 31 °C\",\"Ozono: 38 °C\",\"Ozono: 37 °C\",\"Ozono: 37 °C\",\"Ozono: 40 °C\"],null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#440154 , #440154 0%, #453581 15.1515151515152%, #34608D 30.3030303030303%, #25858E 45.4545454545455%, #24AA83 60.6060606060606%, #61CA60 75.7575757575758%, #C2DF23 90.9090909090909%, #FDE725 \"],\"labels\":[\"20\",\"25\",\"30\",\"35\",\"40\",\"45\",\"50\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":0.5,\"position\":\"topright\",\"type\":\"numeric\",\"title\":\"Ozono (ppb)\",\"extra\":{\"p_1\":0,\"p_n\":0.9090909090909091},\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[32.53533172607422,42],\"lng\":[-124.3758239746094,-114.1170120239258]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n```{.r .cell-code}\nozone <- as.geodata(datosOZ) \nsummary(ozone)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNumber of data points: 139 \n\nCoordinates summary\n         Este   Norte\nmin -276541.1 -598934\nmax  500861.7  415184\n\nDistance summary\n       min        max \n   6304.93 1187479.83 \n\nData summary\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n20.00000 35.00000 38.00000 37.48201 40.50000 53.00000 \n```\n\n\n:::\n:::\n\n\n\n\n::: panel-tabset\n### Gráficos de dispersión\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(1,2))\n\nplot(Ozono~Este, data = datosOZ, ylab = \"Ozono\", xlab=\"Este\")\nplot(Ozono~Norte, data = datosOZ, ylab = \"Ozono\", xlab=\"Norte\")\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n### GeoR\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(ozone, qt.col = c(\"purple\",\n                          \"pink\",\n                          \"green\",\n                          \"yellow\"),\n     scatter3d=T)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\nEl gráfico muestra una relación polinomial de la variable Ozono con respecto a las coordenadas en Norte. Se prueba con varios modelos hasta encontrar aquel que mitigue el efecto espacial.\n\n### Modelo de tendencia espacial\n\nEl modelo que mejor atrapa el efecto de la media es:\n\n$$Ozono = \\beta_0+\\beta_1 \\times Norte^2 + \\beta_2 \\times Norte^3 + \\beta_3 \\times Este$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfitO <- lm(Ozono~I(Norte^2)+I(Norte^3)+Este, data = datosOZ) \nsummary(fitO)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Ozono ~ I(Norte^2) + I(Norte^3) + Este, data = datosOZ)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-14.7539  -1.4679   0.4298   2.0686   9.5184 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 3.499e+01  6.033e-01  58.002  < 2e-16 ***\nI(Norte^2)  5.085e-11  1.078e-11   4.716 5.93e-06 ***\nI(Norte^3)  7.940e-17  1.922e-17   4.131 6.30e-05 ***\nEste        1.416e-05  3.326e-06   4.257 3.86e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.984 on 135 degrees of freedom\nMultiple R-squared:  0.4223,\tAdjusted R-squared:  0.4094 \nF-statistic: 32.89 on 3 and 135 DF,  p-value: 5.039e-16\n```\n\n\n:::\n:::\n\n\n\n\nGráficamente se observa una mitigación en la tendencia espacial:\n\n::: panel-tabset\n#### Gráficos de dispersión\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndatosOZ$Residuos <- fitO$residuals\n\npar(mfrow=c(1,2))\nplot(Residuos~Este, data = datosOZ, xlab=\"Este\", ylab=\"Residuos\")\nplot(Residuos~Norte, data = datosOZ, xlab=\"Norte\", ylab=\"Residuos\")\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n#### GeoR\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(ozone, qt.col = c(\"purple\",\n                          \"pink\",\n                          \"green\",\n                          \"yellow\"),\n     scatter3d=T, trend = ~ poly(Norte,3))\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\n### Estimación empírica del semivariograma\n\nA continuación, se presenta la estimación del semivariograma obtenida con la función variog. Se muestran dos gráficos comparativos: el primero corresponde a los datos originales (sin eliminar la tendencia) y el segundo a los residuales obtenidos tras ajustar el modelo de regresión, lo que permite observar el efecto de remover la tendencia en la estructura espacial.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvg_O <- variog(ozone,estimator.type = \"modulus\", pairs.min=50) #Sin tendencia espacial\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nvariog: computing omnidirectional variogram\n```\n\n\n:::\n\n```{.r .cell-code}\nvg1_O <- variog(ozone, trend = ~I(Norte^2)+I(Norte^3)+Este, estimator.type = \"modulus\", pairs.min=50)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nvariog: computing omnidirectional variogram\n```\n\n\n:::\n:::\n\n\n\n\n::: panel-tabset\n#### Con tendencia\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(vg_O,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Sin remover tendencia\",\n     col.main = 4, cex.main =1.3)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\n#### Removiendo Tendencia\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(vg1_O,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Removiendo tendencia\",\n     col.main = 4, cex.main =1.3)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\nSe observa que la estimación de la semivarianza de la variable incrementos es más estable y presenta valores más bajos al remover la tendencia, lo que indica que en este caso el semivariograma refleja de manera más adecuada la verdadera estructura espacial del fenómeno.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(vg1_O$u, vg1_O$n, type=\"b\",\n     xlab=\"distance\", ylab=\"n pairs\",\n     main=\"Número de pares por bin\")\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n\n### Estimación del Modelo Teórico de Semivariograma\n\nLos modelos obtenidos ajustanto por EyeFit, son:\n\n``` text\ncov.model sigmasq      phi tausq kappa kappa2 practicalRange\n1    matern    17.0 440676.0     5   0.5     NA        1320147\n2  gneiting    17.5 803585.6     9    NA     NA        1371348\n3    linear    0.25 0.32     0    NA     NA            Inf\n```\n::: panel-tabset\n\n#### Matern\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsigma_0_mO <- 17.0\nphi_0_mO <- 440676.0\nnugget_0_mO <- 5\nkappa_0_mO <- 0.5\n\nini1_mat_O <- c(sigma_0_mO, phi_0_mO)\nfitvar1_mat_O <- variofit(vg1_O,\n                    cov.model = \"matern\",\n                    ini1_mat_O,\n                    fix.nugget = F,\n                    nugget = nugget_0_mO,\n                    kappa = kappa_0_mO,\n                    wei = \"equal\")\n\nfitvar2_mat_O <- variofit(vg1_O,\n                    cov.model = \"matern\",\n                    ini1_mat_O,\n                    fix.nugget = F,\n                    nugget = nugget_0_mO,\n                    kappa = kappa_0_mO,\n                    wei = \"npairs\")\n\nfitvar3_mat_O <- variofit(vg1_O,\n                    cov.model = \"matern\",\n                    ini1_mat_O,\n                    fix.nugget = F,\n                    nugget = nugget_0_mO,\n                    kappa = kappa_0_mO,\n                    wei = \"cressie\")\n\nfitvar4_mat_O <- likfit(ozone,\n                  coords = ozone$coords,\n                  data = ozone$data,\n                  trend = ~ I(Norte^2) + I(Norte^3) + Este,\n                  ini.cov.pars = ini1_mat_O,\n                  fix.nugget = F,\n                  nugget = nugget_0_mO,\n                  kappa = kappa_0_mO,\n                  cov.model = \"matern\",\n                  lik.method = \"ML\")\n\n\nplot(vg1_O,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Estimación teórica del modelo de semivariograma \\n (GeoR, gstat)\",\n     col.main = \"#36648B\", cex.main =1.3)\nlines(fitvar1_mat_O, col=\"#FF4040\", lwd=1.5)\nlines(fitvar2_mat_O, col=\"#4169E1\", lwd=1.5)\nlines(fitvar3_mat_O, col=\"#008B00\", lwd=1.5)\nlines(fitvar4_mat_O, col=\"#FFA500\", lwd=1.5)\nlegend(\"topleft\",\n       c(\"MCO\", \"1/n\", \"Cressie\", \"MLE\"),#, \"REML\"),\n       lwd = 1,\n       lty = 3,\n       col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       box.col = 9,\n       text.col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       cex=1,\n       seg.len = .5)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n\n#### Gneiting\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsigma_0_gO <- 17.5\nphi_0_gO <- 803585.6\nnugget_0_gO <- 9\n\nini1_g_O <- c(sigma_0_gO, phi_0_gO)\nfitvar1_g_O <- variofit(vg1_O,\n                    cov.model = \"gneiting\",\n                    ini1_g_O,\n                    fix.nugget = F,\n                    nugget = nugget_0_gO,\n                    wei = \"equal\")\n\nfitvar2_g_O <- variofit(vg1_O,\n                    cov.model = \"gneiting\",\n                    ini1_g_O,\n                    fix.nugget = F,\n                    nugget = nugget_0_gO,\n                    wei = \"npairs\")\n\nfitvar3_g_O <- variofit(vg1_O,\n                    cov.model = \"gneiting\",\n                    ini1_g_O,\n                    fix.nugget = F,\n                    nugget = nugget_0_gO,\n                    wei = \"cressie\")\n\nfitvar4_g_O <- likfit(ozone,\n                  coords = ozone$coords,\n                  data = ozone$data,\n                  trend = ~ I(Norte^2) + I(Norte^3) + Este,\n                  ini.cov.pars = ini1_g_O,\n                  fix.nugget = F,\n                  nugget = nugget_0_gO,\n                  cov.model = \"gneiting\",\n                  lik.method = \"ML\")\n\n\nplot(vg1_O,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Estimación teórica del modelo de semivariograma \\n (GeoR, gstat)\",\n     col.main = \"#36648B\", cex.main =1.3)\nlines(fitvar1_g_O, col=\"#FF4040\", lwd=1.5)\nlines(fitvar2_g_O, col=\"#4169E1\", lwd=1.5)\nlines(fitvar3_g_O, col=\"#008B00\", lwd=1.5)\nlines(fitvar4_g_O, col=\"#FFA500\", lwd=1.5)\nlegend(\"topleft\",\n       c(\"MCO\", \"1/n\", \"Cressie\", \"MLE\"),#, \"REML\"),\n       lwd = 1,\n       lty = 3,\n       col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       box.col = 9,\n       text.col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       cex=1,\n       seg.len = .5)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n\n#### Lineal\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsigma_0_lO <- 0.25\nphi_0_lO <- 0.32\nnugget_0_lO <- 0\n\nini1_l_O <- c(sigma_0_lO, phi_0_lO)\nfitvar1_l_O <- variofit(vg1_O,\n                    cov.model = \"linear\",\n                    ini1_l_O,\n                    fix.nugget = F,\n                    nugget = nugget_0_lO,\n                    wei = \"equal\")\n\nfitvar2_l_O <- variofit(vg1_O,\n                    cov.model = \"linear\",\n                    ini1_l_O,\n                    fix.nugget = F,\n                    nugget = nugget_0_lO,\n                    wei = \"npairs\")\n\nfitvar3_l_O <- variofit(vg1_O,\n                    cov.model = \"linear\",\n                    ini1_l_O,\n                    fix.nugget = F,\n                    nugget = nugget_0_lO,\n                    wei = \"cressie\")\n\nfitvar4_l_O <- likfit(ozone,\n                  coords = ozone$coords,\n                  data = ozone$data,\n                  trend = ~ I(Norte^2) + I(Norte^3) + Este,\n                  ini.cov.pars = ini1_l_O,\n                  fix.nugget = F,\n                  nugget = nugget_0_lO,\n                  cov.model = \"linear\",\n                  lik.method = \"ML\")\n\n\nplot(vg1_O,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Estimación teórica del modelo de semivariograma \\n (GeoR, gstat)\",\n     col.main = \"#36648B\", cex.main =1.3)\nlines(fitvar1_l_O, col=\"#FF4040\", lwd=1.5)\nlines(fitvar2_l_O, col=\"#4169E1\", lwd=1.5)\nlines(fitvar3_l_O, col=\"#008B00\", lwd=1.5)\nlines(fitvar4_l_O, col=\"#FFA500\", lwd=1.5)\nlegend(\"topleft\",\n       c(\"MCO\", \"1/n\", \"Cressie\", \"MLE\"),#, \"REML\"),\n       lwd = 1,\n       lty = 3,\n       col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       box.col = 9,\n       text.col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       cex=1,\n       seg.len = .5)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n\n\n:::\n\n### Kriging\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#| message: false\n#| warning: false\n#| results: 'hide'\n\nbest_model_O <- gstat::vgm(psill = fitvar1_mat_O$cov.pars[1],\n                           model = \"Mat\",\n                           range = fitvar1_mat_O$cov.pars[2],\n                           nugget = fitvar1_mat_O$nugget,\n                           kappa = fitvar1_mat_O$kappa\n                           \n)\n\ncoordinates(datosOZ) <- ~Este + Norte\nproj4string(datosOZ) <- CRS(\"EPSG:3310\")\n\ng_obj<-gstat::gstat(id=\"Ozono\",\n             formula = Ozono ~ I(Norte^2) + I(Norte^3) + Este,\n             model = best_model_O,\n             data = datosOZ)\n\npredic <- predict(g_obj, newdata = new, nmin = 12, maxdist=fitvar3_mat_O$cov.pars[2])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[using universal kriging]\n```\n\n\n:::\n\n```{.r .cell-code}\nprediction <- data.frame(predic)\n\n#Mapas de predicción\n\ngridded(predic) <- TRUE\n\n#1. Mapa de Kriging\n\npredic_raster_utm <- raster(predic, layer = \"Ozono.pred\")\n\n# 2. Asegurarse de que el CRS del ráster se asigne correctamente (EPSG:3310)\ncrs(predic_raster_utm) <- \"+init=epsg:3310\"\n\npredic_raster_wgs84 <- raster::projectRaster(\n    raster::mask(\n        predic_raster_utm, \n        sh_mundos_sp_utm_simple\n    ),\n    crs = \"+init=epsg:4326\", \n    method = \"bilinear\"\n)\n\nbins <- seq(15,55, by=5)\n\npred_range <- c(minValue(predic_raster_wgs84), maxValue(predic_raster_wgs84))\npal_pred <- colorBin(\n  palette = \"viridis\", # La paleta de colores\n  domain = pred_range,\n  bins = bins,\n  na.color = \"transparent\"\n)\n\nmapa_kriging_leaflet <- leaflet() %>%\n  addProviderTiles(providers$CartoDB.Positron) %>%\n  \n  # Añadir la capa ráster de Predicción Kriging\n  addRasterImage(\n    predic_raster_wgs84, # Usamos el objeto raster reproyectado\n    colors = pal_pred, \n    opacity = 0.7,\n    group = \"Predicción Kriging\"\n  ) %>%\n    addCircleMarkers(data = datosO_sf_wgs84,\n                   fillColor = ~palO(Ozono),\n                   fillOpacity = 0.8,\n                   color = \"black\",\n                   weight = 1,\n                   radius = 6,\n                   popup = ~paste(\"Ozn:\", Ozono, \"ppb\")) %>% \n  \n  addLegend(\n    pal = pal_pred, \n    values = pred_range,\n    title = \"Predicción Oz ppb\",\n    position = \"topright\"\n  ) %>%\n  \n  addLegend(pal = palO,\n            values = datosO_sf_wgs84$Ozono,\n            title = \"Ozono Observado\",\n    position = \"topleft\"\n  ) \n\n#2 Mapa Varianza------------------------------------------\n\nvar_raster_utm <- raster(predic, layer = \"Ozono.var\")\n\n# 2. Asegurarse de que el CRS del ráster se asigne correctamente (EPSG:3310)\ncrs(var_raster_utm) <- \"+init=epsg:3310\"\n\nvar_raster_wgs84 <- raster::projectRaster(\n    raster::mask(\n        var_raster_utm, \n        sh_mundos_sp_utm_simple\n    ),\n    crs = \"+init=epsg:4326\", \n    method = \"bilinear\"\n)\n\nbinsv <- seq(0,30, by=5)\n\nvar_range <- c(minValue(var_raster_wgs84), maxValue(var_raster_wgs84))\npal_var <- colorBin(\n  palette = \"Spectral\", # La paleta de colores\n  domain = var_range,\n  bins = binsv,\n  na.color = \"transparent\"\n)\n\nmapa_var_leaflet <- leaflet() %>%\n  addProviderTiles(providers$CartoDB.Positron) %>%\n  \n  # Añadir la capa ráster de Predicción Kriging\n  addRasterImage(\n    var_raster_wgs84, # Usamos el objeto raster reproyectado\n    colors = pal_var, \n    opacity = 0.7,\n    group = \"Predicción Kriging\"\n  ) %>%\n  addLegend(\n    pal = pal_var, \n    values = var_range,\n    title = \"Varianza\",\n    position = \"topright\"\n  ) \n\n#3. Mapa Cv ----------------------------------------------\n\ncv_raster_utm <- sqrt(var_raster_utm) / abs(predic_raster_utm)\n\nmapa_mayor_a_uno <- cv_raster_utm > 1\ncv_raster_utm[mapa_mayor_a_uno] <- 1\n\ncrs(cv_raster_utm) <- \"+init=epsg:3310\"\n\ncv_raster_masked_utm <- raster::mask(cv_raster_utm, sh_mundos_sp_utm_simple)\n\n# 2. Aplicar CROP (Recorte físico del rectángulo)\ncv_raster_cropped_utm <- raster::crop(cv_raster_masked_utm, sh_mundos_sp_utm_simple)\n\n# 3. Reproyectar el objeto MÁS PEQUEÑO a WGS84\ncv_raster_wgs84 <- raster::projectRaster(\n    cv_raster_cropped_utm, \n    crs = \"+init=epsg:4326\", \n    method = \"bilinear\"\n)\n\nbincv <- seq(0,1, by=.1)\n\ncv_range <- c(minValue(cv_raster_wgs84), maxValue(cv_raster_wgs84))\n\npal_cv <- colorBin(\n  palette = \"RdYlGn\", # Rojo-Amarillo-Verde\n  domain = cv_range,\n  na.color = \"transparent\",\n  bins = bincv,\n  reverse = TRUE # ¡Esto es CRUCIAL! Para que el Verde sea BAJA incertidumbre.\n)\n\nmapa_cv_leaflet <- leaflet() %>%\n  addProviderTiles(providers$CartoDB.Positron) %>%\n  \n  # Añadir la capa ráster de Predicción Kriging\n  addRasterImage(\n    cv_raster_wgs84, # Usamos el objeto raster reproyectado\n    colors = pal_cv, \n    opacity = 0.7,\n    group = \"Predicción Kriging\"\n  ) %>%\n  \n  addLegend(\n    pal = pal_cv, \n    values = cv_range,\n    title = \"Coeficiente de Variación\",\n    position = \"topright\"\n  )\n```\n:::\n\n\n\n\n::: panel-tabset\n#### Predicción\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmapa_kriging_leaflet\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-1849ed9967d7bb134a24\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-1849ed9967d7bb134a24\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.Positron\",null,null,{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addRasterImage\",\"args\":[\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAV8AAAGECAYAAACRTCNtAAAQK0lEQVR4nO3dvYpcV9aA4d0fAvsWRlFjGBA4dGjQDSieVMwVCJwpVKhM4CswSh37BgQTTigwGExH9i3YUX2BfDzVpfo5/2vtvZ8HJrCtUR/Z9Fur19mn6u5wOBQA9vV/0RcA0CPxBQggvgABxBcggPgCBBBfgADiCxDgydq/4Q+/fLvZweF///M/d1v8vmtc81bXBrTpbu5DFltGlvy82MAy1g7M4sUXlhFfZhNgmE98AQKIL0CAWfH14ybAMiZfgADiCxBg1kMWP/7+zdm//69//HfRxQD0YtUn3C5FeU0CD7Rg9hNuLz68avamm8CP50k3mGf193ZowbUJXpiBNYjvRLdWK+IMjDF77VBK26uHPbQQamsHmMfkG2jqDcoWYg18Ir4VmXOaRLAhJ/Ft3JRgCzXsZ9HOtxR7396cBtrOF+ZZHN9SBLhnPz3/XnxhBu/tABBAfAECiC9AAPEFCCC+AAHEFyCA+AIEEF+AAOILEEB8AQKIL0CAxfH1vg4A0y2Kr/ACzLMovj89//7Ou1oBTGfnCxBg0SdZWDsAzGPyBQggvgABxBcggPgCBBBfgADiCxBAfAECiC9AAPEFCCC+AAHEFyCA+AIEmB1fb6oDMJ/JFyCA+AIEmB3fjw9P17wOgK7Miu/9+7f2vQALTP4ki+Pwnpt+v77/beElAbRv0ccInSPIALdNiu/cdYMgAzw2Or5r73lPgyzG4+11s9N/E9jO6muHuUzHj2U4TXLtGnr+bwNrSBPfc3oJcobQTvX3NT+PvQ6oVer4nlNzkGuMLLCNm/Gt4UxvpiALLDBGdZPvWFsHWWSBJZqN7zmXgjkmymILrKmr+F4irMDevKsZQADxBQggvgABxBcggPgCBBBfgAA34/vw8vXdw8vXd3tcDEAvRk2+NTxiDFCTm/EVXoD12fkCBLj5ePHxvtcUDLCOSZOvm28A65i1dhBggGXsfAECzI6vFQTAfIsnXwEGmM7aASDAKvE1/QJMs9rkK8AA4626dhBggHHsfAECrB5f0y/AbZtMvgIMcN1mawcBBrjMzhcggPgCBNg0vlYPAOdtPvkKMMDnrB0AAogvQIBd4mv1APCYyRcggPgCBLj50fHk9uWvXzz66z+++jPoSoApxLcCp4Gd82tFGXK5OxwOu37B+/dv9/2ClZoS3KnWDLGbqTCPyTeZLaN7+jVMwxBn1/iaei/bI7qXvqYIw/52i6/wnhcR3UvXIMKwH0fNAmUI77Evf/0i3TVBq8Q3QPbIZb42aIX47qyWsNVynVAr8d1RbUGr7XqhJuK7k1pDVut1Q3biu4PaA1b79UNG4ssoAgzrEt+NtRStlv4sEE18N9RirFr8M0EE8d2ISAHXiC+TeWGB5XaLb09vPdhDnHr4M8KWdp18ewhwT1Hq6c8Ka7N2AAggvisyCQJj7R7fVlcPwgtMYfIFCCC+KzD1AlOJ70LCC8whvgsILzBXSHxbuOkmvMASd4fD/h8qXPsnGQvv535+8131L6iwJ2sHVvHszbvDszfvqn5RhT2J70Sm3usEGMax851AeMcRYLgtbPKtLcDCC6wp5IbbsRpuvgnvPH989Wd1L7Kwl/Cdr29OoEfh8S0ld4BNvcvU8JMNRAhfOxzL9o0qvMv98dWfj/468wst7CnF5DvI9I0pvMCWUsU3C+HdTrafbiBKqrXDsahvUuFd1+naYZDppxyIYPI9Irz7MQHTO/H9i/DuT4DpWdq1w2Drb1DR3daltcMxKwh61PXkK7w5mIDpUfrJt5RtvjmFdx9jJt9jpmB60d3k++WvXwhvYqZgelHF5DtY8o0puDGmTr4DEzCta37yNenWyQRM66qafI9d++YU2xzmTr3HTMC0qtr4lvI4wIKbzxrxLUWAaVPVa4dhpSC8bbOCoEVVT74DnxmW01qT78AETEuqnnzpy/37twdTMK1oIr4/v/nORJTM2lPvMQGmBU3El/4IMLVrJr6m3zy2nHqPCTA1aya+9EmAqVVT8TX99kmAqVFT8S1FgKPttXI4JcDUprn40i9H0aiJ+LKaqKn3lABTg+bi62k3ShFg8mvi8eLBGuE9tzMW9NuyTL2nPJJMVs1Nvlu4dRPPTb68TMBk1VR8t4rgrcm398k469Q7EGAyaiq+pawf4N7D2goBJpumdr7nTI3ncbyF97bsU+859sBk0Nzke+rnN9/dzZmGhbddpmAyaD6+gykBFt5xapx6BwJMtG7iW8r4ADu90AcBJlJX8S1FWHlMgInSXXxvsXIYp+aVwykBJkLzpx2uORdapx3GaSm+A6cg2FPX8R1cirD4XtZifEsRYPYjvkdOYztMwSL8WKvhHQgwe7DzvUJ0+2QHzB7E9y+XQvvszbuDExL9EWC2Jr5l3IQ790k56iXAbOlJ9AVkJrafa33fe+r+/duDHTBbMPlOJMj9MQGzBfGFEQSYtYkvjOTTkVmT+F7x7M27w62n4OiPALMG8R3BeV9OCTBLie9Il6Zg+iXALCG+Ew0B7nH10NsxszEEmLm8t8MRk+114nuZs8BMZfI90uM0yzpMwEwlvrASAWYK8YUVOQvMWOILGxBgbnHD7QI33z7nhtt0bsRxickXNmQC5hLxZRRT73wCzDnie4aVA2sTYE6J7wnhZSsCzDHxBQjgtMMFJuDH7HzX5RQEJl9uEt71WUEgvhd4nwe2JsB9E18IJMD9svMdoff9r7XD9uyA+2Py5Srh3d7X97+VFx9edf0C3yPxHcH+lz0IcF+sHSbqbQVh8t3W1/e/nf37Pz3/3gt+40y+E5mCWcul8JZiCu6B+M4gwOxBgNsmvjP1EGArh+1cm3qPCXC77HxX8OzNu8NpjFvYDYvvNsaG95gdcHtMvivoYQomlgm4PeILO5oz9Q4EuC3WDhuref1g7bCuJeE9ZgXRBpMvVMYE3AbxhR2sNfUOBLh+4gsbWzu8AwGum/hCxQS4XuILG9pq6j0mwHUSX9jIHuEdCHB9xBcaIcB1EV/YwJ5T77EXH14dRLgOHrJYWc0PVZzykMU8UeE95WGM3Ey+KxJeMjEB5ya+fEZ458sy9Q4EOC/x5RHhnS9beAcCnJP4Uv746s+//0ebBDifJ9EX0ANRa1/WqffYiw+vDm7C5eG0wwaGG2+i24cawjsQ3zysHTbgR3iysn7IQ3xhgZqm3oEHMXIQX+iUAMcS3w08vHxtr9aBGqfeUwIcR3yhcwIcQ3xhhham3mMCvD/xhYlaC+9AgPclvsDfBHg/HrLY2P37t/4FN6TVqfccD2Rsy+QLnGUK3pbJd0em4Lr1NPUeMwFvw+S7o4eXr++cAQZKEd8QAlyfXqfeUqwftmLtEMgaoh49x/eYFcR6TL6BTMB1EF62IL7AaN4RbT3iG8z0S40EeDk73yTsf3OycrjNHngeky+wiCl4HvFNwvohH1MvWxJfgADiCyzmFMR04puI1UMeVg5szWmHhJx8iCe+yzgBcZvJNyETMLWzgrhNfJMS4Dim3nUI8HXiC2xGgC8TX4AAbrgl5+bbvqwctuMm3GMm3+TsfqFNJt9KmID3YfLdngn4E5NvJUzAtMJNuE9MvpUxAW/H1Lu/nqdgk29lTMDQBvGtkABD/awdKmYFsS5rhzg9rh9MvhUzAa9HeGP1eBNOfCsnwLSitwBbOzTCCmIZk28uPawhxLcxIjyP+ObTeoCtHRpjDTGd8BJBfIGUWt8Biy+QVssBFl+6ZuWQ3w+/fNtkgMUXSOtf//hvKaXNAIsvkNIQ3kFrAX4SfQEAx06je2wI8L//+Z/qT/WYfOmWfW8+18J7rIUpWHwb5KwvNRob3kHtAfaEW+M88XaZyTeHqdE9VesKws63ccdTsBCTzdLw1szaoSPWEf9j6o23VnhrXT+IL7C7tSfeGgMsvsCutlo11BZgO1+6Y+UQY4/9bk3ngE2+wOb2vrFWwxQsvh1x2oEIPZ9ouEZ8gc0I72XiS1fse/cjvNeJb0ec82Uvwnub+AKrEt5xxBcggPgCq8k09f7wy7eHzEfOxBdYRabw1kB8gcUyhzfr9Cu+QPMyBlh8gUUyT72ZiS8wW03hzTb9ii/QjUwBFt+OeGMd1lTT1HssS4DFFyCA+HbEezuU8vHhafQlNKHWqTcT8e2MAEMOd4dDivUHQXrcA3tbyeVamHyjP2rI5Nu5Hidhq4dlWghvKfE33sSXLgMM0cSXUkp/ATb9ztPK1DuInH7tfFlNjftj+99pWovvIGL/K75soqYQC/B4rcZ3sGeExZcwmQItwLe1Ht7BXgEWX8JlibAAX9dLfEvZJ8BuuBHu4eXruww3/D4+PHUjjt2IL2mIMD0RX7hAhP/HymF94ks6GabfYyLcjz1PO4gvKWULcCkezGjd3md9n+z5xaB2Hx+eOhWR0I+/fzPq111an3jIAk5kOYZ2qrcAZ9z5jg3uJcOfKerdzcSX9LIGuJR+IpwpvkujW0opPz3/PnytZefLau7fvz1sEcosR9B61Vp4szD5sopL0R2iee6fzw1qtkm49ek3S3zXDG+GydcNN0Y7jt7YcG41CW/5+0/lJty21p52M4S3FJMvI42ZXKeEcO01wunXvvX7bxHtVgMcOfm2Gt5SxJcbbkVqaoCz7G63mphbDHBUfFtbM5xyw41VXYprtptmma6Fz7Ue3lJMvow09YbZ8OuzR8764baIybfldcPA5MsopxG9FdVsky71aOk42TXiy2Siep33gJivl/CW4qgZE4guW+opvKWYfAFCiC9w1R4T6dZf48WHV+lOFogvbMDed7ze1g0DO1+6du69J7I9vtyyXsNbivjCVUL8yY+/f7P6ed+ew1uK+EIpZdxJjoeXr+96DvCaeg9vKXa+MEnPx+3WCqbwfiK+MJEAx/3/W+K9HWCBa2uI1t7j4dic/W9keDO+t4P4wgrORbjl+JYyPsDR027G8JYivrCa0wC3Ht9jpyGODu4x8YVODBHuKb6ZZY2vG250ZY+jYj3fkMsma3hLMfnSkamf87ZExvcS6E3m8JZi8qUjSz7wc6rs3/jEM/nSnakfibSUKXhftbzwmXyhbD8F1xKE2tX071l84S9b34yrKQxsT3zpzphPXd6KADMQX7rkOBjR3HCDIG7EbaOWny5MvgABxBcggPgCBBBfCFLLbpJtiC8EEuB+iS9AAPGFYKbfPokvQIAn0RcAexkeHfZ0W9tOH17J+pOFyRcSyBqIFmR9klB86c4eHyVELhkDLL50w7qBTMSXLpl++5Nt+hVfunX//u1BhIkivnTl3OpBgIkgvnTH7rdP2U6UiC9dEmCieciCbgkwkUy+QPOyrRxKEV+AEOILSXx8eFo+PjyNvozmZJx6S/HpxZDK6bG3r+9/i7qUVLIGdAnxhYSGCLcY39OQDk+etRjYa8QXEjqegGsMcG8hnUN8IakM0++5iL748OogrsuJLyS2dYBFNI6HLKACHx+eXg3wENFaPsUB8YWmiG09rB0AAnjIAiCA+AIEEF+AAOILEEB8AQKIL0AA8QUIIL4AAf4f0euhDfE1BhMAAAAASUVORK5CYII=\",[[42.23353560324875,-124.6411064390264],[32.26193560324877,-113.3038064390263]],null,\"Predicción Kriging\",{\"tileSize\":256,\"zIndex\":1,\"minZoom\":0,\"opacity\":0.7}]},{\"method\":\"addCircleMarkers\",\"args\":[[37.743061,37.8148,37.6547,38.342606,39.76168,38.20185,39.18919,38.006311,37.743649,36.7056,36.78538,36.8414,36.6324,36.5975,36.819199,39.53387,32.67618,32.7917,33.0325,37.360701,36.5092,37.3667,35.345607,35.0544,35.356615,35.438035,35.3313,35.23918,35.50349,36.3144,34.1439,34.051097,34.066429,34.1992,33.9014,34.010283,34.0667,34.13263,34.3833,36.8669,36.9533,37.9722,37.713299,39.145733,36.48187,36.209286,36.694261,39.234402,33.830586,33.925062,39.1003,38.74643,39.166,33.7472,33.920758,33.583099,33.852605,33.999449,33.996387,33.676535,33.61235,38.613804,38.56844,38.302591,38.683304,38.494475,36.843425,36.485001,34.894054,34.243132,34.510955,35.774455,34.100132,34.416506,34.059626,34.0714,34.106678,32.631229,32.842297,33.217026,32.579361,32.845467,32.789561,37.7658,37.6825,35.614668,35.0315,35.494556,35.64366,35.35474,37.4828,34.42775,34.7256,34.5414,34.402802,34.4897,34.637798,34.445301,34.605819,36.999571,37.3483,37.2267,36.98332,40.5497,40.5403,41.72679,38.102507,38.356556,37.642165,37.4883,39.13868,40.170917,36.489399,36.0319,37.98178,34.21017,34.40428,34.44806,34.27632,34.25239,38.53455,38.661239,39.757861,38.730278,36.6972,35.04944,33.793713,34.181977,34.7254,38.93568,38.86794,33.447867,32.710177,32.72519,37.961578,35.361589,34.890667,36.30815,36.1358],[-122.169907,-122.282402,-122.0317,-120.764426,-121.84047,-120.680277,-121.99887,-121.641918,-121.934188,-119.7414,-119.77321,-119.8744,-120.3822,-119.5036,-119.7164,-122.190834,-115.48307,-115.5617,-115.6225,-118.330835,-116.8481,-118.4167,-118.851825,-119.4039,-119.062613,-119.016787,-119,-118.78863,-119.27264,-119.6436,-117.8508,-118.456386,-118.226755,-118.5331,-118.205,-118.068484,-117.7506,-118.127142,-118.5283,-120.01,-120.0341,-122.5189,-119.7061,-123.202995,-121.73333,-121.126371,-121.623271,-121.055603,-117.938509,-117.952586,-120.9528,-121.26498,-120.1488,-115.8201,-116.858419,-117.072197,-116.540965,-117.415831,-117.4925,-117.331027,-114.60209,-121.368007,-121.49311,-121.420838,-121.164457,-121.211131,-121.3621,-121.155602,-117.024756,-117.272275,-117.32555,-117.372109,-117.491982,-117.285602,-117.147347,-116.3906,-117.274063,-117.059074,-116.768326,-117.396156,-116.929486,-117.123894,-116.944222,-122.3978,-121.4406,-120.656912,-120.50101,-120.666203,-120.23134,-120.04013,-122.2022,-119.69091,-120.4278,-119.7906,-119.457497,-120.0458,-120.456703,-119.827797,-120.07506,-121.574684,-121.8947,-121.9786,-121.98822,-122.3792,-121.5764,-122.63359,-122.237976,-121.949853,-120.994212,-120.8358,-121.61884,-122.255667,-118.826897,-119.055,-120.378551,-118.87051,-118.80998,-119.2313,-118.68369,-119.14318,-121.7734,-121.732683,-121.607908,-120.813697,-119.0189,-118.18893,-118.171019,-118.363036,-118.1786,-121.09959,-121.33835,-117.088649,-117.142665,-116.36441,-121.281414,-120.836819,-120.432844,-119.3129,-118.8108],6,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":\"black\",\"weight\":1,\"opacity\":0.5,\"fill\":true,\"fillColor\":[\"#25858E\",\"#2A768E\",\"#2D708E\",\"#228D8D\",\"#25858E\",\"#228D8D\",\"#1FA287\",\"#277E8E\",\"#2A768E\",\"#2A768E\",\"#31688E\",\"#20938C\",\"#38598C\",\"#20938C\",\"#228D8D\",\"#1FA287\",\"#51C46A\",\"#24AA83\",\"#73D056\",\"#228D8D\",\"#73D056\",\"#2A768E\",\"#1E9B8A\",\"#1FA287\",\"#20938C\",\"#1FA287\",\"#25858E\",\"#1FA287\",\"#1E9B8A\",\"#25858E\",\"#2BB07F\",\"#1FA287\",\"#1E9B8A\",\"#24AA83\",\"#1E9B8A\",\"#1E9B8A\",\"#2BB07F\",\"#1E9B8A\",\"#35B779\",\"#1E9B8A\",\"#1FA287\",\"#277E8E\",\"#41BE71\",\"#2BB07F\",\"#228D8D\",\"#228D8D\",\"#20938C\",\"#38598C\",\"#2D708E\",\"#1E9B8A\",\"#3F4788\",\"#3C508B\",\"#1E9B8A\",\"#FDE725\",\"#35B779\",\"#35B779\",\"#51C46A\",\"#41BE71\",\"#35B779\",\"#1FA287\",\"#20938C\",\"#277E8E\",\"#25858E\",\"#440154\",\"#453581\",\"#472C7A\",\"#31688E\",\"#20938C\",\"#85D54A\",\"#41BE71\",\"#35B779\",\"#41BE71\",\"#1FA287\",\"#41BE71\",\"#2BB07F\",\"#61CA60\",\"#41BE71\",\"#2BB07F\",\"#35B779\",\"#41BE71\",\"#1FA287\",\"#24AA83\",\"#1FA287\",\"#2D708E\",\"#34608D\",\"#228D8D\",\"#1FA287\",\"#2A768E\",\"#24AA83\",\"#24AA83\",\"#2D708E\",\"#1E9B8A\",\"#228D8D\",\"#51C46A\",\"#472C7A\",\"#20938C\",\"#1E9B8A\",\"#20938C\",\"#1E9B8A\",\"#25858E\",\"#31688E\",\"#25858E\",\"#228D8D\",\"#51C46A\",\"#35B779\",\"#35B779\",\"#20938C\",\"#20938C\",\"#277E8E\",\"#34608D\",\"#228D8D\",\"#1FA287\",\"#1FA287\",\"#20938C\",\"#228D8D\",\"#1FA287\",\"#24AA83\",\"#35B779\",\"#1FA287\",\"#2BB07F\",\"#24AA83\",\"#1FA287\",\"#228D8D\",\"#25858E\",\"#1E9B8A\",\"#24AA83\",\"#20938C\",\"#2BB07F\",\"#85D54A\",\"#453581\",\"#482173\",\"#61CA60\",\"#1FA287\",\"#99D83D\",\"#31688E\",\"#1E9B8A\",\"#20938C\",\"#20938C\",\"#24AA83\"],\"fillOpacity\":0.8},null,null,[\"Ozn: 35 ppb\",\"Ozn: 33 ppb\",\"Ozn: 32 ppb\",\"Ozn: 36 ppb\",\"Ozn: 35 ppb\",\"Ozn: 36 ppb\",\"Ozn: 39 ppb\",\"Ozn: 34 ppb\",\"Ozn: 33 ppb\",\"Ozn: 33 ppb\",\"Ozn: 31 ppb\",\"Ozn: 37 ppb\",\"Ozn: 29 ppb\",\"Ozn: 37 ppb\",\"Ozn: 36 ppb\",\"Ozn: 39 ppb\",\"Ozn: 44 ppb\",\"Ozn: 40 ppb\",\"Ozn: 46 ppb\",\"Ozn: 36 ppb\",\"Ozn: 46 ppb\",\"Ozn: 33 ppb\",\"Ozn: 38 ppb\",\"Ozn: 39 ppb\",\"Ozn: 37 ppb\",\"Ozn: 39 ppb\",\"Ozn: 35 ppb\",\"Ozn: 39 ppb\",\"Ozn: 38 ppb\",\"Ozn: 35 ppb\",\"Ozn: 41 ppb\",\"Ozn: 39 ppb\",\"Ozn: 38 ppb\",\"Ozn: 40 ppb\",\"Ozn: 38 ppb\",\"Ozn: 38 ppb\",\"Ozn: 41 ppb\",\"Ozn: 38 ppb\",\"Ozn: 42 ppb\",\"Ozn: 38 ppb\",\"Ozn: 39 ppb\",\"Ozn: 34 ppb\",\"Ozn: 43 ppb\",\"Ozn: 41 ppb\",\"Ozn: 36 ppb\",\"Ozn: 36 ppb\",\"Ozn: 37 ppb\",\"Ozn: 29 ppb\",\"Ozn: 32 ppb\",\"Ozn: 38 ppb\",\"Ozn: 27 ppb\",\"Ozn: 28 ppb\",\"Ozn: 38 ppb\",\"Ozn: 53 ppb\",\"Ozn: 42 ppb\",\"Ozn: 42 ppb\",\"Ozn: 44 ppb\",\"Ozn: 43 ppb\",\"Ozn: 42 ppb\",\"Ozn: 39 ppb\",\"Ozn: 37 ppb\",\"Ozn: 34 ppb\",\"Ozn: 35 ppb\",\"Ozn: 20 ppb\",\"Ozn: 25 ppb\",\"Ozn: 24 ppb\",\"Ozn: 31 ppb\",\"Ozn: 37 ppb\",\"Ozn: 47 ppb\",\"Ozn: 43 ppb\",\"Ozn: 42 ppb\",\"Ozn: 43 ppb\",\"Ozn: 39 ppb\",\"Ozn: 43 ppb\",\"Ozn: 41 ppb\",\"Ozn: 45 ppb\",\"Ozn: 43 ppb\",\"Ozn: 41 ppb\",\"Ozn: 42 ppb\",\"Ozn: 43 ppb\",\"Ozn: 39 ppb\",\"Ozn: 40 ppb\",\"Ozn: 39 ppb\",\"Ozn: 32 ppb\",\"Ozn: 30 ppb\",\"Ozn: 36 ppb\",\"Ozn: 39 ppb\",\"Ozn: 33 ppb\",\"Ozn: 40 ppb\",\"Ozn: 40 ppb\",\"Ozn: 32 ppb\",\"Ozn: 38 ppb\",\"Ozn: 36 ppb\",\"Ozn: 44 ppb\",\"Ozn: 24 ppb\",\"Ozn: 37 ppb\",\"Ozn: 38 ppb\",\"Ozn: 37 ppb\",\"Ozn: 38 ppb\",\"Ozn: 35 ppb\",\"Ozn: 31 ppb\",\"Ozn: 35 ppb\",\"Ozn: 36 ppb\",\"Ozn: 44 ppb\",\"Ozn: 42 ppb\",\"Ozn: 42 ppb\",\"Ozn: 37 ppb\",\"Ozn: 37 ppb\",\"Ozn: 34 ppb\",\"Ozn: 30 ppb\",\"Ozn: 36 ppb\",\"Ozn: 39 ppb\",\"Ozn: 39 ppb\",\"Ozn: 37 ppb\",\"Ozn: 36 ppb\",\"Ozn: 39 ppb\",\"Ozn: 40 ppb\",\"Ozn: 42 ppb\",\"Ozn: 39 ppb\",\"Ozn: 41 ppb\",\"Ozn: 40 ppb\",\"Ozn: 39 ppb\",\"Ozn: 36 ppb\",\"Ozn: 35 ppb\",\"Ozn: 38 ppb\",\"Ozn: 40 ppb\",\"Ozn: 37 ppb\",\"Ozn: 41 ppb\",\"Ozn: 47 ppb\",\"Ozn: 25 ppb\",\"Ozn: 23 ppb\",\"Ozn: 45 ppb\",\"Ozn: 39 ppb\",\"Ozn: 48 ppb\",\"Ozn: 31 ppb\",\"Ozn: 38 ppb\",\"Ozn: 37 ppb\",\"Ozn: 37 ppb\",\"Ozn: 40 ppb\"],null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#440154\",\"#46327E\",\"#365C8D\",\"#277F8E\",\"#1FA187\",\"#4AC16D\",\"#9FDA3A\",\"#FDE725\"],\"labels\":[\"15 &ndash; 20\",\"20 &ndash; 25\",\"25 &ndash; 30\",\"30 &ndash; 35\",\"35 &ndash; 40\",\"40 &ndash; 45\",\"45 &ndash; 50\",\"50 &ndash; 55\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":0.5,\"position\":\"topright\",\"type\":\"bin\",\"title\":\"Predicción Oz ppb\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#440154 , #440154 0%, #453581 15.1515151515152%, #34608D 30.3030303030303%, #25858E 45.4545454545455%, #24AA83 60.6060606060606%, #61CA60 75.7575757575758%, #C2DF23 90.9090909090909%, #FDE725 \"],\"labels\":[\"20\",\"25\",\"30\",\"35\",\"40\",\"45\",\"50\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":0.5,\"position\":\"topleft\",\"type\":\"numeric\",\"title\":\"Ozono Observado\",\"extra\":{\"p_1\":0,\"p_n\":0.9090909090909091},\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[32.26193560324877,42.23353560324875],\"lng\":[-124.6411064390264,-113.3038064390263]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n#### Varianza\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmapa_var_leaflet\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-94390e79b47470b385e2\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-94390e79b47470b385e2\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.Positron\",null,null,{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addRasterImage\",\"args\":[\"data:image/png;base64,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\",[[42.23353560324875,-124.6411064390264],[32.26193560324877,-113.3038064390263]],null,\"Predicción Kriging\",{\"tileSize\":256,\"zIndex\":1,\"minZoom\":0,\"opacity\":0.7}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#D53E4F\",\"#FC8D59\",\"#FEE08B\",\"#E6F598\",\"#99D594\",\"#3288BD\"],\"labels\":[\"0 &ndash; 5\",\"5 &ndash; 10\",\"10 &ndash; 15\",\"15 &ndash; 20\",\"20 &ndash; 25\",\"25 &ndash; 30\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":0.5,\"position\":\"topright\",\"type\":\"bin\",\"title\":\"Varianza\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[32.26193560324877,42.23353560324875],\"lng\":[-124.6411064390264,-113.3038064390263]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n#### Coeficiente de variación\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmapa_cv_leaflet\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-252218a2d929f7ce865e\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-252218a2d929f7ce865e\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.Positron\",null,null,{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addRasterImage\",\"args\":[\"data:image/png;base64,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\",[[42.23353560324875,-124.6411064390264],[32.26193560324877,-113.3038064390263]],null,\"Predicción Kriging\",{\"tileSize\":256,\"zIndex\":1,\"minZoom\":0,\"opacity\":0.7}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#006837\",\"#1A9850\",\"#66BD63\",\"#A6D96A\",\"#D9EF8B\",\"#FEE08B\",\"#FDAE61\",\"#F46D43\",\"#D73027\",\"#A50026\"],\"labels\":[\"0.0 &ndash; 0.1\",\"0.1 &ndash; 0.2\",\"0.2 &ndash; 0.3\",\"0.3 &ndash; 0.4\",\"0.4 &ndash; 0.5\",\"0.5 &ndash; 0.6\",\"0.6 &ndash; 0.7\",\"0.7 &ndash; 0.8\",\"0.8 &ndash; 0.9\",\"0.9 &ndash; 1.0\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":0.5,\"position\":\"topright\",\"type\":\"bin\",\"title\":\"Coeficiente de Variación\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[32.26193560324877,42.23353560324875],\"lng\":[-124.6411064390264,-113.3038064390263]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n:::\n\n## Variable Temperatura\n\nSe tomaron los datos de Temperatura de la madrugada el primero de marzo de 2024:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nEstacionesT <- data %>% filter(AQSID %in% colnames(Temp_Matrix)[-1])\nEstacionesT <- EstacionesT[,c(1:10,13)]\n\nest_sf_T <- st_as_sf(EstacionesT, \n                      coords = c(\"Longitude\", \"Latitude\"), \n                      crs = 4326)\n\nest_sf_utm_T <- st_transform(est_sf_T, crs = 3310)\ndeci_coord_T = SpatialPoints(cbind(EstacionesT$Longitude,\n                                 EstacionesT$Latitude),\n                           proj4string = CRS(\"+proj=longlat\"))\nutm_coord_T = spTransform(deci_coord_T, CRS(\"EPSG:3310\"))\nutm_coord_df_T = as.data.frame(utm_coord_T)\nEstacionesT$x <- utm_coord_df_T$coords.x1\nEstacionesT$y <- utm_coord_df_T$coords.x2\n\ny_T <- Temp_Matrix[1,] #Tomar una fecha\ny_T <- cbind(colnames(y_T),t(y_T[1,]))\ny_T <- y_T[-1,]\ny_T <- as.data.frame(y_T)\ny_T <- na.omit(y_T)\ny_T <- y_T[-which.min(y_T$V2),]\ny_T <- inner_join(y_T, EstacionesT, by=c(\"V1\"=\"AQSID\"))\ndatosT <- y_T[,c(13,14,2)] #Datos1 es la base con coordenadas + variable\ncolnames(datosT)=c(\"Este\",\"Norte\",\"Temperatura\")\ndatosT$Temperatura <- as.numeric(datosT$Temperatura)\n\ncoords_3310 <- st_coordinates(est_sf_utm_T)\nest_sf_utm_T$Este <- coords_3310[, \"X\"]\nest_sf_utm_T$Norte <- coords_3310[, \"Y\"]\n\n\n# 4. Crear el objeto final de datos (combinando temperatura con las coordenadas UTM)\ndatosT_sf_utm <- merge(est_sf_utm_T, y_T[, c(\"V1\", \"V2\")], by.x = \"AQSID\", by.y = \"V1\")\ndatosT_sf_utm$Temperatura <- as.numeric(datosT_sf_utm$V2)\n\ndatosT_sf_wgs84 <- merge(est_sf_T, y_T[, c(\"V1\", \"V2\")], by.x = \"AQSID\", by.y = \"V1\")\ndatosT_sf_wgs84$Temperatura <- as.numeric(datosT_sf_wgs84$V2)\n\n\n\npal <- colorNumeric(palette = \"viridis\", domain = datosT_sf_wgs84$Temperatura)\n\nleaflet() %>%\n  addProviderTiles(providers$CartoDB.Positron) %>%\n  # Contorno de California\n  addPolygons(data = sh_mundos_wgs84, fill = FALSE, color = \"black\", weight = 2) %>%\n  # Puntos de temperatura\n  addCircleMarkers(data = datosT_sf_wgs84,\n                   fillColor = ~pal(Temperatura),\n                   fillOpacity = 0.8,\n                   color = \"black\",\n                   weight = 1,\n                   radius = 6,\n                   popup = ~paste(\"Temp:\", Temperatura, \"°C\")) %>%\n  addLegend(pal = pal, values = datosT_sf_wgs84$Temperatura, title = \"Temperatura (°C)\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-a3c59bf8438ab7bfad14\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-a3c59bf8438ab7bfad14\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.Positron\",null,null,{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addPolygons\",\"args\":[[[[{\"lng\":[-117.1223754882812,-117.1333312988281,-117.1827087402344,-117.2129135131836,-117.2123794555664,-117.2005081176758,-117.1740798950195,-117.1472244262695,-117.1156234741211,-117.1166534423828,-117.1413879394531,-117.2021560668945,-117.2288131713867,-117.2405471801758,-117.2420425415039,-117.2549896240234,-117.2684783935547,-117.26611328125,-117.2587661743164,-117.2803421020508,-117.2529220581055,-117.2490615844727,-117.25,-117.2698593139648,-117.3197326660156,-117.3294525146484,-117.3402862548828,-117.4094390869141,-117.480827331543,-117.495002746582,-117.6319427490234,-117.6725006103516,-117.7744369506836,-117.8638916015625,-117.8840179443359,-117.9108276367188,-117.9361114501953,-117.9550018310547,-117.9736175537109,-117.9949951171875,-118.0270843505859,-118.0452728271484,-118.0830688476562,-118.1081848144531,-118.1347427368164,-118.2222213745117,-118.2671279907227,-118.272087097168,-118.2977752685547,-118.3180694580078,-118.400016784668,-118.4174652099609,-118.3986206054688,-118.3861846923828,-118.4211044311523,-118.432502746582,-118.4544525146484,-118.4711227416992,-118.508903503418,-118.5300064086914,-118.554443359375,-118.6549987792969,-118.6977691650391,-118.7525024414062,-118.7811126708984,-118.8364028930664,-118.9361114501953,-118.9614028930664,-118.9811096191406,-119.1291732788086,-119.1743011474609,-119.2196502685547,-119.2558441162109,-119.3124694824219,-119.4161071777344,-119.446662902832,-119.5416717529297,-119.5772171020508,-119.5997314453125,-119.6247100830078,-119.7986068725586,-120.0037460327148,-120.1308288574219,-120.245002746582,-120.3550033569336,-120.4241561889648,-120.4490280151367,-120.4819412231445,-120.4953460693359,-120.5583267211914,-120.5831909179688,-120.605827331543,-120.6259613037109,-120.6283264160156,-120.623893737793,-120.6033248901367,-120.5941696166992,-120.5913772583008,-120.5980606079102,-120.6247100830078,-120.6137466430664,-120.6000671386719,-120.6181945800781,-120.6805572509766,-120.7186813354492,-120.7385330200195,-120.8313903808594,-120.8567962646484,-120.8697280883789,-120.8681945800781,-120.8591613769531,-120.8411102294922,-120.9199981689453,-120.9770812988281,-120.9994506835938,-121.0477752685547,-121.1666564941406,-121.2687530517578,-121.29638671875,-121.3215408325195,-121.3680572509766,-121.4349899291992,-121.4418029785156,-121.4609680175781,-121.4720840454102,-121.6654205322266,-121.7580642700195,-121.7961044311523,-121.8676300048828,-121.8641662597656,-121.8734664916992,-121.8847427368164,-121.8976440429688,-121.9216613769531,-121.9432525634766,-121.8997955322266,-121.8656158447266,-121.8450012207031,-121.8255615234375,-121.8091506958008,-121.7993087768555,-121.7747192382812,-121.7639007568359,-121.7991638183594,-121.8511123657227,-121.8791656494141,-121.9135971069336,-121.9783325195312,-122.0202865600586,-122.0415191650391,-122.0709762573242,-122.1472320556641,-122.1795806884766,-122.379020690918,-122.3883438110352,-122.393684387207,-122.3844528198242,-122.3731918334961,-122.378044128418,-122.4259719848633,-122.4433288574219,-122.4806137084961,-122.4902801513672,-122.4958267211914,-122.4994430541992,-122.4905471801758,-122.4843063354492,-122.4481201171875,-122.379638671875,-122.359992980957,-122.3513870239258,-122.35693359375,-122.3673553466797,-122.3577728271484,-122.0643005371094,-122.0231857299805,-122.0058364868164,-122.0297164916992,-122.0808334350586,-122.1259689331055,-122.1308288574219,-122.1384811401367,-122.1572265625,-122.1747131347656,-122.2427673339844,-122.2999877929688,-122.3934097290039,-122.352783203125,-122.2252731323242,-122.1633224487305,-122.1277313232422,-122.0158386230469,-121.9894409179688,-121.9155578613281,-121.8572235107422,-121.8337554931641,-121.6848526000977,-121.6541976928711,-121.6434936523438,-121.5911102294922,-121.498046875,-121.4272155761719,-121.4705505371094,-121.5531921386719,-121.5850067138672,-121.6622161865234,-121.6852188110352,-121.7229156494141,-121.8186798095703,-121.9052734375,-121.977783203125,-122.0186233520508,-122.0500030517578,-122.109733581543,-122.2641830444336,-122.2920837402344,-122.311393737793,-122.3652801513672,-122.3908386230469,-122.4783248901367,-122.479866027832,-122.4433288574219,-122.4201354980469,-122.456672668457,-122.505485534668,-122.6566619873047,-122.7822875976562,-122.8169631958008,-122.8966674804688,-122.9283294677734,-122.9563903808594,-122.9269409179688,-122.8399963378906,-122.8030471801758,-122.8077697753906,-122.83056640625,-122.9586181640625,-123.1072235107422,-123.1290283203125,-123.1716613769531,-123.2372131347656,-123.2666625976562,-123.3130645751953,-123.3530578613281,-123.4475021362305,-123.5361175537109,-123.620002746582,-123.7015228271484,-123.7072601318359,-123.6745834350586,-123.6669387817383,-123.6861038208008,-123.712646484375,-123.7541809082031,-123.7957000732422,-123.7956924438477,-123.774169921875,-123.7630615234375,-123.7368698120117,-123.7723617553711,-123.8202819824219,-123.8674926757812,-123.9311065673828,-124.0623550415039,-124.0927734375,-124.1525726318359,-124.2022171020508,-124.297233581543,-124.331184387207,-124.3240356445312,-124.3233413696289,-124.3543090820312,-124.3758239746094,-124.3523559570312,-124.3319473266602,-124.2750091552734,-124.2529144287109,-124.2294464111328,-124.1994323730469,-124.14306640625,-124.0988922119141,-124.0993041992188,-124.1125030517578,-124.1222229003906,-124.0909729003906,-124.061393737793,-124.0458374023438,-124.0399932861328,-124.0467987060547,-124.063606262207,-124.1186065673828,-124.1813812255859,-124.2155609130859,-124.1973571777344,-124.1902770996094,-124.1752777099609,-124.1841583251953,-124.1858520507812,-123.9505615234375,-123.883903503418,-123.5336227416992,-123.4836120605469,-123.4169464111328,-123.366943359375,-123.3169631958008,-123.2669525146484,-123.2169494628906,-123.1669464111328,-123.116943359375,-123.0669631958008,-122.8999862670898,-122.8177795410156,-122.7508392333984,-122.6341705322266,-122.600830078125,-122.5175018310547,-122.2172164916992,-122.1505584716797,-122.1172180175781,-122.0005569458008,-121.9669494628906,-121.8836212158203,-121.8002777099609,-121.7169494628906,-121.6677703857422,-121.5341567993164,-121.4841613769531,-121.4341583251953,-121.3008270263672,-121.1838836669922,-121.133903503418,-121.0672302246094,-120.9169464111328,-120.8510971069336,-120.7677764892578,-120.6841583251953,-120.3208236694336,-120.0341567993164,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.0008392333984,-120.001106262207,-119.8197326660156,-119.5155563354492,-119.0130615234375,-118.8799896240234,-118.3752670288086,-118.2108306884766,-117.8919525146484,-117.7452697753906,-117.5747222900391,-117.4211120605469,-117.2677764892578,-117.1069488525391,-116.946662902832,-116.8027801513672,-116.6513977050781,-116.4924926757812,-116.1999969482422,-116.0269470214844,-115.8622131347656,-115.7527923583984,-115.5580368041992,-115.2555694580078,-115.1241607666016,-114.9933319091797,-114.6563873291016,-114.6219329833984,-114.6197128295898,-114.5563812255859,-114.4933319091797,-114.4561233520508,-114.4188766479492,-114.3781890869141,-114.3695068359375,-114.3358306884766,-114.2726440429688,-114.230827331543,-114.2005615234375,-114.1700668334961,-114.1516723632812,-114.1344528198242,-114.1170120239258,-114.2226409912109,-114.3141632080078,-114.3576278686523,-114.3834762573242,-114.4070892333984,-114.4207611083984,-114.4554061889648,-114.4755630493164,-114.5127868652344,-114.5233306884766,-114.510009765625,-114.4941635131836,-114.48388671875,-114.5275039672852,-114.6404876708984,-114.7255630493164,-114.7260971069336,-114.7038879394531,-114.6836090087891,-114.6681900024414,-114.6752777099609,-114.6965179443359,-114.6970748901367,-114.6788787841797,-114.6626281738281,-114.6029205322266,-114.5701370239258,-114.5452728271484,-114.5153503417969,-114.4644470214844,-114.4587478637695,-114.5352096557617,-114.5541687011719,-114.5844497680664,-114.6125030517578,-114.6526412963867,-114.6955490112305,-114.7190933227539,-114.7297973632812,-114.8713455200195,-115.0258941650391,-115.2024993896484,-115.404167175293,-115.6055603027344,-115.9077835083008,-116.2426376342773,-116.5081481933594,-116.7130584716797,-116.9141693115234,-117.0952911376953,-117.1223754882812],\"lat\":[32.53533172607422,32.56582641601562,32.65929412841797,32.68302917480469,32.69705581665039,32.69759368896484,32.6749382019043,32.61860275268555,32.62131118774414,32.64249420166016,32.68061447143555,32.72769546508789,32.71561431884766,32.68464279174805,32.66253280639648,32.65713882446289,32.68842315673828,32.70860290527344,32.77041625976562,32.82921600341797,32.86082458496094,32.87129211425781,32.88971710205078,32.97707366943359,33.10527038574219,33.12443542480469,33.14166259765625,33.24415588378906,33.32749176025391,33.34221649169922,33.44276428222656,33.47054290771484,33.53943634033203,33.59568405151367,33.60055160522461,33.60665893554688,33.62054443359375,33.63276672363281,33.64554595947266,33.66249084472656,33.69401931762695,33.70943450927734,33.73971557617188,33.75693893432617,33.76666259765625,33.78416442871094,33.75777435302734,33.72332000732422,33.71610260009766,33.7208251953125,33.74985504150391,33.78179931640625,33.80804443359375,33.84096527099609,33.92124557495117,33.93915557861328,33.96776580810547,33.98777008056641,34.03110504150391,34.04791259765625,34.05568695068359,34.0494384765625,34.04610443115234,34.03971862792969,34.03318786621094,34.03054809570312,34.05554962158203,34.06221008300781,34.06749725341797,34.11388397216797,34.1361083984375,34.16492080688477,34.22346115112305,34.28351593017578,34.35749816894531,34.37332153320312,34.41415405273438,34.42054748535156,34.42360687255859,34.42471313476562,34.42638397216797,34.4679069519043,34.47873687744141,34.47360229492188,34.46582794189453,34.45610046386719,34.4556884765625,34.50957489013672,34.53047561645508,34.56193542480469,34.56221389770508,34.55860137939453,34.58443832397461,34.62360382080078,34.64110565185547,34.66943740844727,34.69026947021484,34.71082305908203,34.8608283996582,34.89499664306641,35.01860427856445,35.10005950927734,35.13943862915039,35.17110443115234,35.18054580688477,35.16464233398438,35.20999145507812,35.22880935668945,35.25722122192383,35.27999496459961,35.3074951171875,35.35527038574219,35.44887542724609,35.46596145629883,35.47915649414062,35.52499008178711,35.64916229248047,35.70013046264648,35.76610565185547,35.79402542114258,35.82916259765625,35.8942985534668,35.92804718017578,35.97943496704102,35.99777221679688,36.18304443359375,36.22943496704102,36.24110412597656,36.31533813476562,36.3429069519043,36.39388656616211,36.43387603759766,36.46735382080078,36.51805114746094,36.59457397460938,36.64124298095703,36.61985397338867,36.61513137817383,36.6270751953125,36.64846420288086,36.66790771484375,36.75916290283203,36.81249237060547,36.88401794433594,36.95068740844727,36.97248840332031,36.9803352355957,36.96915435791016,36.95485305786133,36.95415878295898,36.96235275268555,36.99582672119141,37.01763153076172,37.19998931884766,37.22026824951172,37.25186538696289,37.28971862792969,37.32915878295898,37.37443542480469,37.48429489135742,37.50436782836914,37.5122184753418,37.52999114990234,37.56610107421875,37.58998870849609,37.75222015380859,37.78992462158203,37.81005859375,37.81381225585938,37.78693771362305,37.73165893554688,37.68762969970703,37.65443420410156,37.61582565307617,37.45929718017578,37.45790863037109,37.47137451171875,37.47943115234375,37.51027297973633,37.6027717590332,37.6322135925293,37.66221618652344,37.69470977783203,37.71471405029297,37.76666259765625,37.82638549804688,37.95915985107422,37.99082946777344,38.06415939331055,38.04743576049805,38.03526306152344,38.06610107421875,38.06554412841797,38.05416107177734,38.04305267333984,38.03666305541992,38.01811599731445,38.04861831665039,38.0789909362793,38.10464859008789,38.04888153076172,38.01290893554688,38.05499267578125,38.11041259765625,38.11568832397461,38.09658813476562,38.06646728515625,38.04746627807617,38.08115386962891,38.06610107421875,38.09721374511719,38.14811325073242,38.10877990722656,38.06137847900391,38.10999298095703,38.12693405151367,38.1361083984375,38.15554809570312,38.14749145507812,38.11957168579102,37.9366569519043,37.90693664550781,37.88318634033203,37.83346557617188,37.83103942871094,37.91054534912109,38.00131607055664,38.02027130126953,38.05443572998047,38.05360412597656,38.05804443359375,38.16249084472656,38.10777282714844,38.08193969726562,38.09498977661133,38.12748718261719,38.28527069091797,38.46277236938477,38.47290802001953,38.49193572998047,38.52276611328125,38.54083251953125,38.57388305664062,38.62443542480469,38.7340202331543,38.79610443115234,38.86082458496094,38.93041229248047,38.97109985351562,39.00458145141602,39.02554702758789,39.1219367980957,39.17804718017578,39.25943756103516,39.35332489013672,39.38582611083984,39.49652099609375,39.51915740966797,39.55499267578125,39.70971298217773,39.79166412353516,39.86915588378906,39.94971466064453,40.09165954589844,40.11631011962891,40.14790725708008,40.17416381835938,40.23804473876953,40.27245712280273,40.31193542480469,40.33624267578125,40.41526794433594,40.44769668579102,40.5322151184082,40.5816650390625,40.6947135925293,40.724365234375,40.74638366699219,40.74554443359375,40.81193542480469,40.99193572998047,41.03853607177734,41.0574951171875,41.15749359130859,41.24985504150391,41.34415435791016,41.39443969726562,41.42777252197266,41.46318435668945,41.51527404785156,41.68305206298828,41.75416564941406,41.81999206542969,41.84804916381836,41.86943817138672,41.94971466064453,41.99415588378906,41.99946594238281,42,42,42,42,42,42,42,42,42,42,42,42,42,42,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,42,42,42,42,42,42,42,42,42,42,42,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99943542480469,41.99964904785156,42,41.99943542480469,40.43305206298828,39.84943389892578,39.56610107421875,39.44971466064453,39.33332824707031,39.00721740722656,38.88276672363281,38.67276763916016,38.32054901123047,38.22609710693359,37.86527252197266,37.74638366699219,37.51416015625,37.40665435791016,37.28110504150391,37.16721343994141,37.05304718017578,36.93276977539062,36.81221008300781,36.70360565185547,36.58860015869141,36.46749114990234,36.24276733398438,36.10888671875,35.98081970214844,35.89499664306641,35.74221801757812,35.50277709960938,35.39804840087891,35.29332733154297,35.02165985107422,34.99214935302734,34.88193511962891,34.81666564941406,34.75833129882812,34.69860076904297,34.63166046142578,34.55082702636719,34.52193832397461,34.46415710449219,34.41582489013672,34.38999176025391,34.37276458740234,34.35867691040039,34.34276580810547,34.32332611083984,34.28804779052734,34.19624328613281,34.14665985107422,34.12568283081055,34.11429977416992,34.09207153320312,34.03013229370117,34.00124359130859,33.98721313476562,33.96152114868164,33.94415283203125,33.86888122558594,33.78305053710938,33.72193145751953,33.55929946899414,33.42033767700195,33.39916229248047,33.31888580322266,33.28054809570312,33.24638366699219,33.20901870727539,33.15541076660156,33.115478515625,33.08943557739258,33.06137847900391,33.04374313354492,33.02971267700195,33.03360748291016,33.03471755981445,33.02554702758789,32.97165679931641,32.86235046386719,32.73200607299805,32.72499084472656,32.72568511962891,32.73110198974609,32.74179840087891,32.74096298217773,32.71845626831055,32.71771240234375,32.70785140991211,32.69698715209961,32.68444061279297,32.66971588134766,32.65471649169922,32.63194274902344,32.60577011108398,32.58499908447266,32.568603515625,32.55221557617188,32.53665924072266,32.53533172607422]}],[{\"lng\":[-119.8680572509766,-119.6983337402344,-119.5936126708984,-119.5631866455078,-119.5527801513672,-119.5155639648438,-119.5329895019531,-119.5899963378906,-119.7133331298828,-119.7727813720703,-119.788330078125,-119.8369369506836,-119.8709716796875,-119.9177703857422,-119.9142303466797,-119.8680572509766],\"lat\":[34.08415985107422,34.04527282714844,34.05387878417969,34.06583023071289,34.06582641601562,34.04457855224609,34.01513290405273,33.99721527099609,33.97082138061523,33.96720886230469,33.96720886230469,33.97415924072266,33.99151992797852,34.06526947021484,34.0826301574707,34.08415985107422]}],[{\"lng\":[-120,-119.9694442749023,-119.9663925170898,-120.0365295410156,-120.1074981689453,-120.1216583251953,-120.1452789306641,-120.164436340332,-120.172233581543,-120.1922073364258,-120.2260971069336,-120.1847229003906,-120.135009765625,-120.0519409179688,-120.0352783203125,-120],\"lat\":[33.98963165283203,33.99235534667969,33.96249008178711,33.91915893554688,33.90554809570312,33.90804290771484,33.91666412353516,33.92777252197266,33.93471527099609,33.95943450927734,34.006103515625,34.01583099365234,34.02610015869141,34.03610992431641,34.02388000488281,33.98963165283203]}],[{\"lng\":[-118.5166625976562,-118.4452667236328,-118.4033432006836,-118.3497314453125,-118.297233581543,-118.2931213378906,-118.3037414550781,-118.4496459960938,-118.5899276733398,-118.5811233520508,-118.5418014526367,-118.5288925170898,-118.5166625976562],\"lat\":[33.47776794433594,33.44276428222656,33.42804718017578,33.39833068847656,33.34609985351562,33.32867431640625,33.30985260009766,33.32860565185547,33.48381042480469,33.49082946777344,33.48943710327148,33.48624420166016,33.47776794433594]}],[{\"lng\":[-118.5302886962891,-118.5261077880859,-118.5202789306641,-118.504997253418,-118.4822235107422,-118.413330078125,-118.3691635131836,-118.3694534301758,-118.4086074829102,-118.477783203125,-118.4869384765625,-118.4938812255859,-118.5338897705078,-118.570556640625,-118.5948638916016,-118.5938949584961,-118.5544281005859,-118.5302886962891],\"lat\":[32.99332427978516,32.98360443115234,32.97499084472656,32.959716796875,32.93804168701172,32.88555145263672,32.85471343994141,32.83277130126953,32.81707763671875,32.85277557373047,32.85888671875,32.86666107177734,32.92721557617188,32.98416137695312,33.03305053710938,33.04458236694336,33.04305267333984,32.99332427978516]}]]],null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":\"black\",\"weight\":2,\"opacity\":0.5,\"fill\":false,\"fillColor\":\"black\",\"fillOpacity\":0.2,\"smoothFactor\":1,\"noClip\":false},null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addCircleMarkers\",\"args\":[[38.342606,38.690757,39.76168,39.32756,38.20185,39.18919,38.94498,36.7056,36.78538,36.8414,36.6324,36.71088,36.5975,36.819199,39.53387,37.360701,36.3261,36.3663,36.3619,36.5432,36.4581,36.5092,36.4878,36.5975,37.3667,35.345607,35.0544,35.356615,35.438035,34.8416,35.3313,35.23918,36.102219,36.3144,34.1439,34.051097,34.066429,34.1992,33.9014,34.010283,34.13263,33.859662,34.3833,36.8669,36.9533,37.713299,39.150478,39.145733,39.43734,37.645718,37.962069,38.0697,36.48187,36.209286,36.694261,39.234402,39.3386,33.830586,33.819305,33.925062,38.74643,39.9395,40.301899,39.8134,33.7472,33.920758,33.583099,33.572019,33.852605,33.999449,33.996387,33.676535,38.613804,38.56844,38.302591,38.683304,38.593328,36.843425,36.485001,34.894054,34.243132,34.068114,34.0309,34.510955,35.774455,34.100132,34.416506,34.059626,34.0714,34.106678,37.8027,37.6825,35.614668,34.42775,34.7256,34.5414,34.402802,34.4897,34.637798,34.445301,36.98332,37.06315,40.5403,37.642165,37.4883,39.13868,36.489399,36.0319,34.21017,34.40428,34.44806,34.27632,34.25239,38.53455,36.280596,36.607215,35.04944,33.793713,34.181977,39.39861,36.841488,32.72519],[-120.764426,-120.072682,-121.84047,-121.66881,-120.680277,-121.99887,-119.97061,-119.7414,-119.77321,-119.8744,-120.3822,-119.77743,-119.5036,-119.7164,-122.190834,-118.330835,-117.9551,-117.8976,-118.0108,-117.9418,-117.8519,-116.8481,-117.871,-118.04,-118.4167,-118.851825,-119.4039,-119.062613,-119.016787,-118.8647,-119,-118.78863,-119.566002,-119.6436,-117.8508,-118.456386,-118.226755,-118.5331,-118.205,-118.068484,-118.127142,-118.200707,-118.5283,-120.01,-120.0341,-119.7061,-123.206528,-123.202995,-123.78766,-118.966515,-119.120278,-118.9477,-121.73333,-121.126371,-121.623271,-121.055603,-120.170303,-117.938509,-117.918759,-117.952586,-121.26498,-120.9443,-121.235001,-120.4707,-115.8201,-116.858419,-117.072197,-116.063823,-116.540965,-117.415831,-117.4925,-117.331027,-121.368007,-121.49311,-121.420838,-121.164457,-121.503728,-121.3621,-121.155602,-117.024756,-117.272275,-117.525796,-117.617403,-117.32555,-117.372109,-117.491982,-117.285602,-117.147347,-116.3906,-117.274063,-121.2208,-121.4406,-120.656912,-119.69091,-120.4278,-119.7906,-119.457497,-120.0458,-120.456703,-119.827797,-121.98822,-122.083092,-121.5764,-120.994212,-120.8358,-121.61884,-118.826897,-119.055,-118.87051,-118.80998,-119.2313,-118.68369,-119.14318,-121.7734,-118.011661,-118.05473,-118.18893,-118.171019,-118.363036,-123.35872,-121.533444,-116.36441],6,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":\"black\",\"weight\":1,\"opacity\":0.5,\"fill\":true,\"fillColor\":[\"#20A386\",\"#481467\",\"#23A983\",\"#1F9E89\",\"#22A884\",\"#22A884\",\"#453581\",\"#70CF57\",\"#7DD24F\",\"#72D056\",\"#59C864\",\"#96D83F\",\"#67CC5C\",\"#6CCD5A\",\"#28AE80\",\"#49C16E\",\"#52C569\",\"#52C569\",\"#49C16E\",\"#65CB5E\",\"#4CC26C\",\"#FDE725\",\"#4EC36B\",\"#65CB5E\",\"#34B679\",\"#72D056\",\"#69CD5B\",\"#92D742\",\"#70CF57\",\"#20928C\",\"#8BD646\",\"#7FD34E\",\"#5DC863\",\"#6ECE58\",\"#3BBB75\",\"#3DBC74\",\"#41BE71\",\"#3FBC73\",\"#41BE71\",\"#50C46A\",\"#34B679\",\"#56C667\",\"#2AB07F\",\"#67CC5C\",\"#6ECE58\",\"#32648E\",\"#1F958B\",\"#1F998A\",\"#1F978B\",\"#463480\",\"#365C8D\",\"#34618D\",\"#33B67A\",\"#36B779\",\"#56C667\",\"#2E6F8E\",\"#472B7A\",\"#4BC16D\",\"#61CA60\",\"#5DC863\",\"#22A785\",\"#2C728E\",\"#38588C\",\"#39568C\",\"#4CC26C\",\"#2CB17E\",\"#3DBC74\",\"#FDE725\",\"#9CD93C\",\"#59C864\",\"#56C667\",\"#3FBC73\",\"#29AF7F\",\"#2CB17E\",\"#34B679\",\"#20A486\",\"#28AE80\",\"#2EB37C\",\"#23A983\",\"#52C569\",\"#2E6E8E\",\"#50C46A\",\"#59C864\",\"#1FA088\",\"#AADC32\",\"#4EC36B\",\"#1E9B8A\",\"#40BD72\",\"#1F948C\",\"#56C667\",\"#47C06F\",\"#5BC863\",\"#20A486\",\"#3FBC73\",\"#2CB17E\",\"#21A585\",\"#26AD81\",\"#1FA188\",\"#54C568\",\"#49C16E\",\"#1FA187\",\"#440154\",\"#2E6E8E\",\"#45C06F\",\"#38B977\",\"#1FA188\",\"#38B977\",\"#6ECE58\",\"#24AA83\",\"#2CB17E\",\"#26AD81\",\"#23A983\",\"#40BD72\",\"#22A785\",\"#40BD72\",\"#65CB5E\",\"#25AC82\",\"#4CC26C\",\"#38B977\",\"#2E6F8E\",\"#3FBC73\",\"#26818E\"],\"fillOpacity\":0.8},null,null,[\"Temp: 12.9 °C\",\"Temp: -1.8 °C\",\"Temp: 13.5 °C\",\"Temp: 12.2 °C\",\"Temp: 13.4 °C\",\"Temp: 13.4 °C\",\"Temp: 1 °C\",\"Temp: 18.5 °C\",\"Temp: 19.1 °C\",\"Temp: 18.6 °C\",\"Temp: 17.4 °C\",\"Temp: 20.2 °C\",\"Temp: 18.1 °C\",\"Temp: 18.3 °C\",\"Temp: 14.2 °C\",\"Temp: 16.5 °C\",\"Temp: 17 °C\",\"Temp: 17 °C\",\"Temp: 16.5 °C\",\"Temp: 18 °C\",\"Temp: 16.7 °C\",\"Temp: 24.5 °C\",\"Temp: 16.8 °C\",\"Temp: 18 °C\",\"Temp: 15.2 °C\",\"Temp: 18.6 °C\",\"Temp: 18.2 °C\",\"Temp: 20 °C\",\"Temp: 18.5 °C\",\"Temp: 10.8 °C\",\"Temp: 19.7 °C\",\"Temp: 19.2 °C\",\"Temp: 17.6 °C\",\"Temp: 18.4 °C\",\"Temp: 15.7 °C\",\"Temp: 15.8 °C\",\"Temp: 16.1 °C\",\"Temp: 15.9 °C\",\"Temp: 16.1 °C\",\"Temp: 16.9 °C\",\"Temp: 15.2 °C\",\"Temp: 17.2 °C\",\"Temp: 14.4 °C\",\"Temp: 18.1 °C\",\"Temp: 18.4 °C\",\"Temp: 5.6 °C\",\"Temp: 11.2 °C\",\"Temp: 11.7 °C\",\"Temp: 11.5 °C\",\"Temp: 0.9 °C\",\"Temp: 4.7 °C\",\"Temp: 5.3 °C\",\"Temp: 15.1 °C\",\"Temp: 15.3 °C\",\"Temp: 17.2 °C\",\"Temp: 6.8 °C\",\"Temp: 0.1 °C\",\"Temp: 16.6 °C\",\"Temp: 17.8 °C\",\"Temp: 17.6 °C\",\"Temp: 13.3 °C\",\"Temp: 7.2 °C\",\"Temp: 4.3 °C\",\"Temp: 4.2 °C\",\"Temp: 16.7 °C\",\"Temp: 14.5 °C\",\"Temp: 15.8 °C\",\"Temp: 24.5 °C\",\"Temp: 20.4 °C\",\"Temp: 17.4 °C\",\"Temp: 17.2 °C\",\"Temp: 15.9 °C\",\"Temp: 14.3 °C\",\"Temp: 14.5 °C\",\"Temp: 15.2 °C\",\"Temp: 13 °C\",\"Temp: 14.2 °C\",\"Temp: 14.7 °C\",\"Temp: 13.5 °C\",\"Temp: 17 °C\",\"Temp: 6.7 °C\",\"Temp: 16.9 °C\",\"Temp: 17.4 °C\",\"Temp: 12.4 °C\",\"Temp: 21 °C\",\"Temp: 16.8 °C\",\"Temp: 11.9 °C\",\"Temp: 16 °C\",\"Temp: 11.1 °C\",\"Temp: 17.2 °C\",\"Temp: 16.4 °C\",\"Temp: 17.5 °C\",\"Temp: 13 °C\",\"Temp: 15.9 °C\",\"Temp: 14.5 °C\",\"Temp: 13.1 °C\",\"Temp: 14 °C\",\"Temp: 12.6 °C\",\"Temp: 17.1 °C\",\"Temp: 16.5 °C\",\"Temp: 12.7 °C\",\"Temp: -3.2 °C\",\"Temp: 6.7 °C\",\"Temp: 16.3 °C\",\"Temp: 15.5 °C\",\"Temp: 12.6 °C\",\"Temp: 15.5 °C\",\"Temp: 18.4 °C\",\"Temp: 13.6 °C\",\"Temp: 14.5 °C\",\"Temp: 14 °C\",\"Temp: 13.5 °C\",\"Temp: 16 °C\",\"Temp: 13.3 °C\",\"Temp: 16 °C\",\"Temp: 18 °C\",\"Temp: 13.9 °C\",\"Temp: 16.7 °C\",\"Temp: 15.5 °C\",\"Temp: 6.8 °C\",\"Temp: 15.9 °C\",\"Temp: 8.9 °C\"],null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#440154 , #482979 11.5523465703971%, #355E8D 29.6028880866426%, #228B8D 47.6534296028881%, #32B67A 65.7039711191336%, #92D742 83.7545126353791%, #FDE725 \"],\"labels\":[\"0\",\"5\",\"10\",\"15\",\"20\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":0.5,\"position\":\"topright\",\"type\":\"numeric\",\"title\":\"Temperatura (°C)\",\"extra\":{\"p_1\":0.1155234657039711,\"p_n\":0.8375451263537906},\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[32.53533172607422,42],\"lng\":[-124.3758239746094,-114.1170120239258]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n```{.r .cell-code}\ntemp <- as.geodata(datosT) \nsummary(temp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNumber of data points: 122 \n\nCoordinates summary\n         Este     Norte\nmin -325700.9 -580919.1\nmax  387269.8  281577.0\n\nDistance summary\n         min          max \n    609.2419 1000171.2033 \n\nData summary\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-3.20000 13.15000 15.80000 14.42869 17.20000 24.50000 \n```\n\n\n:::\n:::\n\n\n\n\n::: panel-tabset\n### Gráficos de dispersión\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(1,2))\n\nplot(Temperatura~Este, data = datosT, ylab = \"Temperatura\", xlab=\"Este\")\nplot(Temperatura~Norte, data = datosT, ylab = \"Temperatura\", xlab=\"Norte\")\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\n\n### GeoR\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(temp, qt.col = c(\"purple\",\n                    \"pink\",\n                    \"green\",\n                    \"yellow\"),\n     scatter3d=T)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\nEn el gráfico se observa un agrupamiento en las coordenadas Norte con respecto a los datos, que puede llegar a corregirse con algún polinomio. Se probará con diferentes modelos a ver si se puede llegar a disminuir el efecto espacial.\n\n### Modelo de tendencia espacial\n\nEl modelo que mejor atrapa el efecto de la media es:\n\n$$\nTemperatura = \\beta_0 + \\beta_1 \\times Norte + \\beta_2 \\times Norte^2\n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfitT <- lm(Temperatura~Norte+I(Norte^2), data = datosT) \nsummary(fitT)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Temperatura ~ Norte + I(Norte^2), data = datosT)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-18.3668  -1.1159   0.9092   2.1923   9.2782 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.326e+01  5.352e-01  24.766  < 2e-16 ***\nNorte       -2.229e-05  3.230e-06  -6.901 2.68e-10 ***\nI(Norte^2)  -3.754e-11  8.551e-12  -4.390 2.47e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.049 on 119 degrees of freedom\nMultiple R-squared:  0.3199,\tAdjusted R-squared:  0.3084 \nF-statistic: 27.98 on 2 and 119 DF,  p-value: 1.094e-10\n```\n\n\n:::\n:::\n\n\n\n\nObservamos el comportamiento de sus residuales podemos notar que el modelo ayudo a reducir el efecto espacial.\n\n::: panel-tabset\n#### Gráficos de dispersión\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndatosT$Residuos <- fitT$residuals\npar(mfrow=c(1,2))\nplot(Residuos~Este, data = datosT, xlab=\"Este\", ylab=\"Residuos\")\nplot(Residuos~Norte, data = datosT, xlab=\"Norte\", ylab=\"Residuos\")\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n\n\n#### GeoR\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(temp, qt.col = c(\"purple\",\n                    \"pink\",\n                    \"green\",\n                    \"yellow\"),\n     scatter3d=T, trend=~Norte+I(Norte^2))\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\n### Estimación empírica del semivariograma\n\np¿Presentamos la estimación del semivariograma obtenida mediante la función variog para la variable temperatura. Se comparan los resultados al calcularlo directamente sobre los datos originales (sin remover la tendencia) y al utilizar los residuales de un modelo de regresión, con el objetivo de analizar cómo influye la presencia de tendencia en la estructura espacial.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvg_T <- variog(temp, estimator.type = \"modulus\", pairs.min=50) #Sin tendencia espacial\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nvariog: computing omnidirectional variogram\n```\n\n\n:::\n\n```{.r .cell-code}\nvg1_T <- variog(temp, trend = ~Norte+I(Norte^2),\n                estimator.type = \"modulus\", pairs.min=50)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nvariog: computing omnidirectional variogram\n```\n\n\n:::\n:::\n\n\n\n\n::: panel-tabset\n#### Con tendencia\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(vg_T,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Sin remover tendencia\",\n     col.main = 4, cex.main =1.3)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n\n\n#### Removiendo tendencia\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(vg1_T,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Removiendo tendencia\",\n     col.main = 4, cex.main =1.3)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\nCuando no se remueve la tendencia, la semivarianza alcanza valores más altos y presenta una forma aparentemente más regular, aunque dicha regularidad está influenciada por la tendencia global de los datos. En cambio, al eliminar la tendencia, los valores de semivarianza disminuyen y el patrón pierde suavidad, pero el variograma refleja con mayor fidelidad la verdadera dependencia espacial.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(vg1_T$u, vg1_T$n, type=\"b\",\n     xlab=\"distance\", ylab=\"n pairs\",\n     main=\"Número de pares por bin\")\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n\n\nEn este caso, el último punto corresponde a menos de 25 pares de observaciones, por lo que su interpretación resulta menos confiable.\n\n### Estimación del Modelo Teórico de Semivariograma\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndist_matrix_T <- as.matrix(dist(temp$coords))\n\n#1. Funciones de correlación, covarianza y semivarianza: ----\n\n#1.1 Modelo exponencial ----\n\nrho_exp <- function(h, phi){\n  exp(-(h/phi)) #Correlacion espacial\n}\n\ncov_exp <- function(sigma, h, phi){\n  sigma*rho_exp(h, phi) #Covarianza espacial\n}\n\nsv_exp <- function(nugget, sigma, h, phi){\n  nugget + sigma - cov_exp(sigma, h, phi) #Semivarianza espacial\n} \n\n#1.2 Modelo Gaussianio ----\n\nrho_gauss <- function(h, phi){\n  exp(-(h/phi)^2)\n}\n\ncov_gauss <- function(sigma, h, phi){\n  sigma*rho_gauss(h, phi) #Covarianza espacial\n}\n\nsv_gauss <- function(nugget, sigma, h, phi){\n  nugget + sigma - cov_gauss(sigma, h, phi) #Semivarianza espacial\n}\n#1.3 Modelo Gneting ----\n\ncov_gneiting <- function(h){\n  s <- 0.301187465825\n  ifelse(0<= s*h &  s*h <= 1,\n  (1 + 8*s*h + 25*(s*h)^2 + 32*(s*h)^3) * (1-s*h)^8,\n  0)\n}\n\nsv_gneiting <- function(nugget, sigma, h){\n  nugget + sigma - cov_gneiting(h) #Semivarianza espacial\n}\n\n#1.4 Modelo Spherical ----\n\nrho_spherical <- function(h, phi){\n  ifelse(h<phi,\n         1 - 1.5*(h/phi) + 0.5*(h/phi)^3,\n         0)\n}\n\ncov_spherical <- function(sigma, h, phi){\n  sigma*rho_spherical(h, phi) #Covarianza espacial\n}\n\nsv_spherical <- function(nugget, sigma, h, phi){\n  nugget + sigma - cov_spherical(sigma, h, phi) #Semivarianza espacial\n}\n\n#1.5 Modelo Matern ----\n\nrho_matern <- function(h, phi, kappa){\n  (1/(2*gamma(kappa))) * (h/phi)^kappa * besselK((h/phi), kappa)\n}\n\ncov_matern <- function(sigma, h, phi, kappa){\n  sigma*rho_matern(h, phi, kappa) #Covarianza espacial\n}\n\nsv_matern <- function(nugget, sigma, h, phi, kappa){\n  nugget + sigma - cov_matern(sigma, h, phi, kappa) #Semivarianza espacial\n}\n\n#2. Función para estimar por WLS----\n\nMSE_ponderados <- function(par, h, gamma,kappa=NA,w, model, n, pesos){\n  nugget <- par[1]\n  sigma <- par[2]\n  phi <- par[3]\n  \n  gamma_hat <- switch(model,\n                      \"exponencial\" = sv_exp(nugget, sigma, h, phi),\n                      \"gaussian\"    = sv_gauss(nugget, sigma, h, phi),\n                      \"gneiting\"    = sv_gneiting(nugget, sigma, h, phi),\n                      \"spherical\"   = sv_spherical(nugget, sigma, h, phi),\n                      \"matern\"      = sv_matern(nugget, sigma, h, phi, kappa)\n  )\n  \n  w <- switch(pesos,\n              \"Cressie\" = 1/(2*(2*gamma_hat)^2/n),\n              \"n\" = 1/n,\n              \"h/n\" = 1/(h/n),\n              \"I\" = 1)\n  \n  sum(w*(gamma - gamma_hat)^2)\n}\n\nest_sev_WLS <- function(par, kappa = NA, model, h, gamma, n){\n  sigma_0 <- par[1]\n  phi_0 <- par[2]\n  nugget_0 <- par[3]\n  kappa_0 <- kappa\n  \n  # Selección de función\n  sv <- switch(model,\n               \"exponencial\" = sv_exp,\n               \"gaussian\"    = sv_gauss,\n               \"spherical\"   = sv_spherical,\n               \"gneiting\"    = sv_gneiting,\n               \"matern\"      = sv_matern\n  )\n  \n  args_sv <- names(formals(sv))\n  \n  args_list <- list(\n    nugget = nugget_0,\n    sigma  = sigma_0,\n    h      = h,\n    phi    = phi_0,\n    kappa  = kappa_0\n  )\n  \n  args_list <- args_list[names(args_list) %in% args_sv]\n  \n  sv_ini <- do.call(sv, args_list)\n  \n  formula_sv <- switch(model,\n                       \"gneiting\" = gamma ~ sv(nugget, sigma, h),\n                       \"matern\" = gamma ~ sv(nugget, sigma, h, phi, kappa),\n                       gamma ~ sv(nugget, sigma, h, phi)\n  )\n  \n  start_list <- switch(model,\n                       \"gneting\" = list(nugget = nugget_0, sigma = sigma_0),\n                       \"matern\" = list(nugget = nugget_0, sigma = sigma_0, phi = phi_0, kappa = kappa_0),\n                       list(nugget = nugget_0, sigma = sigma_0, phi = phi_0)\n  )\n    \n    #1. Ponderación de Bessel\n    \n    WW <- (2*(2*sv_ini)^2/n)\n    \n    Bessel <- nls(formula = formula_sv,\n                  start = start_list,\n                  weights = 1/WW,\n                  control = nls.control(maxiter = 500, warnOnly = TRUE))\n    \n    ini_Bessel<-coef(Bessel)\n    \n    #1.1 Optim Bessel\n    \n    optim_bessel <- optim(\n      par = coef(Bessel),\n      fn = MSE_ponderados,\n      h = h,\n      gamma = gamma,\n      pesos = \"Cressie\",\n      model = model,\n      n = n,\n      method = \"L-BFGS-B\",\n      lower = c(0, 0, 0)\n    )\n    \n    par_optim_Bess <- optim_bessel$par[c(\"nugget\", \"sigma\", \"phi\")]\n    \n    #2. Ponderación 1/n\n    \n    W1 <- n\n    \n    n_pond <- nls(formula = formula_sv,\n                  start = start_list,\n                  weights = 1/W1,\n                  control = nls.control(maxiter = 500, warnOnly = TRUE))\n    \n    ini_n<-coef(n_pond)\n    \n    #2.1 Optimización 1/n\n    \n    optim_n <- optim(\n      par = coef(n_pond),\n      fn = MSE_ponderados,\n      h = h,\n      gamma = gamma,\n      pesos = \"n\",\n      n = n,\n      model = model,\n      method = \"L-BFGS-B\",\n      lower = c(0, 0, 0)\n    )    \n    \n    par_optim_n <- optim_n$par[c(\"nugget\", \"sigma\", \"phi\")]\n    \n    \n    #3. Ponderación h/n\n    \n    W2 <- h/n\n    \n    h_n_pond <- nls(formula = formula_sv,\n                    start = start_list,\n                    weights = 1/W2,\n                    control = nls.control(maxiter = 500, warnOnly = TRUE))\n    \n    ini_h_n<-coef(h_n_pond)\n    \n    optim_h_n <- optim(\n      par = coef(h_n_pond),\n      fn = MSE_ponderados,\n      h = h,\n      gamma = gamma,\n      pesos = \"h/n\",\n      model = model,\n      n = n,\n      method = \"L-BFGS-B\",\n      lower = c(0, 0, 0)\n    )    \n    \n    par_optim_h_n <- optim_h_n$par[c(\"nugget\", \"sigma\", \"phi\")]\n    \n\nres <- list(Bessel = list(Iniciales = ini_Bessel,\n                           Optimizados = par_optim_Bess),\n            `1/n` = list(Iniciales = ini_n,\n                          Optimizados = par_optim_n),\n            `h/n` = list(Iniciales = ini_h_n,\n                          Optimizados = par_optim_h_n))    \nreturn(res)\n}\n\nMSE_sv <- function(gamma_hat, par, kappa, model, h){\n  sigma_0 <- par[[2]]\n  phi_0 <- par[[3]]\n  nugget_0 <- par[[1]]\n  kappa_0 <- kappa\n  \n  sv <- switch(model,\n               \"exponencial\" = sv_exp,\n               \"gaussian\"    = sv_gauss,\n               \"spherical\"   = sv_spherical,\n               \"gneiting\"    = sv_gneiting,\n               \"matern\"      = sv_matern\n  )\n  \n  args_sv <- names(formals(sv))\n  \n  args_list <- list(\n    nugget = nugget_0,\n    sigma  = sigma_0,\n    h      = h,\n    phi    = phi_0,\n    kappa  = kappa_0\n  )\n  \n  args_list <- args_list[names(args_list) %in% args_sv]\n  \n  sv_est <- do.call(sv, args_list)\n  \n  return(mean((sv_est-gamma_hat)^2))\n}\n\n#3. Función para etimar por máxima verosimilitud\n\nloglik <- function(par, kappa=NA, z, dist_matrix, model){\n  sigma_0 <- par[1]\n  phi_0 <- par[2]\n  nugget_0 <- par[3]\n  kappa_0 <- kappa\n  \n  cov <- switch(model,\n               \"exponencial\" = cov_exp,\n               \"gaussian\"    = cov_gauss,\n               \"spherical\"   = cov_spherical,\n               \"gneiting\"    = cov_gneiting,\n               \"matern\"      = cov_matern\n  )\n  \n  args_cov <- names(formals(cov))\n  \n  args_list <- list(\n    sigma  = sigma_0,\n    nugget = nugget_0,\n    h      = dist_matrix,\n    phi    = phi_0,\n    kappa  = kappa_0\n  )\n  \n  args_list <- args_list[names(args_list) %in% args_cov]\n  \n  Sigma <- do.call(cov, args_list) \n  diag(Sigma) = diag(Sigma) + nugget_0\n  \n  # Descomposición de Cholesky (más estable que solve o det)\n  inv_Sigma <- solve(Sigma)\n  det <- log(det(Sigma))\n  \n  # Log-verosimilitud del modelo Gaussiano\n  z <- z \n  n <- length(z)\n  ll <- -0.5 * (n * log(2 * pi) + det + crossprod(z, inv_Sigma %*% z))  # Log-verosimilitud (negativa porque optim minimiza)\n  return(-ll)\n}\n```\n:::\n\n\n\n\nLos modelos obtenidos ajustanto por EyeFit, son:\n\n``` text\n\ncov.model sigmasq      phi tausq kappa kappa2 practicalRange\n1 exponential   10.74 109166.3  2.07    NA     NA       327033.0\n2    gaussian   10.00  80000.0  2.07    NA     NA       138465.5\n3   spherical   10.00 157832.8  2.07    NA     NA       157832.8\n```\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvariog_T <- data.frame(h = vg1_T$u, gamma_hat = vg1_T$v,\n                       n = vg1_T$n)\n\nrange_sv_T <- seq(1,max(variog_T$h), by=1000)\n\n# Modelo exponencial ----\n\nsigma_0_eT <- 10.74\nphi_0_eT <- 109166.3\nnugget_0_eT <- 2.07\n\npar_eT <- c(sigma_0_eT, phi_0_eT, nugget_0_eT)\n\nres_e_T <- est_sev_WLS(par=par_eT, kappa = NA,\n                       model=\"exponencial\",\n                       h=variog_T$h,\n                       gamma = variog_T$gamma_hat,\n                       n = variog_T$n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in nls(formula = formula_sv, start = start_list, weights = 1/W2, :\ngradiente singular\n```\n\n\n:::\n\n```{.r .cell-code}\nMLE_eT <- optim(fn = loglik,\n             par = par_eT,\n             kappa=NA,\n             z = datosT$Residuos, \n             dist_matrix=dist_matrix_T,\n             model = \"exponencial\",\n             method = \"L-BFGS-B\",\n             lower = c(0, 0, 0))\n\nestsv_exp_Bess_T <- do.call(sv_exp, c(as.list(res_e_T$Bessel$Optimizados), list(h = range_sv_T)))\nestsv_exp_n_T <- do.call(sv_exp, c(as.list(res_e_T$`1/n`$Optimizados), list(h = range_sv_T)))\nestsv_exp_h_n_T <- do.call(sv_exp, c(as.list(res_e_T$`h/n`$Optimizados), list(h = range_sv_T)))\nestsv_exp_MLE_T <- do.call(sv_exp, c(list(nugget = MLE_eT$par[3], phi = MLE_eT$par[2] , sigma = MLE_eT$par[1],h = range_sv_T)))\n\n# Modelo Gaussiano ----\n\nsigma_0_gT <- 10.00    \nphi_0_gT <- 80000.0\nnugget_0_gT <- 2.07\n\npar_gT <- c(sigma_0_gT, phi_0_gT, nugget_0_gT)\n\nres_g_T <- est_sev_WLS(par=par_gT, kappa = NA,\n                       model=\"gaussian\",\n                       h=variog_T$h,\n                       gamma = variog_T$gamma_hat,\n                       n = variog_T$n)\n\nestsv_g_Bess_T <- do.call(sv_gauss, c(as.list(res_g_T$Bessel$Optimizados), list(h = range_sv_T)))\nestsv_g_n_T <- do.call(sv_gauss, c(as.list(res_g_T$`1/n`$Optimizados), list(h = range_sv_T)))\nestsv_g_h_n_T <- do.call(sv_gauss, c(as.list(res_g_T$`h/n`$Optimizados), list(h = range_sv_T)))\n\n# Modelo esférico\n\nsigma_0_esT <- 10.00   \nphi_0_esT <- 157832.8\nnugget_0_esT <- 2.07\n\npar_esT <- c(sigma_0_esT, phi_0_esT, nugget_0_esT)\n\nres_es_T <- est_sev_WLS(par=par_esT, kappa = NA,\n                       model=\"spherical\",\n                       h=variog_T$h,\n                       gamma = variog_T$gamma_hat,\n                       n = variog_T$n)\n\nMLE_esT <- optim(fn = loglik,\n             par = par_esT,\n             kappa=NA,\n             z = datosT$Residuos, \n             dist_matrix=dist_matrix_T,\n             model = \"spherical\",\n             method = \"L-BFGS-B\",\n             lower = c(0, 0, 0))\n\n\nestsv_es_Bess_T <- do.call(sv_spherical, c(as.list(res_es_T$Bessel$Optimizados), list(h = range_sv_T)))\nestsv_es_n_T <- do.call(sv_spherical, c(as.list(res_es_T$`1/n`$Optimizados), list(h = range_sv_T)))\nestsv_es_h_n_T <- do.call(sv_spherical, c(as.list(res_es_T$`h/n`$Optimizados), list(h = range_sv_T)))\nestsv_es_MLE_T <- do.call(sv_spherical, c(list(nugget = MLE_esT$par[3], phi = MLE_esT$par[2] , sigma = MLE_esT$par[1],h = range_sv_T)))\n```\n:::\n\n\n\n\n:::::: panel-tabset\n#### Exponencial\n\n::: panel-tabset\n##### Optim\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(vg1_T,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Estimación teórica del modelo de semivariograma \\n (optim)\",\n     col.main = \"#36648B\", cex.main =1.3)\nlines(range_sv_T, estsv_exp_Bess_T, col=\"#FF4040\", lwd=1.5)\nlines(range_sv_T, estsv_exp_n_T, col=\"#4169E1\", lwd=1.5)\nlines(range_sv_T, estsv_exp_h_n_T, col=\"#008B00\", lwd=1.5)\nlines(range_sv_T, estsv_exp_MLE_T, col=\"#FFA500\", lwd=1.5)\nlegend(\"topleft\",\n       c(\"Cressie\", \"1/n\", \"n/h\", \"MLE\"),#, \"REML\"),\n       lwd = 1,\n       lty = 3,\n       col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       box.col = 9,\n       text.col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       cex=1,\n       seg.len = .5)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n\n```{.r .cell-code}\nresumen_exp_T <- cbind(\n  c(\"Cressie\", \"$$1/n$$\", \"$$n/h$$\", \"MLE\"),\n  rbind(\n    t(res_e_T$Bessel$Optimizados),\n    t(res_e_T$`1/n`$Optimizados),\n    t(res_e_T$`h/n`$Optimizados),\n    MLE_eT$par[c(3,1,2)]\n  ),\n  MSE = c(\n    MSE_sv(variog_T$gamma_hat, res_e_T$Bessel$Optimizados, NA, model = \"exponencial\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, res_e_T$`1/n`$Optimizados, NA, model = \"exponencial\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, res_e_T$`h/n`$Optimizados, NA, model = \"exponencial\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, list(nugget = MLE_eT$par[3], phi = MLE_eT$par[2] , sigma = MLE_eT$par[1]), NA, model = \"exponencial\", variog_T$h)\n  )\n)\n\nresumen_exp_T <- as.data.frame(resumen_exp_T)\nresumen_exp_T[ , -1] <- lapply(resumen_exp_T[ , -1], function(x) round(as.numeric(x), 3))\n\nkable(resumen_exp_T, digits = 3,\n      col.names = c(\"Método\", \"Nugget\", \"Sigma\", \"Phi\", \"MSE\"),\n      escape = F, row.names = F)\n```\n\n::: {.cell-output-display}\n\n\n|Método  | Nugget|  Sigma|       Phi|          MSE|\n|:-------|------:|------:|---------:|------------:|\n|Cressie |      0| 12.944|  98216.23| 3.591000e+00|\n|$$1/n$$ |      0| 11.178|  74809.84| 3.867000e+00|\n|$$n/h$$ |      0| 12.797|  98765.53| 3.465000e+00|\n|MLE     |      0| 31.706| 109166.30| 1.191489e+10|\n\n\n:::\n:::\n\n\n\n\n##### GeoR\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nini1_exp_T <- c(sigma_0_eT, phi_0_eT)\nfitvar1_exp_T <- variofit(vg1_T,\n                    cov.model = \"exponential\",\n                    ini1_exp_T,\n                    fix.nugget = F,\n                    nugget = nugget_0_eT,\n                    wei = \"equal\")\n\nfitvar2_exp_T <- variofit(vg1_T,\n                    cov.model = \"exponential\",\n                    ini1_exp_T,\n                    fix.nugget = F,\n                    nugget = nugget_0_eT,\n                    wei = \"npairs\")\n\nfitvar3_exp_T <- variofit(vg1_T,\n                    cov.model = \"exponential\",\n                    ini1_exp_T,\n                    fix.nugget =F,\n                    nugget = nugget_0_eT,\n                    wei = \"cressie\")\n\nfitvar4_exp_T <- likfit(temp,\n                  coords = temp$coords,\n                  data = temp$data,\n                  trend = ~ poly(Norte, 2, raw = FALSE),\n                  ini.cov.pars = ini1_exp_T,\n                  fix.nugget = F,\n                  nugget = nugget_0_eT,\n                  cov.model = \"exponential\",\n                  lik.method = \"ML\")\n\n\nplot(vg1_T,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Estimación teórica del modelo de semivariograma \\n (GeoR, gstat)\",\n     col.main = \"#36648B\", cex.main =1.3)\nlines(fitvar1_exp_T, col=\"#FF4040\", lwd=1.5)\nlines(fitvar2_exp_T, col=\"#4169E1\", lwd=1.5)\nlines(fitvar3_exp_T, col=\"#008B00\", lwd=1.5)\nlines(fitvar4_exp_T, col=\"#FFA500\", lwd=1.5)\nlegend(\"topleft\",\n       c(\"MCO\", \"1/n\", \"Cressie\", \"MLE\"),#, \"REML\"),\n       lwd = 1,\n       lty = 3,\n       col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       box.col = 9,\n       text.col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       cex=1,\n       seg.len = .5)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar1Texp <- c(fitvar1_exp_T$nugget, fitvar1_exp_T$cov.pars[1], fitvar1_exp_T$cov.pars[2])\npar2Texp <- c(fitvar2_exp_T$nugget, fitvar2_exp_T$cov.pars[1], fitvar2_exp_T$cov.pars[2])\npar3Texp <- c(fitvar3_exp_T$nugget, fitvar3_exp_T$cov.pars[1], fitvar3_exp_T$cov.pars[2])\npar4Texp <- c(fitvar4_exp_T$nugget, fitvar4_exp_T$cov.pars[1], fitvar4_exp_T$cov.pars[2])\n\nresumen_exp_T2 <- cbind(\n  c(\"MCO\", \"$$1/n$$\", \"$$Cressie$$\",\"MLE\"),\n  rbind(\n    par1Texp,\n    par2Texp,\n    par3Texp,\n    par4Texp\n  ),\n  MSE = c(\n    MSE_sv(variog_T$gamma_hat, par1Texp, NA, model = \"exponencial\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par2Texp, NA, model = \"exponencial\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par3Texp, NA, model = \"exponencial\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par4Texp, NA, model = \"exponencial\", variog_T$h)\n  )\n)\n\nresumen_exp_T2 <- as.data.frame(resumen_exp_T2)\nresumen_exp_T2[ , -1] <- lapply(resumen_exp_T2[ , -1], function(x) round(as.numeric(x), 3))\nkable(resumen_exp_T2, digits = 3,\n      col.names = c(\"Método\", \"Nugget\", \"Sigma\", \"Phi\", \"MSE\"),\n      escape = F, row.names = F)\n```\n\n::: {.cell-output-display}\n\n\n|Método      | Nugget|  Sigma|       Phi|     MSE|\n|:-----------|------:|------:|---------:|-------:|\n|MCO         |      0| 12.141|  82253.55|   3.184|\n|$$1/n$$     |      0| 12.423|  83939.23|   3.243|\n|$$Cressie$$ |      0| 13.298| 109166.30|   4.009|\n|MLE         |      0| 23.536|  75307.76| 117.550|\n\n\n:::\n:::\n\n\n\n:::\n\n#### Gaussiano\n\n::: panel-tabset\n##### Optim\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(vg1_T,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Estimación teórica del modelo de semivariograma \\n (optim)\",\n     col.main = \"#36648B\", cex.main =1.3)\nlines(range_sv_T, estsv_g_Bess_T, col=\"#FF4040\", lwd=1.5)\nlines(range_sv_T, estsv_g_n_T, col=\"#4169E1\", lwd=1.5)\nlines(range_sv_T, estsv_g_h_n_T, col=\"#008B00\", lwd=1.5)\nlegend(\"topleft\",\n       c(\"Cressie\", \"1/n\", \"n/h\"),#, \"REML\"),\n       lwd = 1,\n       lty = 3,\n       col = c(\"#FF4040\", \"#4169E1\", \"#008B00\"),\n       box.col = 9,\n       text.col = c(\"#FF4040\", \"#4169E1\", \"#008B00\"),\n       cex=1,\n       seg.len = .5)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n\n```{.r .cell-code}\nresumen_g_T <- cbind(\n  c(\"Cressie\", \"$$1/n$$\", \"$$n/h$$\"),\n  rbind(\n    t(res_g_T$Bessel$Optimizados),\n    t(res_g_T$`1/n`$Optimizados),\n    t(res_g_T$`h/n`$Optimizados)\n  ),\n  MSE = c(\n    MSE_sv(variog_T$gamma_hat, res_g_T$Bessel$Optimizados, NA, model = \"gaussian\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, res_g_T$`1/n`$Optimizados, NA, model = \"gaussian\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, res_g_T$`h/n`$Optimizados, NA, model = \"gaussian\", variog_T$h)\n  )\n)\n\nresumen_g_T <- as.data.frame(resumen_g_T)\nresumen_g_T[ , -1] <- lapply(resumen_g_T[ , -1], function(x) round(as.numeric(x), 3))\n\nkable(resumen_g_T, digits = 3,\n      col.names = c(\"Método\", \"Nugget\", \"Sigma\", \"Phi\", \"MSE\"),\n      escape = F)\n```\n\n::: {.cell-output-display}\n\n\n|Método  | Nugget|  Sigma|      Phi|   MSE|\n|:-------|------:|------:|--------:|-----:|\n|Cressie |      0| 12.053| 74520.03| 2.809|\n|$$1/n$$ |      0| 11.126| 69274.92| 3.233|\n|$$n/h$$ |      0| 11.620| 72540.07| 2.825|\n\n\n:::\n:::\n\n\n\n\n##### GeoR\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nini1_g_T <- c(sigma_0_gT, phi_0_gT)\nfitvar1_g_T <- variofit(vg1_T,\n                    cov.model = \"gaussian\",\n                    ini1_g_T,\n                    fix.nugget = F,\n                    nugget = nugget_0_gT,\n                    wei = \"equal\")\n\nfitvar2_g_T <- variofit(vg1_T,\n                    cov.model = \"gaussian\",\n                    ini1_g_T,\n                    fix.nugget = F,\n                    nugget = nugget_0_gT,\n                    wei = \"npairs\")\n\nfitvar3_g_T <- variofit(vg1_T,\n                    cov.model = \"gaussian\",\n                    ini1_g_T,\n                    fix.nugget = F,\n                    nugget = nugget_0_gT,\n                    wei = \"cressie\")\n\nfitvar4_g_T <- likfit(temp,\n                  coords = temp$coords,\n                  data = temp$data,\n                  trend = ~ poly(Norte, 2, raw = FALSE),\n                  ini.cov.pars = ini1_g_T,\n                  fix.nugget = F,\n                  nugget = nugget_0_gT,\n                  cov.model = \"gaussian\",\n                  lik.method = \"ML\")\n\n\nplot(vg1_T,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Estimación teórica del modelo de semivariograma \\n (GeoR, gstat)\",\n     col.main = \"#36648B\", cex.main =1.3)\nlines(fitvar1_g_T, col=\"#FF4040\", lwd=1.5)\nlines(fitvar2_g_T, col=\"#4169E1\", lwd=1.5)\nlines(fitvar3_g_T, col=\"#008B00\", lwd=1.5)\nlines(fitvar4_g_T, col=\"#FFA500\", lwd=1.5)\nlegend(\"topleft\",\n       c(\"MCO\", \"1/n\", \"Cressie\", \"MLE\"),#, \"REML\"),\n       lwd = 1,\n       lty = 3,\n       col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       box.col = 9,\n       text.col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       cex=1,\n       seg.len = .5)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar1Tg <- c(fitvar1_g_T$nugget, fitvar1_g_T$cov.pars[1], fitvar1_g_T$cov.pars[2])\npar2Tg <- c(fitvar2_g_T$nugget, fitvar2_g_T$cov.pars[1], fitvar2_g_T$cov.pars[2])\npar3Tg <- c(fitvar3_g_T$nugget, fitvar3_g_T$cov.pars[1], fitvar3_g_T$cov.pars[2])\npar4Tg <- c(fitvar4_g_T$nugget, fitvar4_g_T$cov.pars[1], fitvar4_g_T$cov.pars[2])\n\nresumen_g_T2 <- cbind(\n  c(\"MCO\", \"$$1/n$$\", \"$$Cressie$$\",\"MLE\"),\n  rbind(\n    par1Tg,\n    par2Tg,\n    par3Tg,\n    par4Tg\n  ),\n  MSE = c(\n    MSE_sv(variog_T$gamma_hat, par1Tg, NA, model = \"gaussian\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par2Tg, NA, model = \"gaussian\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par3Tg, NA, model = \"gaussian\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par4Tg, NA, model = \"gaussian\", variog_T$h)\n  )\n)\n\nresumen_g_T2 <- as.data.frame(resumen_g_T2)\nresumen_g_T2[ , -1] <- lapply(resumen_g_T2[ , -1], function(x) round(as.numeric(x), 3))\n\nkable(resumen_g_T2, digits = 3,\n      col.names = c(\"Método\", \"Nugget\", \"Sigma\", \"Phi\", \"MSE\"),\n      escape = F, row.names = F)\n```\n\n::: {.cell-output-display}\n\n\n|Método      | Nugget|  Sigma|      Phi|     MSE|\n|:-----------|------:|------:|--------:|-------:|\n|MCO         |  0.000| 11.862| 74341.86|   2.776|\n|$$1/n$$     |  0.000| 11.883| 74575.03|   2.777|\n|$$Cressie$$ |  0.349| 11.781| 80000.00|   2.835|\n|MLE         |  3.589| 21.264| 80000.00| 155.000|\n\n\n:::\n:::\n\n\n\n:::\n\n#### Esférico\n\n::: panel-tabset\n##### Optim\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(vg1_T,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Estimación teórica del modelo de semivariograma \\n (optim)\",\n     col.main = \"#36648B\", cex.main =1.3)\nlines(range_sv_T, estsv_es_Bess_T, col=\"#FF4040\", lwd=1.5)\nlines(range_sv_T, estsv_es_n_T, col=\"#4169E1\", lwd=1.5)\nlines(range_sv_T, estsv_es_h_n_T, col=\"#008B00\", lwd=1.5)\nlines(range_sv_T, estsv_es_MLE_T, col=\"#FFA500\", lwd=1.5)\nlegend(\"topleft\",\n       c(\"Cressie\", \"1/n\", \"n/h\", \"MLE\"),#, \"REML\"),\n       lwd = 1,\n       lty = 3,\n       col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       box.col = 9,\n       text.col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       cex=1,\n       seg.len = .5)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n\n```{.r .cell-code}\nresumen_es_T <- cbind(\n  c(\"Cressie\", \"$$1/n$$\", \"$$n/h$$\",\"MLE\"),\n  rbind(\n    t(res_es_T$Bessel$Optimizados),\n    t(res_es_T$`1/n`$Optimizados),\n    t(res_es_T$`h/n`$Optimizados),\n    MLE_esT$par[c(3,1,2)]\n  ),\n  MSE = c(\n    MSE_sv(variog_T$gamma_hat, res_es_T$Bessel$Optimizados, NA, model = \"spherical\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, res_es_T$`1/n`$Optimizados, NA, model = \"spherical\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, res_es_T$`h/n`$Optimizados, NA, model = \"spherical\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, list(nugget = MLE_esT$par[3], phi = MLE_esT$par[2] , sigma = MLE_esT$par[1]), NA, model = \"spherical\", variog_T$h)\n  )\n)\n\nresumen_es_T <- as.data.frame(resumen_es_T)\nresumen_es_T[ , -1] <- lapply(resumen_es_T[ , -1], function(x) round(as.numeric(x), 3))\n\nkable(resumen_es_T, digits = 3,\n      col.names = c(\"Método\", \"Nugget\", \"Sigma\", \"Phi\", \"MSE\"),\n      escape = F)\n```\n\n::: {.cell-output-display}\n\n\n|Método  | Nugget|  Sigma|      Phi|          MSE|\n|:-------|------:|------:|--------:|------------:|\n|Cressie |      0| 12.165| 191573.0| 3.044000e+00|\n|$$1/n$$ |      0| 11.128| 165974.6| 3.417000e+00|\n|$$n/h$$ |      0| 11.692| 175441.3| 2.976000e+00|\n|MLE     |      0| 27.958| 157832.8| 2.490774e+10|\n\n\n:::\n:::\n\n\n\n\n##### GeoR\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nini1_es_T <- c(sigma_0_esT, phi_0_esT)\nfitvar1_es_T <- variofit(vg1_T,\n                    cov.model = \"spherical\",\n                    ini1_es_T,\n                    fix.nugget = F,\n                    nugget = nugget_0_esT,\n                    wei = \"equal\")\n\nfitvar2_es_T <- variofit(vg1_T,\n                    cov.model = \"spherical\",\n                    ini1_es_T,\n                    fix.nugget = F,\n                    nugget = nugget_0_esT,\n                    wei = \"npairs\")\n\nfitvar3_es_T <- variofit(vg1_T,\n                    cov.model = \"spherical\",\n                    ini1_es_T,\n                    fix.nugget = F,\n                    nugget = nugget_0_esT,\n                    wei = \"cressie\")\n\nfitvar4_es_T <- likfit(temp,\n                  coords = temp$coords,\n                  data = temp$data,\n                  trend = ~ poly(Norte, 2, raw = FALSE),\n                  ini.cov.pars = ini1_es_T,\n                  fix.nugget = F,\n                  nugget = nugget_0_esT,\n                  cov.model = \"spherical\",\n                  lik.method = \"ML\")\n\n\nplot(vg1_T,\n     xlab = \"h\",\n     ylab = \"Semivarianza\",\n     cex.lab = 1.3,\n     cex.axis = 1.2,\n     main = \"Estimación teórica del modelo de semivariograma \\n (GeoR, gstat)\",\n     col.main = \"#36648B\", cex.main =1.3)\nlines(fitvar1_es_T, col=\"#FF4040\", lwd=1.5)\nlines(fitvar2_es_T, col=\"#4169E1\", lwd=1.5)\nlines(fitvar3_es_T, col=\"#008B00\", lwd=1.5)\nlines(fitvar4_es_T, col=\"#FFA500\", lwd=1.5)\nlegend(\"topleft\",\n       c(\"MCO\", \"1/n\", \"Cressie\", \"MLE\"),#, \"REML\"),\n       lwd = 1,\n       lty = 3,\n       col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       box.col = 9,\n       text.col = c(\"#FF4040\", \"#4169E1\", \"#008B00\",\"#FFA500\"),\n       cex=1,\n       seg.len = .5)\n```\n\n::: {.cell-output-display}\n![](Geo_uni_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar1Tes <- c(fitvar1_es_T$nugget, fitvar1_es_T$cov.pars[1], fitvar1_es_T$cov.pars[2])\npar2Tes <- c(fitvar2_es_T$nugget, fitvar2_es_T$cov.pars[1], fitvar2_es_T$cov.pars[2])\npar3Tes <- c(fitvar3_es_T$nugget, fitvar3_es_T$cov.pars[1], fitvar3_es_T$cov.pars[2])\npar4Tes <- c(fitvar4_es_T$nugget, fitvar4_es_T$cov.pars[1], fitvar4_es_T$cov.pars[2])\n\nresumen_es_T2 <- cbind(\n  c(\"MCO\", \"$$1/n$$\", \"$$Cressie$$\",\"MLE\"),\n  rbind(\n    par1Tes,\n    par2Tes,\n    par3Tes,\n    par4Tes\n  ),\n  MSE = c(\n    MSE_sv(variog_T$gamma_hat, par1Tes, NA, model = \"spherical\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par2Tes, NA, model = \"spherical\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par3Tes, NA, model = \"spherical\", variog_T$h),\n    MSE_sv(variog_T$gamma_hat, par4Tes, NA, model = \"spherical\", variog_T$h)\n  )\n)\n\nresumen_es_T2 <- as.data.frame(resumen_es_T2)\nresumen_es_T2[ , -1] <- lapply(resumen_es_T2[ , -1], function(x) round(as.numeric(x), 3))\n\nkable(resumen_es_T2, digits = 3,\n      col.names = c(\"Método\", \"Nugget\", \"Sigma\", \"Phi\", \"MSE\"),\n      escape = F, row.names = F)\n```\n\n::: {.cell-output-display}\n\n\n|Método      | Nugget|  Sigma|      Phi|     MSE|\n|:-----------|------:|------:|--------:|-------:|\n|MCO         |      0| 11.878| 171733.0|   2.938|\n|$$1/n$$     |      0| 11.898| 166427.4|   2.944|\n|$$Cressie$$ |      0| 11.860| 157832.8|   2.977|\n|MLE         |      0| 25.641| 144147.3| 179.276|\n\n\n:::\n:::\n\n\n\n:::\n::::::\n\nEl modelo con menor MSE es el modelo Gausiano. Sin embargo, dada la inestabilidad numérica que se observa al realizar la predicción se opta por usar el modelo esférico obtenido por mínimos cuadrados ponderados usando la ponderación $1/n$, que es el segundo mejor en términos del MSE.\n\n### Kriging\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#| message: false\n#| warning: false\n#| results: 'hide'\n\nbest_model_T <- gstat::vgm(psill = res_es_T$`1/n`$Optimizados[2],\n                           model = \"Sph\",\n                           range = res_es_T$`1/n`$Optimizados[3],\n                           nugget = res_es_T$`1/n`$Optimizados[1]\n)\n\ncoordinates(datosT) <- ~Este + Norte\nproj4string(datosT) <- CRS(\"EPSG:3310\")\n\ng_obj<-gstat::gstat(id=\"Temperatura\",\n             formula = Temperatura ~ Norte + I(Norte^2),\n             model = best_model_T,\n             data = datosT)\n\npredic <- predict(g_obj, newdata = new, nmin = 12, maxdist=74809.84)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[using universal kriging]\n```\n\n\n:::\n\n```{.r .cell-code}\nprediction <- data.frame(predic)\n\n#Mapas de predicción\n\ngridded(predic) <- TRUE\n\n#1. Mapa de Kriging\n\npredic_raster_utm <- raster(predic, layer = \"Temperatura.pred\")\n\n# 2. Asegurarse de que el CRS del ráster se asigne correctamente (EPSG:3310)\ncrs(predic_raster_utm) <- \"+init=epsg:3310\"\n\npredic_raster_wgs84 <- raster::projectRaster(\n    raster::mask(\n        predic_raster_utm, \n        sh_mundos_sp_utm_simple\n    ),\n    crs = \"+init=epsg:4326\", \n    method = \"bilinear\"\n)\n\nbins <- c(-5,0, 5, 8, 10, 12, 15, 20, 25)\n\npred_range <- c(minValue(predic_raster_wgs84), maxValue(predic_raster_wgs84))\npal_pred <- colorBin(\n  palette = \"viridis\", # La paleta de colores\n  domain = pred_range,\n  bins = bins,\n  na.color = \"transparent\"\n)\n\nmapa_kriging_leaflet <- leaflet() %>%\n  addProviderTiles(providers$CartoDB.Positron) %>%\n  \n  # Añadir la capa ráster de Predicción Kriging\n  addRasterImage(\n    predic_raster_wgs84, # Usamos el objeto raster reproyectado\n    colors = pal_pred, \n    opacity = 0.7,\n    group = \"Predicción Kriging\"\n  ) %>%\n    addCircleMarkers(data = datosT_sf_wgs84,\n                   fillColor = ~pal(Temperatura),\n                   fillOpacity = 0.8,\n                   color = \"black\",\n                   weight = 1,\n                   radius = 6,\n                   popup = ~paste(\"Temp:\", Temperatura, \"°C\")) %>% \n  \n  addLegend(\n    pal = pal_pred, \n    values = pred_range,\n    title = \"Predicción T (°C)\",\n    position = \"topright\"\n  ) %>%\n  \n  addLegend(pal = pal,\n            values = datosT_sf_wgs84$Temperatura,\n            title = \"Temperatura Observada\",\n    position = \"topleft\"\n  ) \n\n#2 Mapa Varianza------------------------------------------\n\nvar_raster_utm <- raster(predic, layer = \"Temperatura.var\")\n\n# 2. Asegurarse de que el CRS del ráster se asigne correctamente (EPSG:3310)\ncrs(var_raster_utm) <- \"+init=epsg:3310\"\n\nvar_raster_wgs84 <- raster::projectRaster(\n    raster::mask(\n        var_raster_utm, \n        sh_mundos_sp_utm_simple\n    ),\n    crs = \"+init=epsg:4326\", \n    method = \"bilinear\"\n)\n\nbinsv <- seq(0,30, by=5)\n\nvar_range <- c(minValue(var_raster_wgs84), maxValue(var_raster_wgs84))\npal_var <- colorBin(\n  palette = \"Spectral\", # La paleta de colores\n  domain = var_range,\n  bins = binsv,\n  na.color = \"transparent\"\n)\n\nmapa_var_leaflet <- leaflet() %>%\n  addProviderTiles(providers$CartoDB.Positron) %>%\n  \n  # Añadir la capa ráster de Predicción Kriging\n  addRasterImage(\n    var_raster_wgs84, # Usamos el objeto raster reproyectado\n    colors = pal_var, \n    opacity = 0.7,\n    group = \"Predicción Kriging\"\n  ) %>%\n  addLegend(\n    pal = pal_var, \n    values = var_range,\n    title = \"Varianza\",\n    position = \"topright\"\n  ) \n\n#3. Mapa Cv ----------------------------------------------\n\ncv_raster_utm <- sqrt(var_raster_utm) / abs(predic_raster_utm)\n\nmapa_mayor_a_uno <- cv_raster_utm > 1\ncv_raster_utm[mapa_mayor_a_uno] <- 1\n\ncrs(cv_raster_utm) <- \"+init=epsg:3310\"\n\ncv_raster_masked_utm <- raster::mask(cv_raster_utm, sh_mundos_sp_utm_simple)\n\n# 2. Aplicar CROP (Recorte físico del rectángulo)\ncv_raster_cropped_utm <- raster::crop(cv_raster_masked_utm, sh_mundos_sp_utm_simple)\n\n# 3. Reproyectar el objeto MÁS PEQUEÑO a WGS84\ncv_raster_wgs84 <- raster::projectRaster(\n    cv_raster_cropped_utm, \n    crs = \"+init=epsg:4326\", \n    method = \"bilinear\"\n)\n\nbincv <- seq(0,1, by=.1)\n\ncv_range <- c(minValue(cv_raster_wgs84), maxValue(cv_raster_wgs84))\n\npal_cv <- colorBin(\n  palette = \"RdYlGn\", # Rojo-Amarillo-Verde\n  domain = cv_range,\n  na.color = \"transparent\",\n  bins = bincv,\n  reverse = TRUE # ¡Esto es CRUCIAL! Para que el Verde sea BAJA incertidumbre.\n)\n\nmapa_cv_leaflet <- leaflet() %>%\n  addProviderTiles(providers$CartoDB.Positron) %>%\n  \n  # Añadir la capa ráster de Predicción Kriging\n  addRasterImage(\n    cv_raster_wgs84, # Usamos el objeto raster reproyectado\n    colors = pal_cv, \n    opacity = 0.7,\n    group = \"Predicción Kriging\"\n  ) %>%\n  \n  addLegend(\n    pal = pal_cv, \n    values = cv_range,\n    title = \"Coeficiente de Variación\",\n    position = \"topright\"\n  )\n```\n:::\n\n\n\n\n::: panel-tabset\n#### Predicción\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmapa_kriging_leaflet\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-87f90f9166cc9560780d\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-87f90f9166cc9560780d\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.Positron\",null,null,{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addRasterImage\",\"args\":[\"data:image/png;base64,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\",[[42.23353560324875,-124.6411064390264],[32.26193560324877,-113.3038064390263]],null,\"Predicción Kriging\",{\"tileSize\":256,\"zIndex\":1,\"minZoom\":0,\"opacity\":0.7}]},{\"method\":\"addCircleMarkers\",\"args\":[[38.342606,38.690757,39.76168,39.32756,38.20185,39.18919,38.94498,36.7056,36.78538,36.8414,36.6324,36.71088,36.5975,36.819199,39.53387,37.360701,36.3261,36.3663,36.3619,36.5432,36.4581,36.5092,36.4878,36.5975,37.3667,35.345607,35.0544,35.356615,35.438035,34.8416,35.3313,35.23918,36.102219,36.3144,34.1439,34.051097,34.066429,34.1992,33.9014,34.010283,34.13263,33.859662,34.3833,36.8669,36.9533,37.713299,39.150478,39.145733,39.43734,37.645718,37.962069,38.0697,36.48187,36.209286,36.694261,39.234402,39.3386,33.830586,33.819305,33.925062,38.74643,39.9395,40.301899,39.8134,33.7472,33.920758,33.583099,33.572019,33.852605,33.999449,33.996387,33.676535,38.613804,38.56844,38.302591,38.683304,38.593328,36.843425,36.485001,34.894054,34.243132,34.068114,34.0309,34.510955,35.774455,34.100132,34.416506,34.059626,34.0714,34.106678,37.8027,37.6825,35.614668,34.42775,34.7256,34.5414,34.402802,34.4897,34.637798,34.445301,36.98332,37.06315,40.5403,37.642165,37.4883,39.13868,36.489399,36.0319,34.21017,34.40428,34.44806,34.27632,34.25239,38.53455,36.280596,36.607215,35.04944,33.793713,34.181977,39.39861,36.841488,32.72519],[-120.764426,-120.072682,-121.84047,-121.66881,-120.680277,-121.99887,-119.97061,-119.7414,-119.77321,-119.8744,-120.3822,-119.77743,-119.5036,-119.7164,-122.190834,-118.330835,-117.9551,-117.8976,-118.0108,-117.9418,-117.8519,-116.8481,-117.871,-118.04,-118.4167,-118.851825,-119.4039,-119.062613,-119.016787,-118.8647,-119,-118.78863,-119.566002,-119.6436,-117.8508,-118.456386,-118.226755,-118.5331,-118.205,-118.068484,-118.127142,-118.200707,-118.5283,-120.01,-120.0341,-119.7061,-123.206528,-123.202995,-123.78766,-118.966515,-119.120278,-118.9477,-121.73333,-121.126371,-121.623271,-121.055603,-120.170303,-117.938509,-117.918759,-117.952586,-121.26498,-120.9443,-121.235001,-120.4707,-115.8201,-116.858419,-117.072197,-116.063823,-116.540965,-117.415831,-117.4925,-117.331027,-121.368007,-121.49311,-121.420838,-121.164457,-121.503728,-121.3621,-121.155602,-117.024756,-117.272275,-117.525796,-117.617403,-117.32555,-117.372109,-117.491982,-117.285602,-117.147347,-116.3906,-117.274063,-121.2208,-121.4406,-120.656912,-119.69091,-120.4278,-119.7906,-119.457497,-120.0458,-120.456703,-119.827797,-121.98822,-122.083092,-121.5764,-120.994212,-120.8358,-121.61884,-118.826897,-119.055,-118.87051,-118.80998,-119.2313,-118.68369,-119.14318,-121.7734,-118.011661,-118.05473,-118.18893,-118.171019,-118.363036,-123.35872,-121.533444,-116.36441],6,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":\"black\",\"weight\":1,\"opacity\":0.5,\"fill\":true,\"fillColor\":[\"#20A386\",\"#481467\",\"#23A983\",\"#1F9E89\",\"#22A884\",\"#22A884\",\"#453581\",\"#70CF57\",\"#7DD24F\",\"#72D056\",\"#59C864\",\"#96D83F\",\"#67CC5C\",\"#6CCD5A\",\"#28AE80\",\"#49C16E\",\"#52C569\",\"#52C569\",\"#49C16E\",\"#65CB5E\",\"#4CC26C\",\"#FDE725\",\"#4EC36B\",\"#65CB5E\",\"#34B679\",\"#72D056\",\"#69CD5B\",\"#92D742\",\"#70CF57\",\"#20928C\",\"#8BD646\",\"#7FD34E\",\"#5DC863\",\"#6ECE58\",\"#3BBB75\",\"#3DBC74\",\"#41BE71\",\"#3FBC73\",\"#41BE71\",\"#50C46A\",\"#34B679\",\"#56C667\",\"#2AB07F\",\"#67CC5C\",\"#6ECE58\",\"#32648E\",\"#1F958B\",\"#1F998A\",\"#1F978B\",\"#463480\",\"#365C8D\",\"#34618D\",\"#33B67A\",\"#36B779\",\"#56C667\",\"#2E6F8E\",\"#472B7A\",\"#4BC16D\",\"#61CA60\",\"#5DC863\",\"#22A785\",\"#2C728E\",\"#38588C\",\"#39568C\",\"#4CC26C\",\"#2CB17E\",\"#3DBC74\",\"#FDE725\",\"#9CD93C\",\"#59C864\",\"#56C667\",\"#3FBC73\",\"#29AF7F\",\"#2CB17E\",\"#34B679\",\"#20A486\",\"#28AE80\",\"#2EB37C\",\"#23A983\",\"#52C569\",\"#2E6E8E\",\"#50C46A\",\"#59C864\",\"#1FA088\",\"#AADC32\",\"#4EC36B\",\"#1E9B8A\",\"#40BD72\",\"#1F948C\",\"#56C667\",\"#47C06F\",\"#5BC863\",\"#20A486\",\"#3FBC73\",\"#2CB17E\",\"#21A585\",\"#26AD81\",\"#1FA188\",\"#54C568\",\"#49C16E\",\"#1FA187\",\"#440154\",\"#2E6E8E\",\"#45C06F\",\"#38B977\",\"#1FA188\",\"#38B977\",\"#6ECE58\",\"#24AA83\",\"#2CB17E\",\"#26AD81\",\"#23A983\",\"#40BD72\",\"#22A785\",\"#40BD72\",\"#65CB5E\",\"#25AC82\",\"#4CC26C\",\"#38B977\",\"#2E6F8E\",\"#3FBC73\",\"#26818E\"],\"fillOpacity\":0.8},null,null,[\"Temp: 12.9 °C\",\"Temp: -1.8 °C\",\"Temp: 13.5 °C\",\"Temp: 12.2 °C\",\"Temp: 13.4 °C\",\"Temp: 13.4 °C\",\"Temp: 1 °C\",\"Temp: 18.5 °C\",\"Temp: 19.1 °C\",\"Temp: 18.6 °C\",\"Temp: 17.4 °C\",\"Temp: 20.2 °C\",\"Temp: 18.1 °C\",\"Temp: 18.3 °C\",\"Temp: 14.2 °C\",\"Temp: 16.5 °C\",\"Temp: 17 °C\",\"Temp: 17 °C\",\"Temp: 16.5 °C\",\"Temp: 18 °C\",\"Temp: 16.7 °C\",\"Temp: 24.5 °C\",\"Temp: 16.8 °C\",\"Temp: 18 °C\",\"Temp: 15.2 °C\",\"Temp: 18.6 °C\",\"Temp: 18.2 °C\",\"Temp: 20 °C\",\"Temp: 18.5 °C\",\"Temp: 10.8 °C\",\"Temp: 19.7 °C\",\"Temp: 19.2 °C\",\"Temp: 17.6 °C\",\"Temp: 18.4 °C\",\"Temp: 15.7 °C\",\"Temp: 15.8 °C\",\"Temp: 16.1 °C\",\"Temp: 15.9 °C\",\"Temp: 16.1 °C\",\"Temp: 16.9 °C\",\"Temp: 15.2 °C\",\"Temp: 17.2 °C\",\"Temp: 14.4 °C\",\"Temp: 18.1 °C\",\"Temp: 18.4 °C\",\"Temp: 5.6 °C\",\"Temp: 11.2 °C\",\"Temp: 11.7 °C\",\"Temp: 11.5 °C\",\"Temp: 0.9 °C\",\"Temp: 4.7 °C\",\"Temp: 5.3 °C\",\"Temp: 15.1 °C\",\"Temp: 15.3 °C\",\"Temp: 17.2 °C\",\"Temp: 6.8 °C\",\"Temp: 0.1 °C\",\"Temp: 16.6 °C\",\"Temp: 17.8 °C\",\"Temp: 17.6 °C\",\"Temp: 13.3 °C\",\"Temp: 7.2 °C\",\"Temp: 4.3 °C\",\"Temp: 4.2 °C\",\"Temp: 16.7 °C\",\"Temp: 14.5 °C\",\"Temp: 15.8 °C\",\"Temp: 24.5 °C\",\"Temp: 20.4 °C\",\"Temp: 17.4 °C\",\"Temp: 17.2 °C\",\"Temp: 15.9 °C\",\"Temp: 14.3 °C\",\"Temp: 14.5 °C\",\"Temp: 15.2 °C\",\"Temp: 13 °C\",\"Temp: 14.2 °C\",\"Temp: 14.7 °C\",\"Temp: 13.5 °C\",\"Temp: 17 °C\",\"Temp: 6.7 °C\",\"Temp: 16.9 °C\",\"Temp: 17.4 °C\",\"Temp: 12.4 °C\",\"Temp: 21 °C\",\"Temp: 16.8 °C\",\"Temp: 11.9 °C\",\"Temp: 16 °C\",\"Temp: 11.1 °C\",\"Temp: 17.2 °C\",\"Temp: 16.4 °C\",\"Temp: 17.5 °C\",\"Temp: 13 °C\",\"Temp: 15.9 °C\",\"Temp: 14.5 °C\",\"Temp: 13.1 °C\",\"Temp: 14 °C\",\"Temp: 12.6 °C\",\"Temp: 17.1 °C\",\"Temp: 16.5 °C\",\"Temp: 12.7 °C\",\"Temp: -3.2 °C\",\"Temp: 6.7 °C\",\"Temp: 16.3 °C\",\"Temp: 15.5 °C\",\"Temp: 12.6 °C\",\"Temp: 15.5 °C\",\"Temp: 18.4 °C\",\"Temp: 13.6 °C\",\"Temp: 14.5 °C\",\"Temp: 14 °C\",\"Temp: 13.5 °C\",\"Temp: 16 °C\",\"Temp: 13.3 °C\",\"Temp: 16 °C\",\"Temp: 18 °C\",\"Temp: 13.9 °C\",\"Temp: 16.7 °C\",\"Temp: 15.5 °C\",\"Temp: 6.8 °C\",\"Temp: 15.9 °C\",\"Temp: 8.9 °C\"],null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#440154\",\"#46327E\",\"#365C8D\",\"#277F8E\",\"#1FA187\",\"#4AC16D\",\"#9FDA3A\",\"#FDE725\"],\"labels\":[\"-5 &ndash; 0\",\"0 &ndash; 5\",\"5 &ndash; 8\",\"8 &ndash; 10\",\"10 &ndash; 12\",\"12 &ndash; 15\",\"15 &ndash; 20\",\"20 &ndash; 25\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":0.5,\"position\":\"topright\",\"type\":\"bin\",\"title\":\"Predicción T (°C)\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#440154 , #482979 11.5523465703971%, #355E8D 29.6028880866426%, #228B8D 47.6534296028881%, #32B67A 65.7039711191336%, #92D742 83.7545126353791%, #FDE725 \"],\"labels\":[\"0\",\"5\",\"10\",\"15\",\"20\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":0.5,\"position\":\"topleft\",\"type\":\"numeric\",\"title\":\"Temperatura Observada\",\"extra\":{\"p_1\":0.1155234657039711,\"p_n\":0.8375451263537906},\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[32.26193560324877,42.23353560324875],\"lng\":[-124.6411064390264,-113.3038064390263]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n#### Varianza\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmapa_var_leaflet\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-bbe20779a52c03125816\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-bbe20779a52c03125816\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.Positron\",null,null,{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addRasterImage\",\"args\":[\"data:image/png;base64,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\",[[42.23353560324875,-124.6411064390264],[32.26193560324877,-113.3038064390263]],null,\"Predicción Kriging\",{\"tileSize\":256,\"zIndex\":1,\"minZoom\":0,\"opacity\":0.7}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#D53E4F\",\"#FC8D59\",\"#FEE08B\",\"#E6F598\",\"#99D594\",\"#3288BD\"],\"labels\":[\"0 &ndash; 5\",\"5 &ndash; 10\",\"10 &ndash; 15\",\"15 &ndash; 20\",\"20 &ndash; 25\",\"25 &ndash; 30\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":0.5,\"position\":\"topright\",\"type\":\"bin\",\"title\":\"Varianza\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[32.26193560324877,42.23353560324875],\"lng\":[-124.6411064390264,-113.3038064390263]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n#### Coeficiente de variación\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmapa_cv_leaflet\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-4caaefbd9f052b1f169a\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-4caaefbd9f052b1f169a\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.Positron\",null,null,{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addRasterImage\",\"args\":[\"data:image/png;base64,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\",[[42.23353560324875,-124.6411064390264],[32.26193560324877,-113.3038064390263]],null,\"Predicción Kriging\",{\"tileSize\":256,\"zIndex\":1,\"minZoom\":0,\"opacity\":0.7}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#006837\",\"#1A9850\",\"#66BD63\",\"#A6D96A\",\"#D9EF8B\",\"#FEE08B\",\"#FDAE61\",\"#F46D43\",\"#D73027\",\"#A50026\"],\"labels\":[\"0.0 &ndash; 0.1\",\"0.1 &ndash; 0.2\",\"0.2 &ndash; 0.3\",\"0.3 &ndash; 0.4\",\"0.4 &ndash; 0.5\",\"0.5 &ndash; 0.6\",\"0.6 &ndash; 0.7\",\"0.7 &ndash; 0.8\",\"0.8 &ndash; 0.9\",\"0.9 &ndash; 1.0\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":0.5,\"position\":\"topright\",\"type\":\"bin\",\"title\":\"Coeficiente de Variación\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[32.26193560324877,42.23353560324875],\"lng\":[-124.6411064390264,-113.3038064390263]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n\n:::\n",
    "supporting": [
      "Geo_uni_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"site_libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/leaflet-1.3.1/leaflet.js\"></script>\n<link href=\"site_libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/proj4-2.6.2/proj4.min.js\"></script>\n<script src=\"site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\n<link href=\"site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/leaflet-binding-2.2.3/leaflet.js\"></script>\n<script src=\"site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js\"></script>\n<script src=\"site_libs/leaflet-providers-plugin-2.2.3/leaflet-providers-plugin.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}