{
  "hash": "b0199da36fede3a8438af143eb9565d9",
  "result": {
    "engine": "knitr",
    "markdown": "---\nbibliography: referencias.bib\nnocite: '@*'\n---\n\n\n\n\n\n::: {style=\"font-size: 1.5em; font-weight: bold; margin-bottom: 0.8em; margin-top: 0.5em;\"}\nAnálisis Geoestadístico de la Temperatura y Velocidad del Viento en el Estado de California a las 00:00 horas del primero Marzo de 2024\n:::\n\n# Análisis Bivariado\n\n## Planteamiento del problema\n\n::: {.callout-caution appearance=\"simple\"}\n## En desarrollo...\n:::\n\n### Introducción\n\n::: {.callout-caution appearance=\"simple\"}\n## En desarrollo...\n:::\n\n### Descripción de los datos\n\nLos datos objeto de este estudio provienen de la [Agencia de Protección Ambiental (EPA)](https://www.epa.gov/) de los Estados Unidos y corresponden a registros horarios obtenidos de las estaciones de monitoreo durante el mes de marzo de 2024. En particular, se analizan las variables **Temperatura ambiente (Temp)** y **Velocidad del viento (WS)**.\n\n#### Unidades\n\n-   **Temperatura ambiente:** Medida en grados celsius (C°) con una intensidad horaria.\n\n-   **Velocidad del viento:** Medida en metros por segundo (m/s) con una intensidad horaria.\n\n### Objetivos\n\n#### Objetivo general\n\n::: {.callout-caution appearance=\"simple\"}\n## En desarrollo...\n:::\n\n#### Objetivos específicos\n\n::: {.callout-caution appearance=\"simple\"}\n## En desarrollo...\n:::\n\n## Análisis Geoestadístico\n\nSe consideran las variables **temperatura** y **velocidad del viento**:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(geoR)\nlibrary(matrixcalc)\nlibrary(dplyr)\nlibrary(geoR)\nlibrary(sp)\nlibrary(readxl)\nlibrary(tidyr)\nlibrary(sf)\nlibrary(ggplot2)\nlibrary(knitr)\nlibrary(plotly)\nlibrary(leaflet)\nlibrary(raster)\nlibrary(stars)\nlibrary(gstat)\n\n\ncov_cos <- function(sigma, h, phi){\n  sigma * cos(h/phi)\n}\n\ncos_sv <- function(nugget, sigma, h, phi){\n  nugget +  sigma *(1 - cos(h/phi))\n}\n\n#Variable Temperatura ---------------------------------------\n\nTemp <- read_excel(\"GeoEst_Cali.xlsx\", sheet = \"Temperatura\")\ncolnames(Temp)[-1] <- as.numeric(colnames(Temp)[-1])\nEstacionesT <- read_excel(\"GeoEst_Cali.xlsx\", sheet = \"Estaciones\")\nEstacionesT <- EstacionesT %>% mutate(AQSID = as.numeric(AQSID))\nEstacionesT <- EstacionesT %>% filter(AQSID %in% colnames(Temp)[-1])\n\ny_T <- Temp[1,] #Tomar una fecha\ny_T <- cbind(colnames(y_T),t(y_T[1,]))\ny_T <- y_T[-1,]\ny_T <- as.data.frame(y_T)\ny_T <- na.omit(y_T)\ny_T <- y_T[-which.min(y_T$V2),]\ny_T$V1 <- as.numeric(y_T$V1)\ny_T <- inner_join(y_T, EstacionesT, by=c(\"V1\"=\"AQSID\"))\ndatosT <- y_T[,c(13,14,2)]\ncolnames(datosT)=c(\"Este\",\"Norte\",\"Temperatura\")\ndatosT$Temperatura <- as.numeric(datosT$Temperatura)\n\ntemp <- as.geodata(datosT)\n\n\n\n#Variable Velocidad del viento ------------------------------\n\nWS <- read_excel(\"GeoEst_Cali.xlsx\", sheet = \"WindSpeed\")\ncolnames(WS)[-1] <- as.numeric(colnames(WS)[-1])\nEstacionesWS <- read_excel(\"GeoEst_Cali.xlsx\", sheet = \"Estaciones\")\nEstacionesWS <- EstacionesWS %>% mutate(AQSID = as.numeric(AQSID))\nEstacionesWS <- EstacionesWS %>% filter(AQSID %in% colnames(WS)[-1])\n\ny_WS <- WS[1,] #Tomar una fecha\ny_WS <- cbind(colnames(y_WS),t(y_WS[1,]))\ny_WS <- y_WS[-1,]\ny_WS <- as.data.frame(y_WS)\ny_WS <- na.omit(y_WS)\ny_WS$V1 <- as.numeric(y_WS$V1)\ny_WS <- inner_join(y_WS, EstacionesWS, by=c(\"V1\"=\"AQSID\"))\ndatosWS <- y_WS[,c(13,14,2)]\ncolnames(datosWS)=c(\"Este\",\"Norte\",\"WindSpeed\")\ndatosWS$WindSpeed <- as.numeric(datosWS$WindSpeed)\n\nws <- as.geodata(datosWS)\n```\n:::\n\n\n\n\n\n::: panel-tabset\n### Temperatura\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npander::pander(summary(temp))\n```\n\n::: {.cell-output-display}\n\n\n  * **n**: _122_\n  * **coords.summary**:\n\n    -----------------------------\n     &nbsp;     Este      Norte\n    --------- --------- ---------\n     **min**   -325701   -580919\n\n     **max**   387270    281577\n    -----------------------------\n\n  * **distances.summary**:\n\n    ---------------\n      min     max\n    ------- -------\n     609.2   1e+06\n    ---------------\n\n  * **data.summary**:\n\n    --------------------------------------------------\n     Min.   1st Qu.   Median   Mean    3rd Qu.   Max.\n    ------ --------- -------- ------- --------- ------\n     -3.2    13.15     15.8    14.43    17.2     24.5\n    --------------------------------------------------\n\n\n<!-- end of list -->\n\n\n\n:::\n:::\n\n\n\n\n\n### Velocidad del viento\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npander::pander(summary(ws))\n```\n\n::: {.cell-output-display}\n\n\n  * **n**: _89_\n  * **coords.summary**:\n\n    -----------------------------\n     &nbsp;     Este      Norte\n    --------- --------- ---------\n     **min**   -276541   -543973\n\n     **max**   415574    281577\n    -----------------------------\n\n  * **distances.summary**:\n\n    ---------------\n     min     max\n    ------ --------\n     2216   987994\n    ---------------\n\n  * **data.summary**:\n\n    --------------------------------------------------\n     Min.   1st Qu.   Median   Mean    3rd Qu.   Max.\n    ------ --------- -------- ------- --------- ------\n     0.8      2.5      3.8     4.375     5.5     14.1\n    --------------------------------------------------\n\n\n<!-- end of list -->\n\n\n\n:::\n:::\n\n\n\n\n:::\n\n### Modelos Univariados\n\n#### Estacionariedad en Media\n\n::: panel-tabset\n##### Temperatura\n\nEl modelo es: $$Temperatura = \\beta_0 + \\beta_1 \\times Norte + \\beta_2 \\times Norte^2$$\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(temp, qt.col = c(\"purple\",\n                    \"pink\",\n                    \"green\",\n                    \"yellow\"),\n     scatter3d=T, trend=~Norte+I(Norte^2))\n```\n\n::: {.cell-output-display}\n![](Geo_bi_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfitT <- lm(Temperatura~Norte+I(Norte^2), data = datosT) \npander::pander(summary(fitT))\n```\n\n::: {.cell-output-display}\n\n-----------------------------------------------------------------\n     &nbsp;         Estimate    Std. Error   t value   Pr(>|t|)  \n----------------- ------------ ------------ --------- -----------\n **(Intercept)**     13.26        0.5352      24.77    8.812e-49 \n\n    **Norte**      -2.229e-05    3.23e-06    -6.901    2.676e-10 \n\n **I(Norte^2)**    -3.754e-11   8.551e-12     -4.39    2.469e-05 \n-----------------------------------------------------------------\n\n\n--------------------------------------------------------------\n Observations   Residual Std. Error   $R^2$    Adjusted $R^2$ \n-------------- --------------------- -------- ----------------\n     122               4.049          0.3199       0.3084     \n--------------------------------------------------------------\n\nTable: Fitting linear model: Temperatura ~ Norte + I(Norte^2)\n\n\n:::\n:::\n\n\n\n\n\n##### Velocidad del viento\n\nEl modelo es: $$WindSpeed = \\beta_0 + \\beta_1 \\times Este + \\beta_2 \\times Norte + + \\beta_3 \\times Este \\times Norte$$\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(temp, qt.col = c(\"purple\",\n                      \"pink\",\n                      \"green\",\n                      \"yellow\"),\n     scatter3d=T, trend=~Norte*Este)\n```\n\n::: {.cell-output-display}\n![](Geo_bi_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfitWS <- lm(WindSpeed~Este*Norte, data = datosWS) \npander::pander(summary(fitWS))\n```\n\n::: {.cell-output-display}\n\n----------------------------------------------------------------\n     &nbsp;        Estimate    Std. Error   t value   Pr(>|t|)  \n----------------- ----------- ------------ --------- -----------\n **(Intercept)**     6.398       0.3639      17.58    4.751e-30 \n\n    **Este**       2.069e-05   2.674e-06     7.739    1.895e-11 \n\n    **Norte**      1.159e-05   1.808e-06     6.411    7.746e-09 \n\n **Este:Norte**    2.558e-11   7.483e-12     3.419    0.000968  \n----------------------------------------------------------------\n\n\n--------------------------------------------------------------\n Observations   Residual Std. Error   $R^2$    Adjusted $R^2$ \n-------------- --------------------- -------- ----------------\n      89               1.938          0.4851       0.4669     \n--------------------------------------------------------------\n\nTable: Fitting linear model: WindSpeed ~ Este * Norte\n\n\n:::\n:::\n\n\n\n\n:::\n\n#### Variogramas\n\n##### Temperatura\n\nPara esta variable ya se analizo y encontró un modelo apropiado en el [Capítulo 1](#cap1).\n\n##### Velocidad del viento\n\nPara esta variable ya se analizo y encontró un modelo apropiado en el [Capítulo 1](#cap1).\n\n### Modelo cruzado de semivarianza\n\nConsiderando un modelo esférico para Temperatura y un modelo Wave para WS, las matrices para el modelo de coregionalización son:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nmat1 <- cbind(c(8, 3.5),\n              c(3.5, 1))\n\nmat2 <-cbind(c(8, 3.5),\n             c(3.5, 1))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndatosT1 <- datosT\ndatosWS1 <- datosWS\ninvisible(coordinates(datosT1) <- ~ Este + Norte)\ninvisible(coordinates(datosWS1) <- ~ Este + Norte)\n\n\nvgmntemp <- vgm(psill = mat1[1, 1],\n              model = \"Sph\",\n              range = 2e5,\n              nugget = .5,\n              add.to = vgm(psill = mat2[1, 1],\n                           model = \"Wav\",\n                           range = .5e5, nugget = 2))\n\nvgmws <- vgm(psill = mat1[2, 2],\n             model = \"Sph\",\n             range = 2e5,\n             nugget = .5,\n             add.to = vgm(psill = mat2[2, 2],\n                          model = \"Wav\",\n                          range = .5e5, nugget = 2))\n\n\nvgmntemp_sv <- vgm(psill = mat1[1, 2], model = \"Sph\",\n                 range = 2e5,\n                 nugget = .5,\n                 add.to = vgm(psill = mat2[1, 2],\n                              model = \"Wav\",\n                              range = .5e5, nugget = 2))\n\n\n\ng <- gstat(NULL, id=\"Temp\", formula=Temperatura~Norte+I(Norte^2),\n           data=datosT1, model = vgmntemp)\ng <- gstat(g, id=\"W_speed\", formula=WindSpeed~Norte*Este,\n           data=datosWS1, model = vgmws)\ng <- gstat(g, c(\"Temp\",\"W_speed\"), model = vgmntemp_sv)\n\nplot(variogram(g),\n     model = g$model,\n     pl = F,\n     xlab = \"Distancias\",\n     ylab = \"Semivarianza\")\n```\n\n::: {.cell-output-display}\n![](Geo_bi_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n\n::: {.callout-caution appearance=\"simple\"}\n## En desarrollo...\n:::\n\n### Cokriging\n\n::: {.callout-caution appearance=\"simple\"}\n## En desarrollo...\n:::\n\n## Conclusiones\n\n::: {.callout-caution appearance=\"simple\"}\n## En desarrollo...\n:::\n\n# Referencias {.unnumbered}\n",
    "supporting": [
      "Geo_bi_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}